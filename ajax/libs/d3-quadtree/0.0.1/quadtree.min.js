!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.quadtree={})}(this,function(n){"use strict";function t(n,t,e,u,i,r,f){var o,l=1/0;return function s(n,a,c,d,h){if(!(a>r||c>f||u>d||i>h)){if(p=n.point){var p,v=t-n.x,y=e-n.y,x=v*v+y*y;if(l>x){var g=Math.sqrt(l=x);u=t-g,i=e-g,r=t+g,f=e+g,o=p}}for(var b=n.nodes,m=.5*(a+d),N=.5*(c+h),k=t>=m,q=e>=N,w=q<<1|k,M=w+4;M>w;++w)if(n=b[3&w])switch(3&w){case 0:s(n,a,c,m,N);break;case 1:s(n,m,c,d,N);break;case 2:s(n,a,N,m,h);break;case 3:s(n,m,N,d,h)}}}(n,u,i,r,f),o}function e(n,t,u,i,r,f){if(!n(t,u,i,r,f)){var o=.5*(u+r),l=.5*(i+f),s=t.nodes;s[0]&&e(n,s[0],u,i,o,l),s[1]&&e(n,s[1],o,i,r,l),s[2]&&e(n,s[2],u,l,o,f),s[3]&&e(n,s[3],o,l,r,f)}}function u(){this.x=null,this.y=null,this.leaf=!0,this.point=null,this.nodes=[]}function i(n){return function(){return n}}function r(n){return n[1]}function f(n){return n[0]}function o(){function n(n){function r(n,t,e,u,i,r,o,l){if(!isNaN(e)&&!isNaN(u))if(n.leaf){var s=n.x,a=n.y;if(null!=s)if(Math.abs(s-e)+Math.abs(a-u)<.01)f(n,t,e,u,i,r,o,l);else{var c=n.point;n.x=n.y=n.point=null,f(n,c,s,a,i,r,o,l),f(n,t,e,u,i,r,o,l)}else n.x=e,n.y=u,n.point=t}else f(n,t,e,u,i,r,o,l)}function f(n,t,e,i,f,o,l,s){var a=.5*(f+l),c=.5*(o+s),d=e>=a,h=i>=c,p=h<<1|d;n.leaf=!1,n=n.nodes[p]||(n.nodes[p]=new u),d?f=a:l=a,h?o=c:s=c,r(n,t,e,i,f,o,l,s)}var h,p,v,y,x,g,b,m,N,k="function"==typeof c?c:i(c),q="function"==typeof d?d:i(d);if(n||(n=[]),null!=o)g=o,b=s,m=l,N=a;else for(m=N=-(g=b=1/0),p=[],v=[],x=n.length,y=0;x>y;++y){var w=+k(h=n[y],y),M=+q(h,y);g>w&&(g=w),b>M&&(b=M),w>m&&(m=w),M>N&&(N=M),p.push(w),v.push(M)}var F=m-g,j=N-b;isFinite(F)&&isFinite(j)&&(F>j?N=b+F:m=g+j);var z=new u;if(z.add=function(n){return r(z,n,+k(n,++y),+q(n,y),g,b,m,N),z},z.visit=function(n){return e(n,z,g,b,m,N),z},z.find=function(n,e){return t(z,n,e,g,b,m,N)},y=-1,null==o){for(;++y<x;)r(z,n[y],p[y],v[y],g,b,m,N);--y}else n.forEach(z.add);return p=v=n=h=null,z}var o,l,s,a,c=f,d=r;return n.x=function(t){return arguments.length?(c=t,n):c},n.y=function(t){return arguments.length?(d=t,n):d},n.extent=function(t){return arguments.length?(null==t?o=s=l=a=null:(o=+t[0][0],s=+t[0][1],l=+t[1][0],a=+t[1][1]),n):null==o?null:[[o,s],[l,a]]},n.size=function(t){return arguments.length?(null==t?o=s=l=a=null:(o=s=0,l=+t[0],a=+t[1]),n):null==o?null:[l-o,a-s]},n}n.quadtree=o});