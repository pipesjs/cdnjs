!function(){function t(t){function n(t){return t.text}function e(){return"serif"}function r(){return"normal"}function a(t){return Math.sqrt(t.value)}function i(){return 30*(~~(6*Math.random())-3)}function o(){return 1}function u(t,n,e){if(!t.sprite){m.clearRect(0,0,(g<<5)/M,v/M);var r=0,a=0,i=0,o=n.length;for(--e;++e<o;){t=n[e],m.save(),m.font=t.style+" "+t.weight+" "+~~((t.size+1)/M)+"px "+t.font;var u=m.measureText(t.text+"m").width*M,f=t.size<<1;if(t.rotate){var c=Math.sin(t.rotate*d),l=Math.cos(t.rotate*d),h=u*l,s=u*c,y=f*l,x=f*c;u=Math.max(Math.abs(h+x),Math.abs(h-x))+31>>5<<5,f=~~Math.max(Math.abs(s+y),Math.abs(s-y))}else u=u+31>>5<<5;if(f>i&&(i=f),r+u>=g<<5&&(r=0,a+=i,i=0),a+f>=v)break;m.translate((r+(u>>1))/M,(a+(f>>1))/M),t.rotate&&m.rotate(t.rotate*d),m.fillText(t.text,0,0),t.padding&&(m.lineWidth=2*t.padding,m.strokeText(t.text,0,0)),m.restore(),t.width=u,t.height=f,t.xoff=r,t.yoff=a,t.x1=u>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,r+=u}for(var p=m.getImageData(0,0,(g<<5)/M,v/M).data,w=[];--e>=0;)if(t=n[e],t.hasText){for(var u=t.width,b=u>>5,f=t.y1-t.y0,z=0;z<f*b;z++)w[z]=0;if(r=t.xoff,null==r)return;a=t.yoff;for(var I=0,k=-1,T=0;T<f;T++){for(var z=0;z<u;z++){var q=b*T+(z>>5),D=p[(a+T)*(g<<5)+(r+z)<<2]?1<<31-z%32:0;w[q]|=D,I|=D}I?k=T:(t.y0++,f--,T--,a++)}t.y1=t.y0+k,t.sprite=w.slice(0,(t.y1-t.y0)*b)}}}function f(t,n,e){e>>=5;for(var r,a=t.sprite,i=t.width>>5,o=t.x-(i<<4),u=127&o,f=32-u,c=t.y1-t.y0,l=(t.y+t.y0)*e+(o>>5),h=0;h<c;h++){r=0;for(var s=0;s<=i;s++)if((r<<f|(s<i?(r=a[h*i+s])>>>u:0))&n[l+s])return!0;l+=e}return!1}function c(t,n){var e=t[0],r=t[1];n.x+n.x0<e.x&&(e.x=n.x+n.x0),n.y+n.y0<e.y&&(e.y=n.y+n.y0),n.x+n.x1>r.x&&(r.x=n.x+n.x1),n.y+n.y1>r.y&&(r.y=n.y+n.y1)}function l(t,n){return t.x+t.x1>n[0].x&&t.x+t.x0<n[1].x&&t.y+t.y1>n[0].y&&t.y+t.y0<n[1].y}function h(t){var n=t[0]/t[1];return function(t){return[n*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function s(t){var n=4,e=n*t[0]/t[1],r=0,a=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:r+=e;break;case 1:a+=n;break;case 2:r-=e;break;default:a-=n}return[r,a]}}function y(t){for(var n=[],e=-1;++e<t;)n[e]=0;return n}t.layout.cloud=function s(){function x(t,n,e){for(var r,a,i,o=([{x:0,y:0},{x:d[0],y:d[1]}],n.x),u=n.y,c=Math.sqrt(d[0]*d[0]+d[1]*d[1]),h=I(d),s=S()<.5?1:-1,y=-s;(r=h(y+=s))&&(a=~~r[0],i=~~r[1],!(Math.min(Math.abs(a),Math.abs(i))>=c));)if(n.x=o+a,n.y=u+i,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>d[0]||n.y+n.y1>d[1])&&(!e||!f(n,t,d[0]))&&(!e||l(n,e))){for(var x,g=n.sprite,v=n.width>>5,M=d[0]>>5,m=n.x-(v<<4),p=127&m,w=32-p,b=n.y1-n.y0,z=(n.y+n.y0)*M+(m>>5),k=0;k<b;k++){x=0;for(var T=0;T<=v;T++)t[z+T]|=x<<w|(T<v?(x=g[k*v+T])>>>p:0);z+=M}return delete n.sprite,!0}return!1}var d=[256,256],g=n,v=e,M=a,m=r,w=r,b=i,z=o,I=h,k=[],T=1/0,q=t.dispatch("word","end"),D=null,S=Math.random,s={};return s.start=function(){function t(){for(var t=Date.now();Date.now()-t<T&&++a<r&&D;){var f=o[a];f.x=d[0]*(S()+.5)>>1,f.y=d[1]*(S()+.5)>>1,u(f,o,a),f.hasText&&x(n,f,e)&&(i.push(f),q.word(f),e?c(e,f):e=[{x:f.x+f.x0,y:f.y+f.y0},{x:f.x+f.x1,y:f.y+f.y1}],f.x-=d[0]>>1,f.y-=d[1]>>1)}a>=r&&(s.stop(),q.end(i,e))}var n=y((d[0]>>5)*d[1]),e=null,r=k.length,a=-1,i=[],o=k.map(function(t,n){return t.text=g.call(this,t,n),t.font=v.call(this,t,n),t.style=m.call(this,t,n),t.weight=w.call(this,t,n),t.rotate=b.call(this,t,n),t.size=~~M.call(this,t,n),t.padding=z.call(this,t,n),t}).sort(function(t,n){return n.size-t.size});return D&&clearInterval(D),D=setInterval(t,0),t(),s},s.stop=function(){return D&&(clearInterval(D),D=null),s},s.timeInterval=function(t){return arguments.length?(T=null==t?1/0:t,s):T},s.words=function(t){return arguments.length?(k=t,s):k},s.size=function(t){return arguments.length?(d=[+t[0],+t[1]],s):d},s.font=function(n){return arguments.length?(v=t.functor(n),s):v},s.fontStyle=function(n){return arguments.length?(m=t.functor(n),s):m},s.fontWeight=function(n){return arguments.length?(w=t.functor(n),s):w},s.rotate=function(n){return arguments.length?(b=t.functor(n),s):b},s.text=function(n){return arguments.length?(g=t.functor(n),s):g},s.spiral=function(t){return arguments.length?(I=p[t]||t,s):I},s.fontSize=function(n){return arguments.length?(M=t.functor(n),s):M},s.padding=function(n){return arguments.length?(z=t.functor(n),s):z},s.random=function(t){return arguments.length?(S=t,s):S},t.rebind(s,q,"on")};var x,d=Math.PI/180,g=64,v=2048,M=1;"undefined"!=typeof document?(x=document.createElement("canvas"),x.width=1,x.height=1,M=Math.sqrt(x.getContext("2d").getImageData(0,0,1,1).data.length>>2),x.width=(g<<5)/M,x.height=v/M):x=new Canvas(g<<5,v);var m=x.getContext("2d"),p={archimedean:h,rectangular:s};m.fillStyle=m.strokeStyle="red",m.textAlign="center"}"function"==typeof define&&define.amd?define(["d3"],t):t(this.d3)}();
//# sourceMappingURL=d3.layout.cloud.min.js.map