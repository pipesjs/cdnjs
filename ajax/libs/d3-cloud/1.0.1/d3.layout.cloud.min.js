!function(t){function n(){function t(t,r,e){for(var a,o,i,u=([{x:0,y:0},{x:n[0],y:n[1]}],r.x),c=r.y,l=Math.sqrt(n[0]*n[0]+n[1]*n[1]),x=M(n),h=Math.random()<.5?1:-1,s=-h;(a=x(s+=h))&&(o=~~a[0],i=~~a[1],!(Math.min(o,i)>l));)if(r.x=u+o,r.y=c+i,!(r.x+r.x0<0||r.y+r.y0<0||r.x+r.x1>n[0]||r.y+r.y1>n[1])&&(!e||!f(r,t,n[0]))&&(!e||y(r,e))){for(var d,v=r.sprite,g=r.width>>5,p=n[0]>>5,m=r.x-(g<<4),w=127&m,b=32-w,z=r.y1-r.y0,I=(r.y+r.y0)*p+(m>>5),q=0;q<z;q++){d=0;for(var k=0;k<=g;k++)t[I+k]|=d<<b|(k<g?(d=v[q*g+k])>>>w:0);I+=p}return delete r.sprite,!0}return!1}var n=[256,256],x=r,s=e,d=a,v=o,g=i,M=l,p=[],m=1/0,b=d3.dispatch("word","end"),z=null,I={};return I.start=function(){function r(){for(var r,i=+new Date;+new Date-i<m&&++f<o&&z;)r=l[f],r.x=n[0]*(Math.random()+.5)>>1,r.y=n[1]*(Math.random()+.5)>>1,u(r,l,f),t(e,r,a)&&(y.push(r),b.word(r),a?c(a,r):a=[{x:r.x+r.x0,y:r.y+r.y0},{x:r.x+r.x1,y:r.y+r.y1}],r.x-=n[0]>>1,r.y-=n[1]>>1);f>=o&&(I.stop(),b.end(y,a))}var e=h((n[0]>>5)*n[1]),a=null,o=p.length,f=-1,y=[],l=p.map(function(t,n){return{text:x.call(this,t,n),font:s.call(this,t,n),rotate:v.call(this,t,n),size:~~d.call(this,t,n),padding:i.call(this,t,n)}}).sort(function(t,n){return n.size-t.size});return z&&clearInterval(z),z=setInterval(r,0),r(),I},I.stop=function(){return z&&(clearInterval(z),z=null),I},I.timeInterval=function(t){return arguments.length?(m=null==t?1/0:t,I):m},I.words=function(t){return arguments.length?(p=t,I):p},I.size=function(t){return arguments.length?(n=[+t[0],+t[1]],I):n},I.font=function(t){return arguments.length?(s=d3.functor(t),I):s},I.rotate=function(t){return arguments.length?(v=d3.functor(t),I):v},I.text=function(t){return arguments.length?(x=d3.functor(t),I):x},I.spiral=function(t){return arguments.length?(M=w[t+""]||t,I):M},I.fontSize=function(t){return arguments.length?(d=d3.functor(t),I):d},I.padding=function(t){return arguments.length?(g=d3.functor(t),I):g},d3.rebind(I,b,"on")}function r(t){return t.text}function e(){return"serif"}function a(t){return Math.sqrt(t.value)}function o(){return 30*(~~(6*Math.random())-3)}function i(){return 1}function u(t,n,r){if(!t.sprite){m.clearRect(0,0,(v<<5)/M,g/M);var e=0,a=0,o=0,i=n.length;for(r--;++r<i;){t=n[r],m.save(),m.font=~~((t.size+1)/M)+"px "+t.font;var u=m.measureText(t.text+"m").width*M,f=t.size<<1;if(t.rotate){var c=Math.sin(t.rotate*d),y=Math.cos(t.rotate*d),l=u*y,x=u*c,h=f*y,s=f*c;u=Math.max(Math.abs(l+s),Math.abs(l-s))+31>>5<<5,f=~~Math.max(Math.abs(x+h),Math.abs(x-h))}else u=u+31>>5<<5;if(f>o&&(o=f),e+u>=v<<5&&(e=0,a+=o,o=0),a+f>=g)break;m.translate((e+(u>>1))/M,(a+(f>>1))/M),t.rotate&&m.rotate(t.rotate*d),m.fillText(t.text,0,0),m.restore(),t.width=u,t.height=f,t.xoff=e,t.yoff=a,t.x1=u>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,e+=u}for(var p=m.getImageData(0,0,(v<<5)/M,g/M).data,w=[];--r>=0;){t=n[r];for(var u=t.width,b=u>>5,f=t.y1-t.y0,z=t.padding,I=0;I<f*b;I++)w[I]=0;if(e=t.xoff,null==e)return;a=t.yoff;for(var q=0,k=-1,D=0;D<f;D++){for(var I=0;I<u;I++){var C=b*D+(I>>5),S=p[(a+D)*(v<<5)+(e+I)<<2]?1<<31-I%32:0;z&&(D&&(w[C-b]|=S),D<u-1&&(w[C+b]|=S),S|=S<<1|S>>1),w[C]|=S,q|=S}q?k=D:(t.y0++,f--,D--,a++)}t.y1=t.y0+k,t.sprite=w.slice(0,(t.y1-t.y0)*b)}}}function f(t,n,r){r>>=5;for(var e,a=t.sprite,o=t.width>>5,i=t.x-(o<<4),u=127&i,f=32-u,c=t.y1-t.y0,y=(t.y+t.y0)*r+(i>>5),l=0;l<c;l++){e=0;for(var x=0;x<=o;x++)if((e<<f|(x<o?(e=a[l*o+x])>>>u:0))&n[y+x])return!0;y+=r}return!1}function c(t,n){var r=t[0],e=t[1];n.x+n.x0<r.x&&(r.x=n.x+n.x0),n.y+n.y0<r.y&&(r.y=n.y+n.y0),n.x+n.x1>e.x&&(e.x=n.x+n.x1),n.y+n.y1>e.y&&(e.y=n.y+n.y1)}function y(t,n){return t.x+t.x1>n[0].x&&t.x+t.x0<n[1].x&&t.y+t.y1>n[0].y&&t.y+t.y0<n[1].y}function l(t){var n=t[0]/t[1];return function(t){return[n*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function x(t){var n=4,r=n*t[0]/t[1],e=0,a=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:e+=r;break;case 1:a+=n;break;case 2:e-=r;break;default:a-=n}return[e,a]}}function h(t){for(var n=[],r=-1;++r<t;)n[r]=0;return n}var s,d=Math.PI/180,v=64,g=2048,M=1;if("undefined"!=typeof document)s=document.createElement("canvas"),s.width=1,s.height=1,M=Math.sqrt(s.getContext("2d").getImageData(0,0,1,1).data.length>>2),s.width=(v<<5)/M,s.height=g/M;else{var p=require("canvas");s=new p(v<<5,g)}var m=s.getContext("2d"),w={archimedean:l,rectangular:x};m.fillStyle="red",m.textAlign="center",t.cloud=n}("undefined"==typeof exports?d3.layout||(d3.layout={}):exports);
//# sourceMappingURL=d3.layout.cloud.min.js.map