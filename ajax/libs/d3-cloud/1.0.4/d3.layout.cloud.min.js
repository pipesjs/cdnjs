!function(t){function n(){function t(t,e,r){for(var a,o,i,u=([{x:0,y:0},{x:n[0],y:n[1]}],e.x),f=e.y,c=Math.sqrt(n[0]*n[0]+n[1]*n[1]),y=w(n),s=Math.random()<.5?1:-1,x=-s;(a=y(x+=s))&&(o=~~a[0],i=~~a[1],!(Math.min(o,i)>c));)if(e.x=u+o,e.y=f+i,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>n[0]||e.y+e.y1>n[1])&&(!r||!l(e,t,n[0]))&&(!r||h(e,r))){for(var d,g=e.sprite,v=e.width>>5,p=n[0]>>5,M=e.x-(v<<4),m=127&M,b=32-m,z=e.y1-e.y0,I=(e.y+e.y0)*p+(M>>5),k=0;k<z;k++){d=0;for(var T=0;T<=v;T++)t[I+T]|=d<<b|(T<v?(d=g[k*v+T])>>>m:0);I+=p}return delete e.sprite,!0}return!1}var n=[256,256],s=e,d=r,g=o,v=a,p=a,M=i,m=u,w=y,z=[],I=1/0,k=d3.dispatch("word","end"),T=null,q={};return q.start=function(){function e(){for(var e,h=+new Date;+new Date-h<I&&++i<o&&T;)e=l[i],e.x=n[0]*(Math.random()+.5)>>1,e.y=n[1]*(Math.random()+.5)>>1,f(e,l,i),e.hasText&&t(r,e,a)&&(u.push(e),k.word(e),a?c(a,e):a=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=n[0]>>1,e.y-=n[1]>>1);i>=o&&(q.stop(),k.end(u,a))}var r=x((n[0]>>5)*n[1]),a=null,o=z.length,i=-1,u=[],l=z.map(function(t,n){return t.text=s.call(this,t,n),t.font=d.call(this,t,n),t.style=v.call(this,t,n),t.weight=p.call(this,t,n),t.rotate=M.call(this,t,n),t.size=~~g.call(this,t,n),t.padding=m.call(this,t,n),t}).sort(function(t,n){return n.size-t.size});return T&&clearInterval(T),T=setInterval(e,0),e(),q},q.stop=function(){return T&&(clearInterval(T),T=null),q},q.timeInterval=function(t){return arguments.length?(I=null==t?1/0:t,q):I},q.words=function(t){return arguments.length?(z=t,q):z},q.size=function(t){return arguments.length?(n=[+t[0],+t[1]],q):n},q.font=function(t){return arguments.length?(d=d3.functor(t),q):d},q.fontStyle=function(t){return arguments.length?(v=d3.functor(t),q):v},q.fontWeight=function(t){return arguments.length?(p=d3.functor(t),q):p},q.rotate=function(t){return arguments.length?(M=d3.functor(t),q):M},q.text=function(t){return arguments.length?(s=d3.functor(t),q):s},q.spiral=function(t){return arguments.length?(w=b[t+""]||t,q):w},q.fontSize=function(t){return arguments.length?(g=d3.functor(t),q):g},q.padding=function(t){return arguments.length?(m=d3.functor(t),q):m},d3.rebind(q,k,"on")}function e(t){return t.text}function r(){return"serif"}function a(){return"normal"}function o(t){return Math.sqrt(t.value)}function i(){return 30*(~~(6*Math.random())-3)}function u(){return 1}function f(t,n,e){if(!t.sprite){w.clearRect(0,0,(v<<5)/M,p/M);var r=0,a=0,o=0,i=n.length;for(--e;++e<i;){t=n[e],w.save(),w.font=t.style+" "+t.weight+" "+~~((t.size+1)/M)+"px "+t.font;var u=w.measureText(t.text+"m").width*M,f=t.size<<1;if(t.rotate){var l=Math.sin(t.rotate*g),c=Math.cos(t.rotate*g),h=u*c,y=u*l,s=f*c,x=f*l;u=Math.max(Math.abs(h+x),Math.abs(h-x))+31>>5<<5,f=~~Math.max(Math.abs(y+s),Math.abs(y-s))}else u=u+31>>5<<5;if(f>o&&(o=f),r+u>=v<<5&&(r=0,a+=o,o=0),a+f>=p)break;w.translate((r+(u>>1))/M,(a+(f>>1))/M),t.rotate&&w.rotate(t.rotate*g),w.fillText(t.text,0,0),t.padding&&(w.lineWidth=2*t.padding,w.strokeText(t.text,0,0)),w.restore(),t.width=u,t.height=f,t.xoff=r,t.yoff=a,t.x1=u>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,r+=u}for(var d=w.getImageData(0,0,(v<<5)/M,p/M).data,m=[];--e>=0;)if(t=n[e],t.hasText){for(var u=t.width,b=u>>5,f=t.y1-t.y0,z=0;z<f*b;z++)m[z]=0;if(r=t.xoff,null==r)return;a=t.yoff;for(var I=0,k=-1,T=0;T<f;T++){for(var z=0;z<u;z++){var q=b*T+(z>>5),D=d[(a+T)*(v<<5)+(r+z)<<2]?1<<31-z%32:0;m[q]|=D,I|=D}I?k=T:(t.y0++,f--,T--,a++)}t.y1=t.y0+k,t.sprite=m.slice(0,(t.y1-t.y0)*b)}}}function l(t,n,e){e>>=5;for(var r,a=t.sprite,o=t.width>>5,i=t.x-(o<<4),u=127&i,f=32-u,l=t.y1-t.y0,c=(t.y+t.y0)*e+(i>>5),h=0;h<l;h++){r=0;for(var y=0;y<=o;y++)if((r<<f|(y<o?(r=a[h*o+y])>>>u:0))&n[c+y])return!0;c+=e}return!1}function c(t,n){var e=t[0],r=t[1];n.x+n.x0<e.x&&(e.x=n.x+n.x0),n.y+n.y0<e.y&&(e.y=n.y+n.y0),n.x+n.x1>r.x&&(r.x=n.x+n.x1),n.y+n.y1>r.y&&(r.y=n.y+n.y1)}function h(t,n){return t.x+t.x1>n[0].x&&t.x+t.x0<n[1].x&&t.y+t.y1>n[0].y&&t.y+t.y0<n[1].y}function y(t){var n=t[0]/t[1];return function(t){return[n*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function s(t){var n=4,e=n*t[0]/t[1],r=0,a=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:r+=e;break;case 1:a+=n;break;case 2:r-=e;break;default:a-=n}return[r,a]}}function x(t){for(var n=[],e=-1;++e<t;)n[e]=0;return n}var d,g=Math.PI/180,v=64,p=2048,M=1;if("undefined"!=typeof document)d=document.createElement("canvas"),d.width=1,d.height=1,M=Math.sqrt(d.getContext("2d").getImageData(0,0,1,1).data.length>>2),d.width=(v<<5)/M,d.height=p/M;else{var m=require("canvas");d=new m(v<<5,p)}var w=d.getContext("2d"),b={archimedean:y,rectangular:s};w.fillStyle=w.strokeStyle="red",w.textAlign="center",t.cloud=n}("undefined"==typeof exports?d3.layout||(d3.layout={}):exports);
//# sourceMappingURL=d3.layout.cloud.min.js.map