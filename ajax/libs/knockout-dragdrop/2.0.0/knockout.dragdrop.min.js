!function(e){"function"==typeof define&&define.amd?define(["knockout"],e):e(ko)}(function(e){function t(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e}function n(e,t,n){var i=e.className.split(" "),r=i.indexOf(t);r>=0&&!n&&i.splice(r,1),r<0&&n&&i.push(t),e.className=i.join(" ")}function i(e,t){if(!e.tagName)return null;var n=document.documentElement;return(n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector).call(e,t)}function r(e,t){do{if(i(e,t))return e;e=e.parentNode}while(e);return null}function o(e){this.init(e)}function a(e){this.init(e),this.drop=function(t){e.drop(t,e.data)}}function s(e){this.element=e,n(this.element,"drag-element",!0),this.element.style.position="fixed",this.element.style.zIndex=9998,this.element.addEventListener("selectstart",function(){return!1},!0)}function l(e){this.element=e.element,this.name=e.name,this.dragStart=e.dragStart,this.dragEnd=e.dragEnd,this.data=e.data}function d(e,t){var n=e.getBoundingClientRect();this.element=e,this.scrollMargin=Math.floor(n.height/10),this.offset={top:n.top+window.pageYOffset-document.documentElement.clientTop,left:n.left+window.pageXOffset-document.documentElement.clientLeft},this.innerHeight=n.height,this.scrollDeltaMin=5,this.scrollDeltaMax=30,this.delay=t||0,this.inZone="center",this.scrolling=!1}var c={},h={},u=e.utils.arrayForEach,p=e.utils.arrayFirst,m=e.utils.arrayFilter;o.prototype.init=function(e){this.element=e.element,this.data=e.data,this.dragEnter=e.dragEnter,this.dragOver=e.dragOver,this.dragLeave=e.dragLeave,this.active=!1,this.inside=!1,this.dirty=!1},o.prototype.refreshDomInfo=function(){if(this.hidden="none"===this.element.style.display,!this.hidden){var e=this.element.getBoundingClientRect();this.top=e.top+window.pageYOffset-document.documentElement.clientTop,this.left=e.left+window.pageXOffset-document.documentElement.clientLeft,this.width=e.width,this.height=e.height}},o.prototype.isInside=function(e,t){return!this.hidden&&(!(e<this.left||t<this.top)&&(!(this.left+this.width<e)&&!(this.top+this.height<t)))},o.prototype.update=function(e,t){this.isInside(e.pageX,e.pageY)?(this.inside||this.enter(e,t),this.dragOver&&this.dragOver(e,t,this.data)):this.leave(e)},o.prototype.enter=function(e,t){this.inside=!0,this.dragEnter?this.active=this.dragEnter(e,t,this.data)!==!1:this.active=!0,this.dirty=!0},o.prototype.leave=function(e){e&&(e.target=this.element),this.inside&&this.dragLeave&&this.dragLeave(e,this.data),this.active=!1,this.inside=!1,this.dirty=!0},a.prototype=o.prototype,a.prototype.updateStyling=function(){this.dirty&&(n(this.element,"drag-over",this.active),n(this.element,"drop-rejected",this.inside&&!this.active)),this.dirty=!1},s.prototype.updatePosition=function(e){this.element.style.top=e.pageY-window.pageYOffset+"px",this.element.style.left=e.pageX-window.pageXOffset+"px"},s.prototype.remove=function(){this.element.parentNode.removeChild(this.element)},l.prototype.startDrag=function(e){if(this.dragStart&&this.dragStart(this.data,e)===!1)return!1},l.prototype.drag=function(e){var t=this,n=this.name,i=c[n].concat(h[n]);u(i,function(e){e.refreshDomInfo()}),u(i,function(n){e.target=n.element,n.update(e,t.data)}),u(c[n],function(e){e.updateStyling()})},l.prototype.dropRejected=function(){var e=this.name;return!p(c[e],function(e){return e.inside})||!p(c[e],function(e){return e.active})},l.prototype.cancelDrag=function(e){this.dragEnd&&this.dragEnd(this.data,e)},l.prototype.drop=function(e){var t=this.name,n=r(e.target,".drop-zone"),i=m(c[t],function(e){return e.active}),o=m(i,function(e){return e.element===n})[0];u(c[t].concat(h[t]),function(t){t.leave(e)}),u(c[t],function(e){e.updateStyling()}),o&&o.drop&&o.drop(this.data),this.dragEnd&&this.dragEnd(this.data,e)},d.prototype.scroll=function(e,t){this.x=e,this.y=t,this.topLimit=this.scrollMargin+this.offset.top,this.bottomLimit=this.offset.top+this.innerHeight-this.scrollMargin,t<this.topLimit?this.updateZone("top"):t>this.bottomLimit?this.updateZone("bottom"):this.updateZone("center")},d.prototype.enter=function(e){var t=this;this.delayTimer=setTimeout(function(){t.scrolling=!0},this.delay)},d.prototype.leave=function(e){this.scrolling=!1,clearTimeout(this.delayTimer)},d.prototype.over=function(e){var t,n;this.scrolling&&("top"===e?(t=(this.topLimit-this.y)/this.scrollMargin,n=t*(this.scrollDeltaMax-this.scrollDeltaMin)+this.scrollDeltaMin,this.element.scrollTop-=n):"bottom"===e&&(t=(this.y-this.bottomLimit)/this.scrollMargin,n=t*(this.scrollDeltaMax-this.scrollDeltaMin)+this.scrollDeltaMin,this.element.scrollTop+=n))},d.prototype.updateZone=function(e){this.zone!==e&&(this.leave(this.zone),this.enter(e)),this.zone=e,this.over(e)},e.utils.extend(e.bindingHandlers,{dropZone:{init:function(t,i,r,o,s){var l=e.utils.unwrapObservable(i()),d=[];l.accepts?d=[].concat(l.accepts):d.push(l.name),n(t,"drop-zone",!0);var h=l.data||s&&s.$data,u=new a({element:t,data:h,drop:l.drop,dragEnter:l.dragEnter,dragOver:l.dragOver,dragLeave:l.dragLeave});d.forEach(function(e){c[e]=c[e]||[],c[e].push(u)}),e.utils.domNodeDisposal.addDisposeCallback(t,function(){u.leave(),d.forEach(function(e){c[e].splice(c[e].indexOf(u),1)})})}},dragEvents:{init:function(t,n,i,r,a){var s=e.utils.unwrapObservable(n()),l=s.name;h[l]=h[l]||[];var d=s.data||a&&a.$data,c=new o({element:t,data:d,dragEnter:s.dragEnter,dragOver:s.dragOver,dragLeave:s.dragLeave});h[l].push(c),e.utils.domNodeDisposal.addDisposeCallback(t,function(){c.leave(),h[l].splice(h[l].indexOf(c),1)})}},dragZone:{init:function(i,r,o,a,d){function u(){var e=i.cloneNode(!0);i.parentNode.appendChild(e);var t=window.getComputedStyle(i,null);return e.style.height=t.getPropertyValue("height"),e.style.width=t.getPropertyValue("width"),e.style.opacity=.7,e.style.filter="alpha(opacity=70)",e}function p(){var t=document.createElement("div");document.body.appendChild(t);var n="data"in f?d.createChildContext(f.data):d;return e.renderTemplate(f.element,n,{},t),t}function m(){return!1}var f=e.utils.unwrapObservable(r()),v=f.name,g="number"==typeof f.dragDistance?f.dragDistance:10;c[v]=c[v]||[],h[v]=h[v]||[];var y=f.data||d&&d.$data,E=new l({element:i,name:v,data:y,dragStart:f.dragStart,dragEnd:f.dragEnd});i.addEventListener("selectstart",function(e){if("input"!==e.target.tagName.toLowerCase())return!1},!0),n(i,"draggable",!0),i.addEventListener("mousedown",function(e){function r(r){function l(e){E.drag(e);var t=E.dropRejected();t!==g&&(n(h,"drop-rejected",t),h.style.cursor=t?"no-drop":"move",g=t),v=setTimeout(function(){l(e)},100)}function d(e){return clearTimeout(v),c&&c.remove(),h.parentNode.removeChild(h),E.cancelDrag(e),!0}if(i.removeEventListener("mouseup",o),i.removeEventListener("click",o),i.removeEventListener("mouseleave",o),i.removeEventListener("mousemove",a),E.startDrag(e)===!1)return!1;var c=null;void 0===f.element&&(c=new s(u()));var h=document.createElement("div");h.className="drag-overlay",h.setAttribute("unselectable","on"),h.style.zIndex=9999,h.style.position="fixed",h.style.top=0,h.style.left=0,h.style.right=0,h.style.bottom=0,h.style.cursor="move",h.style.backgroundColor="white",h.style.opacity=0,h.style.filter="alpha(opacity=0)",h.style.userSelect="none",h.style.webkitUserSelect="none",h.style.MozUserSelect="none",h.style.msUserSelect="none",h.style.OUserSelect="none",h.addEventListener("selectstart",m),document.body.appendChild(h),f.element&&(c=new s(p())),c&&c.updatePosition(e);var v=null,g=!1;h.addEventListener("mousemove",function(e){return 1!==e.which?d(e):(clearTimeout(v),c&&c.updatePosition(e),l(e),!1)}),h.addEventListener("mouseup",function(e){clearTimeout(v),c&&c.remove(),h.parentNode.removeChild(h);var n=t({},e);return n.target=document.elementFromPoint(e.clientX,e.clientY),E.drop(n),document.removeEventListener("selectstart",m),!1})}function o(e){return i.removeEventListener("mouseup",o),i.removeEventListener("click",o),i.removeEventListener("mouseleave",o),i.removeEventListener("mousemove",a),document.removeEventListener("selectstart",m),!0}function a(t){if("input"!==t.target.tagName.toLowerCase()){return Math.sqrt(Math.pow(e.pageX-t.pageX,2)+Math.pow(e.pageY-t.pageY,2))>g&&r(t),!1}}return 1!==e.which||(e.preventDefault(),document.addEventListener("selectstart",m,!0),i.addEventListener("mouseup",o),i.addEventListener("click",o),i.addEventListener("mouseleave",o),i.addEventListener("mousemove",a),!0)},!0),e.utils.domNodeDisposal.addDisposeCallback(i,function(){document.removeEventListener("selectstart",m)})}},scrollableOnDragOver:{init:function(t,n,i){function r(){p.scroll(c,h)}function o(e){p=new d(t,l.delay),u=setInterval(r,100)}function a(e){c=e.pageX,h=e.pageY}function s(e){clearInterval(u)}var l=e.utils.unwrapObservable(n());"string"==typeof l&&(l={name:l}),l.delay=l.delay||0;var c,h,u,p=null;e.bindingHandlers.dragEvents.init(t,function(){return{name:l.name,dragEnter:o,dragOver:a,dragLeave:s}})}}})});
//# sourceMappingURL=knockout.dragdrop.min.js.map