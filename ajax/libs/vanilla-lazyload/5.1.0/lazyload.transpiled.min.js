"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _now(){return(new Date).getTime()}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_defaultSettings={elements_selector:"img",container:window,threshold:300,throttle:150,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",class_error:"error",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null},LazyLoad=function(){function e(t){_classCallCheck(this,e),this._settings=this._mergeObjects(_defaultSettings,t),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._boundHandleScroll=this.handleScroll.bind(this),window.addEventListener("resize",this._boundHandleScroll),this.update()}return _createClass(e,[{key:"_isInsideViewport",value:function(e,t,o){function n(){return window.innerWidth||d.documentElement.clientWidth||document.body.clientWidth}function i(){return window.innerHeight||d.documentElement.clientHeight||document.body.clientHeight}function s(e){return e.getBoundingClientRect().top+_-d.documentElement.clientTop}function l(e){return e.getBoundingClientRect().left+h-d.documentElement.clientLeft}function r(){var n;return n=t===window?i()+_:s(t)+t.offsetHeight,n<=s(e)-o}function a(){var i;return i=t===window?n()+window.pageXOffset:l(t)+n(),i<=l(e)-o}function c(){var n;return n=t===window?_:s(t),n>=s(e)+o+e.offsetHeight}function u(){var n;return n=t===window?h:l(t),n>=l(e)+o+e.offsetWidth}var d,_,h;return d=e.ownerDocument,_=window.pageYOffset||d.body.scrollTop,h=window.pageXOffset||d.body.scrollLeft,!(r()||c()||a()||u())}},{key:"_mergeObjects",value:function(e,t){var o,n={};for(o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);for(o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);return n}},{key:"_setSourcesForPicture",value:function(e,t){var o=e.parentElement;if("PICTURE"===o.tagName)for(var n=0;n<o.children.length;n++){var i=o.children[n];if("SOURCE"===i.tagName){var s=i.getAttribute("data-"+t);s&&i.setAttribute("srcset",s)}}}},{key:"_setSources",value:function(e,t,o){var n=e.tagName,i=e.getAttribute("data-"+o);if("IMG"===n){this._setSourcesForPicture(e,t);var s=e.getAttribute("data-"+t);return s&&e.setAttribute("srcset",s),void(i&&e.setAttribute("src",i))}return"IFRAME"===n?void(i&&e.setAttribute("src",i)):void(i&&(e.style.backgroundImage="url("+i+")"))}},{key:"_showOnAppear",value:function(e){function t(){e.removeEventListener("load",o),e.classList.remove(n.class_loading),e.classList.add(n.class_error),n.callback_error&&n.callback_error(e)}function o(){null!==n&&(e.classList.remove(n.class_loading),e.classList.add(n.class_loaded),e.removeEventListener("load",o),e.removeEventListener("error",t),n.callback_load&&n.callback_load(e))}var n=this._settings;"IMG"!==e.tagName&&"IFRAME"!==e.tagName||(e.addEventListener("load",o),e.addEventListener("error",t),e.classList.add(n.class_loading)),this._setSources(e,n.data_srcset,n.data_src),n.callback_set&&n.callback_set(e)}},{key:"_loopThroughElements",value:function(){var e=void 0,t=void 0,o=this._settings,n=this._elements,i=n?n.length:0,s=[];for(e=0;e<i;e++)t=n[e],o.skip_invisible&&null===t.offsetParent||this._isInsideViewport(t,o.container,o.threshold)&&(this._showOnAppear(t),s.push(e),t.wasProcessed=!0);for(;s.length>0;)n.splice(s.pop(),1),o.callback_processed&&o.callback_processed(n.length);0===i&&this._stopScrollHandler()}},{key:"_purgeElements",value:function(){var e=void 0,t=void 0,o=this._elements,n=o.length,i=[];for(e=0;e<n;e++)t=o[e],t.wasProcessed&&i.push(e);for(;i.length>0;)o.splice(i.pop(),1)}},{key:"_startScrollHandler",value:function(){this._isHandlingScroll||(this._isHandlingScroll=!0,this._settings.container.addEventListener("scroll",this._boundHandleScroll))}},{key:"_stopScrollHandler",value:function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,this._settings.container.removeEventListener("scroll",this._boundHandleScroll))}},{key:"handleScroll",value:function(){var e=this,t=void 0,o=void 0,n=void 0;this._settings&&(o=_now(),n=this._settings.throttle,0!==n?(t=n-(o-this._previousLoopTime),t<=0||t>n?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=o,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(function(){e._previousLoopTime=_now(),e._loopTimeout=null,e._loopThroughElements()},t))):this._loopThroughElements())}},{key:"update",value:function(){this._elements=Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()}},{key:"destroy",value:function(){window.removeEventListener("resize",this._boundHandleScroll),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null}}]),e}();!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t():e.LazyLoad=t()}(window,function(){return LazyLoad});
//# sourceMappingURL=lazyload.transpiled.min.js.map