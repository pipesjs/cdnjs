!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],e):e(n.d3_drag=n.d3_drag||{},n.d3_dispatch,n.d3_selection)}(this,function(n,e,t){"use strict";function o(){for(var n,e=t.event;n=e.sourceEvent;)e=n;e.preventDefault(),e.stopPropagation()}function i(n){return function(){return n}}function r(n,e,t,o,i,r){this.type=n,this.subject=e,this.identifier=t,this.x=o,this.y=i,this._=r}function u(){t.event.on("drag.noclick",null).on("end.noclick",function(){var n="click.noclick-"+t.event.identifier,e=t.select(t.event.sourceEvent.view).on(n,o,!0);setTimeout(function(){e.on(n,null)},0)})}function c(){var n="dragstart.nodrag-"+t.event.identifier,e=t.select(t.event.sourceEvent.view).on(n,o,!0);t.event.on("end.nodrag",function(){e.on(n,null)})}function s(){var n="selectstart.noselect-"+t.event.identifier,e=t.select(t.event.sourceEvent.view).on(n,o,!0);t.event.on("end.noselect",function(){e.on(n,null)})}function a(){var n=this.ownerDocument.documentElement.style,e=n.MozUserSelect;n.MozUserSelect="none",t.event.on("end.noselect",function(){n.MozUserSelect=e})}function f(){return("onselectstart"in this?s:a).apply(this,arguments)}function l(){return!t.event.button}function d(){return this.parentNode}function v(n){return n}function p(){return t.event.subject.x}function h(){return t.event.subject.y}function g(n){function s(n){n.on("mousedown.drag",a).on("touchstart.drag",m).on("touchmove.drag",b).on("touchend.drag touchcancel.drag",w).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function a(){if(E.apply(this,arguments)){var n=j.apply(this,arguments);_("mouse",n,t.mouse,this,arguments)&&t.select(t.event.view).on("mousemove.drag",g).on("mouseup.drag",y)}}function g(){z.mouse("drag")}function y(){var n=z.mouse;t.select(t.event.view).on("mousemove.drag mouseup.drag",null),delete z.mouse,n("end")}function m(){if(E.apply(this,arguments))for(var n=j.apply(this,arguments),e=t.event.changedTouches,o=0,i=e.length;i>o;++o)_(e[o].identifier,n,t.touch,this,arguments)}function b(){for(var n,e=t.event.changedTouches,o=0,i=e.length;i>o;++o)(n=z[e[o].identifier])&&n("drag")}function w(){for(var n,e=t.event.changedTouches,o=0,i=e.length;i>o;++o)(n=z[e[o].identifier])&&(delete z[e[o].identifier],n("end"))}function _(n,e,o,i,u){var c,s,a,f=o(e,n),l=M.copy();return t.customEvent(new r("beforestart",a,n,f[0],f[1],l),function(){return a=t.event.subject=k.apply(i,u),null==a?!1:(c=x.apply(i,u)-f[0]||0,s=T.apply(i,u)-f[1]||0,!0)})?((z[n]=function(f,d){null==d&&(d=o(e,n)),t.customEvent(new r(f,a,n,d[0]+c,d[1]+s,l),l.apply,l,[f,i,u])})("start",f),!0):!1}var E=l,j=d,k=v,x=p,T=h,z={},M=e.dispatch("start","drag","end").on("start.nodrag",c).on("start.noselect",f).on("start",n).on("drag.noclick",u).on("drag.noscroll",o);return s.filter=function(n){return arguments.length?(E="function"==typeof n?n:i(!!n),s):E},s.container=function(n){return arguments.length?(j="function"==typeof n?n:i(n),s):j},s.subject=function(n){return arguments.length?(k="function"==typeof n?n:i(n),s):k},s.x=function(n){return arguments.length?(x="function"==typeof n?n:i(+n),s):x},s.y=function(n){return arguments.length?(T="function"==typeof n?n:i(+n),s):T},s.on=function(){var n=M.on.apply(M,arguments);return n===M?s:n},s}var y="0.1.1";r.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n},n.version=y,n.drag=g});