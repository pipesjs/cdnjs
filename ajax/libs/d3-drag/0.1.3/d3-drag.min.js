!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],e):e(t.d3_drag=t.d3_drag||{},t.d3_dispatch,t.d3_selection)}(this,function(t,e,n){"use strict";function o(){n.event.stopImmediatePropagation()}function r(){n.event.preventDefault(),n.event.stopImmediatePropagation()}function i(t){return function(){return t}}function u(t,e,n,o,r,i,u){this.type=t,this.subject=e,this.identifier=n,this.active=o,this.x=r,this.y=i,this._=u}function c(t){t.on("selectstart.drag",r,!0)}function a(t){t.on("selectstart.drag",null)}function s(){var t=n.event.view.document.documentElement,e=t.style;t.__noselect=e.MozUserSelect,e.MozUserSelect="none"}function f(){var t=n.event.view.document.documentElement;t.style.MozUserSelect=t.__noselect,delete t.__noselect}function d(t){return("onselectstart"in n.event.target?c:s)(t)}function l(t){return("onselectstart"in n.event.target?a:f)(t)}function p(){return!n.event.button}function h(){return this.parentNode}function g(t){return t}function v(){return n.event.subject.x}function m(){return n.event.subject.y}function y(t){function c(t){t.on("mousedown.drag",a).on("touchstart.drag",y).on("touchmove.drag",_).on("touchend.drag touchcancel.drag",b).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function a(){if(!x&&T.apply(this,arguments)){var t=w("mouse",k.apply(this,arguments),n.mouse,this,arguments);t&&(n.select(n.event.view).on("mousemove.drag",s,!0).on("mouseup.drag",f,!0).on("dragstart.drag",r,!0).call(d),o(),j=!1,t("start"))}}function s(){r(),j=!0,S.mouse("drag")}function f(){var t=n.select(n.event.view).on("mousemove.drag mouseup.drag dragstart.drag",null).call(l);j&&(t.on("click.drag",r,!0),setTimeout(function(){t.on("click.drag",null)},0)),r(),S.mouse("end")}function y(){if(T.apply(this,arguments)){var t,e,r=n.event.changedTouches,i=k.apply(this,arguments),u=r.length;for(o(),t=0;u>t;++t)(e=w(r[t].identifier,i,n.touch,this,arguments))&&e("start")}}function _(){var t,e,o=n.event.changedTouches,i=o.length;for(r(),t=0;i>t;++t)(e=S[o[t].identifier])&&e("drag")}function b(){var t,e,r=n.event.changedTouches,i=r.length;for(o(),x&&clearTimeout(x),x=setTimeout(function(){x=null},500),t=0;i>t;++t)(e=S[r[t].identifier])&&e("end")}function w(t,e,o,r,i){var c,a,s,f=o(e,t),d=U.copy();if(n.customEvent(new u("beforestart",s,t,q,f[0],f[1],d),function(){return null==(n.event.subject=s=E.apply(r,i))?!1:(c=z.apply(r,i)-f[0]||0,a=M.apply(r,i)-f[1]||0,!0)}))return function l(p){var h,g;switch(p){case"start":h=f,S[t]=l,g=q++;break;case"end":delete S[t],--q;case"drag":h=o(e,t),g=q}n.customEvent(new u(p,s,t,g,h[0]+c,h[1]+a,d),d.apply,d,[p,r,i])}}var j,x,T=p,k=h,E=g,z=v,M=m,S={},U=e.dispatch("start","drag","end").on("start",t),q=0;return c.filter=function(t){return arguments.length?(T="function"==typeof t?t:i(!!t),c):T},c.container=function(t){return arguments.length?(k="function"==typeof t?t:i(t),c):k},c.subject=function(t){return arguments.length?(E="function"==typeof t?t:i(t),c):E},c.x=function(t){return arguments.length?(z="function"==typeof t?t:i(+t),c):z},c.y=function(t){return arguments.length?(M="function"==typeof t?t:i(+t),c):M},c.on=function(){var t=U.on.apply(U,arguments);return t===U?c:t},c}var _="0.1.3";u.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t},t.version=_,t.drag=y});