!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],t):t(e.d3_drag=e.d3_drag||{},e.d3_dispatch,e.d3_selection)}(this,function(e,t,n){"use strict";function o(){n.event.stopImmediatePropagation()}function i(){n.event.preventDefault(),n.event.stopImmediatePropagation()}function r(e){var t=e.document.documentElement,o=n.select(e).on("dragstart.drag",i,!0);"onselectstart"in t?o.on("selectstart.drag",i,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function c(e,t){var o=e.document.documentElement,r=n.select(e).on("dragstart.drag",null);t&&(r.on("click.drag",i,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in o?r.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function u(e){return function(){return e}}function s(e,t,n,o,i,r,c,u,s){this.type=e,this.subject=t,this.identifier=n,this.active=o,this.x=i,this.y=r,this.dx=c,this.dy=u,this._=s}function a(){return!n.event.button}function d(){return this.parentNode}function l(e){return null==e?{x:n.event.x,y:n.event.y}:e}function f(){function e(e){e.on("mousedown.drag",f).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",m).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!b&&w.apply(this,arguments)){var e=y("mouse",x.apply(this,arguments),n.mouse,this,arguments);e&&(n.select(n.event.view).on("mousemove.drag",h,!0).on("mouseup.drag",p,!0),r(n.event.view),o(),_=!1,e("start"))}}function h(){i(),_=!0,E.mouse("drag")}function p(){n.select(n.event.view).on("mousemove.drag mouseup.drag",null),c(n.event.view,_),i(),E.mouse("end")}function g(){if(w.apply(this,arguments)){var e,t,i=n.event.changedTouches,r=x.apply(this,arguments),c=i.length;for(o(),e=0;c>e;++e)(t=y(i[e].identifier,r,n.touch,this,arguments))&&t("start")}}function v(){var e,t,o=n.event.changedTouches,r=o.length;for(i(),e=0;r>e;++e)(t=E[o[e].identifier])&&t("drag")}function m(){var e,t,i=n.event.changedTouches,r=i.length;for(o(),b&&clearTimeout(b),b=setTimeout(function(){b=null},500),e=0;r>e;++e)(t=E[i[e].identifier])&&t("end")}function y(e,t,o,i,r){var c,u,a,d=o(t,e),l=j.copy();if(n.customEvent(new s("beforestart",c,e,k,d[0],d[1],0,0,l),function(){return null==(n.event.subject=c=T.apply(i,r))?!1:(u=c.x-d[0]||0,a=c.y-d[1]||0,!0)}))return function f(h){var p,g=d;switch(h){case"start":E[e]=f,p=k++;break;case"end":delete E[e],--k;case"drag":d=o(t,e),p=k}n.customEvent(new s(h,c,e,p,d[0]+u,d[1]+a,d[0]-g[0],d[1]-g[1],l),l.apply,l,[h,i,r])}}var _,b,w=a,x=d,T=l,E={},j=t.dispatch("start","drag","end"),k=0;return e.filter=function(t){return arguments.length?(w="function"==typeof t?t:u(!!t),e):w},e.container=function(t){return arguments.length?(x="function"==typeof t?t:u(t),e):x},e.subject=function(t){return arguments.length?(T="function"==typeof t?t:u(t),e):T},e.on=function(){var t=j.on.apply(j,arguments);return t===j?e:t},e}var h="0.2.0";s.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e},e.version=h,e.drag=f,e.dragDisable=r,e.dragEnable=c});