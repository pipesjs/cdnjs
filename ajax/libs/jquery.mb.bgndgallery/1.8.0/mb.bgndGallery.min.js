!function(){if(!(8>jQuery.fn.jquery.split(".")[1])){jQuery.browser={},jQuery.browser.mozilla=!1,jQuery.browser.webkit=!1,jQuery.browser.opera=!1,jQuery.browser.msie=!1;var e=navigator.userAgent;jQuery.browser.name=navigator.appName,jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10);var r,o;-1!=(o=e.indexOf("Opera"))?(jQuery.browser.opera=!0,jQuery.browser.name="Opera",jQuery.browser.fullVersion=e.substring(o+6),-1!=(o=e.indexOf("Version"))&&(jQuery.browser.fullVersion=e.substring(o+8))):-1!=(o=e.indexOf("MSIE"))?(jQuery.browser.msie=!0,jQuery.browser.name="Microsoft Internet Explorer",jQuery.browser.fullVersion=e.substring(o+5)):-1!=(o=e.indexOf("Chrome"))?(jQuery.browser.webkit=!0,jQuery.browser.name="Chrome",jQuery.browser.fullVersion=e.substring(o+7)):-1!=(o=e.indexOf("Safari"))?(jQuery.browser.webkit=!0,jQuery.browser.name="Safari",jQuery.browser.fullVersion=e.substring(o+7),-1!=(o=e.indexOf("Version"))&&(jQuery.browser.fullVersion=e.substring(o+8))):-1!=(o=e.indexOf("Firefox"))?(jQuery.browser.mozilla=!0,jQuery.browser.name="Firefox",jQuery.browser.fullVersion=e.substring(o+8)):(r=e.lastIndexOf(" ")+1)<(o=e.lastIndexOf("/"))&&(jQuery.browser.name=e.substring(r,o),jQuery.browser.fullVersion=e.substring(o+1),jQuery.browser.name.toLowerCase()==jQuery.browser.name.toUpperCase()&&(jQuery.browser.name=navigator.appName)),-1!=(e=jQuery.browser.fullVersion.indexOf(";"))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,e)),-1!=(e=jQuery.browser.fullVersion.indexOf(" "))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,e)),jQuery.browser.majorVersion=parseInt(""+jQuery.browser.fullVersion,10),isNaN(jQuery.browser.majorVersion)&&(jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10)),jQuery.browser.version=jQuery.browser.majorVersion}}(jQuery),function(){if(!(8>jQuery.fn.jquery.split(".")[1])){jQuery.browser={},jQuery.browser.mozilla=!1,jQuery.browser.webkit=!1,jQuery.browser.opera=!1,jQuery.browser.msie=!1;var e=navigator.userAgent;jQuery.browser.name=navigator.appName,jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10);var r,o;-1!=(o=e.indexOf("Opera"))?(jQuery.browser.opera=!0,jQuery.browser.name="Opera",jQuery.browser.fullVersion=e.substring(o+6),-1!=(o=e.indexOf("Version"))&&(jQuery.browser.fullVersion=e.substring(o+8))):-1!=(o=e.indexOf("MSIE"))?(jQuery.browser.msie=!0,jQuery.browser.name="Microsoft Internet Explorer",jQuery.browser.fullVersion=e.substring(o+5)):-1!=(o=e.indexOf("Chrome"))?(jQuery.browser.webkit=!0,jQuery.browser.name="Chrome",jQuery.browser.fullVersion=e.substring(o+7)):-1!=(o=e.indexOf("Safari"))?(jQuery.browser.webkit=!0,jQuery.browser.name="Safari",jQuery.browser.fullVersion=e.substring(o+7),-1!=(o=e.indexOf("Version"))&&(jQuery.browser.fullVersion=e.substring(o+8))):-1!=(o=e.indexOf("Firefox"))?(jQuery.browser.mozilla=!0,jQuery.browser.name="Firefox",jQuery.browser.fullVersion=e.substring(o+8)):(r=e.lastIndexOf(" ")+1)<(o=e.lastIndexOf("/"))&&(jQuery.browser.name=e.substring(r,o),jQuery.browser.fullVersion=e.substring(o+1),jQuery.browser.name.toLowerCase()==jQuery.browser.name.toUpperCase()&&(jQuery.browser.name=navigator.appName)),-1!=(e=jQuery.browser.fullVersion.indexOf(";"))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,e)),-1!=(e=jQuery.browser.fullVersion.indexOf(" "))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,e)),jQuery.browser.majorVersion=parseInt(""+jQuery.browser.fullVersion,10),isNaN(jQuery.browser.majorVersion)&&(jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10)),jQuery.browser.version=jQuery.browser.majorVersion}}(jQuery),jQuery.fn.CSSAnimate=function(e,r,o,t,n){return this.each(function(){var i=jQuery(this);if(this.id=this.id||"CSSA_"+(new Date).getTime(),0!==i.length&&e){if("function"==typeof r&&(n=r,r=jQuery.fx.speeds._default),"function"==typeof o&&(n=o,o=0),"function"==typeof t&&(n=t,t="cubic-bezier(0.65,0.03,0.36,0.72)"),"string"==typeof r)for(var a in jQuery.fx.speeds){if(r==a){r=jQuery.fx.speeds[a];break}r=null}if(jQuery.support.transition){var s="",l="transitionEnd";jQuery.browser.webkit?(s="-webkit-",l="webkitTransitionEnd"):jQuery.browser.mozilla?(s="-moz-",l="transitionend"):jQuery.browser.opera?(s="-o-",l="otransitionend"):jQuery.browser.msie&&(s="-ms-",l="msTransitionEnd"),a=[];for(p in e){var u=p;"transform"===u&&(u=s+"transform",e[u]=e[p],delete e[p]),"transform-origin"===u&&(u=s+"transform-origin",e[u]=e[p],delete e[p]),a.push(u)}var p=a.join(","),g=function(){i.off(l+"_"+i.get(0).id),clearTimeout(i.get(0).timeout),i.css(s+"transition",""),"function"==typeof n&&(i.called=!0,n(i))},f={};$.extend(f,e),f[s+"transition-property"]=p,f[s+"transition-duration"]=r+"ms",f[s+"transition-delay"]=o+"ms",f[s+"transition-timing-function"]=t,f[s+"backface-visibility"]="hidden",setTimeout(function(){i.css(f),i.one(l+"_"+i.get(0).id,g)},1),i.get(0).timeout=setTimeout(function(){i.called||!n?i.called=!1:(i.css(s+"transition",""),n(i))},r+o+100)}else{for(var p in e)"transform"===p&&delete e[p],"transform-origin"===p&&delete e[p],"auto"===e[p]&&delete e[p];n&&"string"!=typeof n||(n="linear"),i.animate(e,r,n)}}})},jQuery.support.transition=function(){var e=(document.body||document.documentElement).style;return void 0!==e.transition||void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.MsTransition||void 0!==e.OTransition}(),function(e){function r(e){var r=document.createElement("canvas"),o=r.getContext("2d"),t=e.width,n=e.height;r.width=t,r.height=n,o.drawImage(e,0,0);for(var i=o.getImageData(0,0,t,n),a=0;a<i.height;a++)for(var s=0;s<i.width;s++){var l=4*a*i.width+4*s,u=(i.data[l]+i.data[l+1]+i.data[l+2])/3;i.data[l]=u,i.data[l+1]=u,i.data[l+2]=u}return o.putImageData(i,0,0,0,0,i.width,i.height),r.toDataURL()}e.mbBgndGallery={name:"mb.bgndGallery",author:"Matteo Bicocchi",version:"1.8.0",defaults:{containment:"body",images:[],shuffle:!1,controls:null,effect:"fade",timer:4e3,effTimer:3e3,raster:!1,folderPath:!1,autoStart:!0,grayScale:!1,activateKeyboard:!0,preserveTop:!1,preserveWidth:!1,placeHolder:"",onStart:function(){},onChange:function(e,r){},onPause:function(e){},onPlay:function(e){},onNext:function(e){},onPrev:function(e){}},clear:!1,effects:{fade:{enter:{left:0,opacity:0},exit:{left:0,opacity:0},enterTiming:"ease-in",exitTiming:"ease-in"},slideUp:{enter:{top:"100%",opacity:1},exit:{top:0,opacity:0},enterTiming:"ease-in",exitTiming:"ease-in"},slideDown:{enter:{top:"-100%",opacity:1},exit:{top:0,opacity:0},enterTiming:"ease-in",exitTiming:"ease-in"},slideLeft:{enter:{left:"100%",opacity:1},exit:{left:0,opacity:0},enterTiming:"ease-in",exitTiming:"ease-in"},slideRight:{enter:{left:"-100%",opacity:1},exit:{left:0,opacity:0},enterTiming:"ease-in",exitTiming:"ease-in"},zoom:{enter:{transform:"scale("+(1+5*Math.random())+")",opacity:0},exit:{transform:"scale("+(1+5*Math.random())+")",opacity:0},enterTiming:"cubic-bezier(0.19, 1, 0.22, 1)",exitTiming:"cubic-bezier(0.19, 1, 0.22, 1)"}},buildGallery:function(r){var o={};e.extend(o,e.mbBgndGallery.defaults,r),o.galleryID=(new Date).getTime();var t=e(o.containment).get(0);t.opt=o,t.opt.onStart&&t.opt.onStart(),t.opt.gallery=e("<div/>").attr({id:"bgndGallery_"+t.opt.galleryID}).addClass("mbBgndGallery");var n="body"==t.opt.containment?"fixed":"absolute";t.opt.gallery.css({position:n,top:0,let:0,width:"100%",height:"100%",overflow:"hidden"});var i=t.opt.containment;if("body"!=i&&""!=e(i).text().trim()){var a=e("<div/>").css({position:"absolute",minHeight:"100%",minWidth:"100%",zIndex:3});e(i).wrapInner(a),"static"==e(i).css("position")&&e(i).css("position","relative")}if(o.raster){var s=e("<div/>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"url("+o.raster+")",zIndex:1});o.gallery.append(s)}e(i).prepend(o.gallery),t.opt.folderPath&&0==t.opt.images.length&&(t.opt.images=jQuery.loadFromSystem(t.opt.folderPath)),t.opt.shuffle&&(t.opt.images=e.shuffle(t.opt.images));var l=t.opt.images.length,u=0;e.mbBgndGallery.preload(t.opt.images[0],t),e(t.opt.gallery).on("imageLoaded."+t.opt.galleryID,function(){return u++,u==l?void e(t.opt.gallery).off("imageLoaded."+t.opt.galleryID):void e.mbBgndGallery.preload(t.opt.images[u],t)}),t.opt.imageCounter=0,e.mbBgndGallery.changePhoto(t.opt.images[t.opt.imageCounter],t),o.autoStart||(t.opt.paused=!0,e(t.opt.gallery).trigger("paused")),e(t.opt.gallery).on("imageReady."+t.opt.galleryID,function(){t.opt.paused||(clearTimeout(t.opt.changing),e.mbBgndGallery.play(t))}),e(window).on("resize",function(){var r=e("#bgndGallery_"+t.opt.galleryID+" img");e.mbBgndGallery.checkSize(r,t)});var p=t.opt.controls;if(p){var g=e(t.opt.controls).find(".counter");g.html(t.opt.imageCounter+1+" / "+t.opt.images.length),e.mbBgndGallery.buildControls(p,t),e(t.opt.containment).on("paused",function(){e(t.opt.controls).find(".play").show(),e(t.opt.controls).find(".pause").hide()}),e(t.opt.containment).on("play",function(){e(t.opt.controls).find(".play").hide(),e(t.opt.controls).find(".pause").show()})}},normalizeCss:function(r){var o=jQuery.extend(!0,{},r),t="",n="transitionEnd";e.browser.webkit?(t="-webkit-",n="webkitTransitionEnd"):e.browser.mozilla?(t="-moz-",n="transitionend"):e.browser.opera?(t="-o-",n="oTransitionEnd"):e.browser.msie&&(t="-ms-",n="msTransitionEnd");for(var i in o)"transform"===i&&(o[t+"transform"]=o[i],delete o[i]),"transform-origin"===i&&(o[t+"transform-origin"]=r[i],delete o[i]);return o},preload:function(r,o){if(e.mbBgndGallery.clear)return void e(o.opt.gallery).remove();e("<img/>").load(function(){e(o.opt.gallery).trigger("imageLoaded."+o.opt.galleryID)}).attr("src",r)},checkSize:function(r,o){if(!e.mbBgndGallery.changing)return e.mbBgndGallery.clear?void e(o.opt.gallery).remove():r.each(function(){var r=e(this),t=r.attr("w"),n=r.attr("h"),i="body"==o.opt.containment?window:o.opt.containment,a=t/n,s=e(i).width()/e(i).height();a>=s?(r.css("height","100%"),r.css("width","auto")):(r.css("width","100%"),r.css("height","auto")),r.css("margin-left",(e(i).width()-r.width())/2),o.opt.preserveTop||r.css("margin-top",(e(i).height()-r.height())/2),o.opt.preserveWidth&&r.css({width:"100%",height:"auto",left:0,marginLeft:0})})},changePhoto:function(r,o){if(e.mbBgndGallery.clear)return void e(o.opt.gallery).remove();e.mbBgndGallery.changing=!0,o.opt.onChange&&o.opt.onChange(o.opt,o.opt.imageCounter);var t=e("<img/>").hide().load(function(){var r=e(this),t=e("<div/>").css({position:"absolute",top:-5e3});t.append(r),e("body").append(t),r.attr("w",r.width()),r.attr("h",r.height()),t.remove(),o.opt.effect="object"==typeof o.opt.effect?o.opt.effect:e.mbBgndGallery.effects[o.opt.effect],e("#bgndGallery_"+o.opt.galleryID+" img").CSSAnimate(o.opt.effect.exit,o.opt.effTimer,0,o.opt.effect.exitTiming,function(e){e.remove()}),r.css({position:"absolute"}),e("#bgndGallery_"+o.opt.galleryID).append(r),e.mbBgndGallery.changing=!1,e.mbBgndGallery.checkSize(r,o),r.css(e.mbBgndGallery.normalizeCss(o.opt.effect.enter)).show().CSSAnimate({top:0,left:0,opacity:1,transform:"scale(1) rotate(0deg)"},o.opt.effTimer,0,o.opt.effect.enterTiming,function(){e(o.opt.gallery).trigger("imageReady."+o.opt.galleryID)})}).attr("src",r);t.error(function(){var r=e(this);r.attr("src",o.opt.placeHolder)}),o.opt.grayScale&&t.greyScale();var n=e(o.opt.controls).find(".counter");n.html(o.opt.imageCounter+1+" / "+o.opt.images.length)},play:function(r){clearTimeout(r.opt.changing);var o=e("#bgndGallery_"+r.opt.galleryID+" img").not(":last");return o.remove(),e.mbBgndGallery.clear?void e(r.opt.gallery).remove():(r.opt.onPlay&&r.opt.onPlay(r.opt),r.opt.changing=setTimeout(function(){r.opt.paused||(r.opt.onNext&&r.opt.onNext(r.opt),r.opt.imageCounter>=r.opt.images.length-1&&(r.opt.imageCounter=-1),r.opt.imageCounter++,e.mbBgndGallery.changePhoto(r.opt.images[r.opt.imageCounter],e(r.opt.containment).get(0)))},r.opt.paused?0:r.opt.timer),void e(r.opt.gallery).trigger("play"))},pause:function(r){return e.mbBgndGallery.clear?void e(r.opt.gallery).remove():(clearTimeout(r.opt.changing),r.opt.paused=!0,e(r.opt.gallery).trigger("paused"),void(r.opt.onPause&&r.opt.onPause(r.opt)))},next:function(r){return e.mbBgndGallery.clear?void e(r.opt.gallery).remove():(r.opt.onNext&&r.opt.onNext(r.opt),e.mbBgndGallery.pause(r),r.opt.imageCounter==r.opt.images.length-1&&(r.opt.imageCounter=-1),r.opt.imageCounter++,e.mbBgndGallery.changePhoto(r.opt.images[r.opt.imageCounter],r),void clearTimeout(r.opt.changing))},prev:function(r){return e.mbBgndGallery.clear?void e(r.opt.gallery).remove():(r.opt.onPrev&&r.opt.onPrev(r.opt),e.mbBgndGallery.pause(r),clearTimeout(r.opt.changing),0==r.opt.imageCounter&&(r.opt.imageCounter=r.opt.images.length),r.opt.imageCounter--,void e.mbBgndGallery.changePhoto(r.opt.images[r.opt.imageCounter],r))},loader:{show:function(){},hide:function(){}},keyboard:function(r){e(document).on("keydown.bgndGallery",function(o){switch(o.keyCode){case 32:r.opt.paused?(e.mbBgndGallery.play(r),r.opt.paused=!1):(r.opt.paused=!0,e.mbBgndGallery.pause(r)),o.preventDefault();break;case 39:e.mbBgndGallery.next(r),o.preventDefault();break;case 37:e.mbBgndGallery.prev(r),o.preventDefault()}})},buildControls:function(r,o){var t=e(r).find(".pause"),n=e(r).find(".play"),i=e(r).find(".next"),a=e(r).find(".prev"),s=e(r).find(".fullscreen");(e.browser.msie||e.browser.opera)&&s.remove(),o.opt.autoStart&&n.hide(),t.on("click",function(){e.mbBgndGallery.pause(o),e(this).hide(),n.show()}),n.on("click",function(){o.opt.paused&&(clearTimeout(o.opt.changing),e.mbBgndGallery.play(o),o.opt.paused=!1)}),i.on("click",function(){e.mbBgndGallery.next(o),t.hide(),n.show()}),a.on("click",function(){e.mbBgndGallery.prev(o),t.hide(),n.show()}),s.on("click",function(){var r=e("#bgndGallery_"+o.opt.galleryID).get(0);e.mbBgndGallery.runFullscreen(r,o)}),o.opt.activateKeyboard&&e.mbBgndGallery.keyboard(o)},changeGallery:function(r,o){e(r.gallery).fadeOut(),e.mbBgndGallery.pause(r),r.opt.images=o;var t=r.opt.images,n=t.length,i=0;e.mbBgndGallery.preload(t[0],r),e(r.opt.gallery).on("imageLoaded."+r.opt.galleryID,function(){return i++,i==n?(e(r.opt.gallery).off("imageLoaded."+r.opt.galleryID),e(r.gallery).fadeIn(),e.mbBgndGallery.play(r),void(r.opt.paused=!1)):void e.mbBgndGallery.preload(t[i],r)}),r.opt.imageCounter=0},runFullscreen:function(r,o){function t(e,r){for(var o,t,n=["webkit","moz","ms","o",""],i=0;i<n.length&&!e[o];){if(o=r,""==n[i]&&(o=o.substr(0,1).toLowerCase()+o.substr(1)),o=n[i]+o,t=typeof e[o],"undefined"!=t)return n=[n[i]],"function"==t?e[o]():e[o];i++}}function n(r){t(r,"RequestFullScreen"),setTimeout(function(){var r=e.browser.mozilla?"mozfullscreenchange":e.browser.webkit?"webkitfullscreenchange":e.browser.msie?"msfullscreenchange":e.browser.opera?"ofullscreenchange":"fullscreenchange";e(document).one(r,function(r){var n=t(document,"IsFullScreen")||t(document,"FullScreen");n||(o.isFullscreen=!1,e(".fullScreen_controls").remove())})},1e3)}function i(){(t(document,"FullScreen")||t(document,"IsFullScreen"))&&t(document,"CancelFullScreen")}if(o.isFullscreen)i(),o.isFullscreen=!1,e(".fullScreen_controls").remove();else{o.isFullscreen=!0;var a=e(o.opt.controls).clone(!0).addClass("fullScreen_controls").css({position:"absolute",zIndex:1e3,bottom:20,right:20});a.find(".fullscreen").html("exit"),e(r).append(a),e(r).addClass("fullScreen"),n(r)}}},jQuery.loadFromSystem=function(r,o){if(r){o||(o=["jpg","jpeg","png"]);var t=[];return e.ajax({url:r,async:!1,success:function(n){var i=e(n),a=i.find("[href]");a.each(function(){for(var n in o)e(this).attr("href").indexOf(o[n])>=0&&t.push(r+e(this).attr("href")),t=e.unique(t)}),i.remove()}}),t}},e.fn.greyScale=function(){return this.each(function(){e.browser.msie&&e.browser.version<9?this.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)":this.src=r(this)})},e.shuffle=function(e){for(var r=e.slice(),o=r.length,t=o;t--;){var n=parseInt(Math.random()*o),i=r[t];r[t]=r[n],r[n]=i}return r}}(jQuery);