/* jquery.touch v1.0.0 | (c) @ajlkn | github.com/ajlkn/jquery.touch | MIT licensed */
!function(e){function t(e,t,n){var a=this;a.settings=n,a.$element=e,a.$sourceElement=t,a.inTap=!1,a.inTapAndHold=!1,a.inDrag=!1,a.tapStart=null,a.dragStart=null,a.timerTap=null,a.timerTapAndHold=null,a.mouseDown=!1,a.x=null,a.y=null,a.ex=null,a.ey=null,a.exStart=null,a.eyStart=null,a.taps=0,a.started=!1,a.ended=!1}function n(e,n,a){var r=e[0];return"undefined"==typeof r._touch&&(r._touch=new t(e,n,a)),r._touch}function a(e,t,n){var a,r,o,i,s;return a=e.$element.offset(),r=e.$element.width(),o=e.$element.height(),i=Math.min(Math.max(t,a.left),a.left+r),s=Math.min(Math.max(n,a.top),a.top+o),{x:i,y:s}}var r=e(document),o=null,i=null,s={useMouse:!0,trackDocument:!1,trackDocumentNormalize:!1,noClick:!1,dragThreshold:10,dragDelay:200,swipeThreshold:30,tapDelay:250,tapAndHoldDelay:500,delegateSelector:null,dropFilter:!1,preventDefault:{drag:!1,swipe:!1,tap:!1}};t.prototype.uses=function(t){var n=e._data(this.$sourceElement[0],"events");switch(t){case"swipe":return n.hasOwnProperty(t)||n.hasOwnProperty("swipeUp")||n.hasOwnProperty("swipeDown")||n.hasOwnProperty("swipeLeft")||n.hasOwnProperty("swipeRight");case"drag":return n.hasOwnProperty(t)||n.hasOwnProperty("dragStart")||n.hasOwnProperty("dragEnd");case"tapAndHold":case"doubleTap":return n.hasOwnProperty(t);case"tap":return n.hasOwnProperty(t)||n.hasOwnProperty("doubleTap")||n.hasOwnProperty("tapAndHold")}return!1},t.prototype.cancel=function(e){var t=this;t.taps=0,t.inTap=!1,t.inTapAndHold=!1,t.inDrag=!1,t.tapStart=null,t.dragStart=null,t.exStart=null,t.eyStart=null,e&&(t.mouseDown=!1)},t.prototype.doStart=function(e,t,n){var a=this,r=a.$element.offset();e.stopPropagation(),(a.uses("drag")&&a.settings.preventDefault.drag(a)||a.uses("swipe")&&a.settings.preventDefault.swipe(a)||a.uses("tap")&&a.settings.preventDefault.tap(a))&&e.preventDefault(),a.uses("tapAndHold")&&a.$element.css("-webkit-tap-highlight-color","rgba(0,0,0,0)").css("-webkit-touch-callout","none").css("-webkit-user-select","none"),a.x=t,a.y=n,a.ex=t-r.left,a.ey=n-r.top,a.tapStart=Date.now(),clearTimeout(a.timerTap),a.timerTap=setTimeout(function(){a.inTap&&a.taps>0&&(a.$element.trigger(2==a.taps?"doubleTap":"tap",{taps:a.taps,x:a.x,y:a.y,ex:a.ex,ey:a.ey,duration:Date.now()-a.tapStart,event:e}),a.cancel()),a.timerTap=null},a.settings.tapDelay),a.uses("tapAndHold")&&(clearTimeout(a.timerTapAndHold),a.timerTapAndHold=setTimeout(function(){a.inTap&&(a.$element.trigger("tapAndHold",{x:a.x,y:a.y,ex:a.ex,ey:a.ey,duration:Date.now()-a.tapStart,event:e}),a.cancel()),a.timerTapAndHold=null,a.inTapAndHold=!0},a.settings.tapAndHoldDelay)),a.inTap=!0},t.prototype.doMove=function(t,n,a){var s,l,u=this,p=u.$element.offset(),d=(Math.abs(u.x-n)+Math.abs(u.y-a))/2;if(t.stopPropagation(),(u.uses("swipe")&&u.settings.preventDefault.swipe(u)||u.uses("drag")&&u.settings.preventDefault.drag(u))&&t.preventDefault(),d>2&&clearTimeout(u.timerTapAndHold),u.inDrag&&o==u){if(u.$element.trigger("drag",{x:n,y:a,ex:n-p.left,ey:a-p.top,exStart:u.exStart,eyStart:u.eyStart,event:t}),u.$element.css("pointer-events","none"),s="fixed"==u.$element.css("position")?document.elementFromPoint(n-r.scrollLeft(),a-r.scrollTop()):document.elementFromPoint(n,a),u.$element.css("pointer-events",""),s){if(u.settings.dropFilter!==!1)switch(l=typeof u.settings.dropFilter){case"string":e(s).is(u.settings.dropFilter)||(s=null);break;case"function":u.settings.dropFilter(u.$element[0],s)===!1&&(s=null);break;default:case"boolean":if(u.settings.dropFilter===!0)for(;s.parentElement!=u.$element[0].parentElement;)if(s=s.parentElement,!s){s=null;break}}s===u.$element[0]&&(s=null)}i&&i!==s&&(u.$element.trigger("dragLeave",{element:i,event:t}),i=null),!i&&s&&(i=s,u.$element.trigger("dragEnter",{element:i,event:t})),i&&(p=e(i).offset(),u.$element.trigger("dragOver",{element:i,event:t,x:n,y:a,ex:n-p.left,ey:a-p.top}))}else if(d>u.settings.dragThreshold){if(Date.now()-u.tapStart<u.settings.dragDelay)return void u.cancel();u.cancel(),u.inDrag=!0,u.dragStart=Date.now(),u.exStart=n-p.left,u.eyStart=a-p.top,u.uses("drag")&&u.settings.preventDefault.drag(u)&&t.preventDefault(),u.$element.trigger("dragStart",{x:n,y:a,ex:u.exStart,ey:u.eyStart,event:t}),o=u}},t.prototype.doEnd=function(t,n,a){var r,s,l,u=this,p=u.$element.offset(),d=Math.abs(u.x-n),c=Math.abs(u.y-a);t.stopPropagation(),u.inTap?(clearTimeout(u.timerTapAndHold),u.taps++,(!u.timerTap||1==u.taps&&!u.uses("doubleTap")||2==u.taps&&u.uses("doubleTap"))&&(u.$element.trigger(2==u.taps?"doubleTap":"tap",{taps:u.taps,x:u.x,y:u.y,ex:u.ex,ey:u.ey,duration:Date.now()-u.tapStart,event:t}),u.cancel())):u.inDrag?(i&&(p=e(i).offset(),u.$element.trigger("drop",{element:i,event:t,x:n,y:a,ex:n-p.left,ey:a-p.top}),i=null),l=Date.now()-u.dragStart,r=Math.sqrt(Math.pow(Math.abs(u.x-n),2)+Math.pow(Math.abs(u.y-a),2)),s=r/l,u.$element.trigger("dragEnd",{start:{x:u.x,y:u.y,ex:u.ex,ey:u.ey},end:{x:n,y:a,ex:n-p.left,ey:a-p.top},distance:r,duration:l,velocity:s,event:t}),o=null,(d>u.settings.swipeThreshold||c>u.settings.swipeThreshold)&&(u.$element.trigger("swipe",{distance:r,duration:l,velocity:s,event:t}),d>c?(s=d/l,n<u.x?u.$element.trigger("swipeLeft",{distance:d,duration:l,velocity:s,event:t}):u.$element.trigger("swipeRight",{distance:d,duration:l,velocity:s,event:t})):c>d&&(s=c/l,a<u.y?u.$element.trigger("swipeUp",{distance:c,duration:l,velocity:s,event:t}):u.$element.trigger("swipeDown",{distance:c,duration:l,velocity:s,event:t}))),u.inDrag=!1):u.inTapAndHold&&(clearTimeout(u.timerTapAndHold),u.$element.trigger("tapAndHoldEnd",{x:u.x,y:u.y,event:t}),u.inTapAndHold=!1)},e.fn.touch=function(t){var n=e(this);if(this.length>1)for(var a=0;a<this.length;a++)e.touch(e(this[a]),t);else 1==this.length&&e.touch(n,t);return n},e.fn.enableTouch=function(t){return e(this).touch(t)},e.touch=function(t,o){var i={};i=e.extend(i,s),i=e.extend(i,o),"function"!=typeof i.preventDefault.drag&&(i.preventDefault.drag=i.preventDefault.drag===!0?function(e){return!0}:function(e){return!1}),"function"!=typeof i.preventDefault.swipe&&(i.preventDefault.swipe=i.preventDefault.swipe===!0?function(e){return!0}:function(e){return!1}),"function"!=typeof i.preventDefault.tap&&(i.preventDefault.tap=i.preventDefault.tap===!0?function(e){return!0}:function(e){return!1}),i.noClick&&t.on("click",function(e){e.preventDefault()});var l=function(a){var r=e(this),o=n(r,t,i);o.started=!0,o.doStart(a,a.originalEvent.touches[0].pageX,a.originalEvent.touches[0].pageY),setTimeout(function(){o.started=!1},1e3)};t.on("touchstart",l),i.delegateSelector&&t.on("touchstart",i.delegateSelector,l);var u=function(a){var r=e(this),o=n(r,t,i);o.doMove(a,a.originalEvent.touches[0].pageX,a.originalEvent.touches[0].pageY)};t.on("touchmove",u),i.delegateSelector&&t.on("touchmove",i.delegateSelector,u);var p=function(r){var o=e(this),s=n(o,t,i);s.ended=!0;var l=a(s,r.originalEvent.changedTouches[0].pageX,r.originalEvent.changedTouches[0].pageY);s.doEnd(r,l.x,l.y),setTimeout(function(){s.ended=!1},1e3)};if(t.on("touchend",p),i.delegateSelector&&t.on("touchend",i.delegateSelector,p),i.useMouse){var d=function(a){var r=e(this),o=n(r,t,i);return!o.started&&(o.mouseDown=!0,void o.doStart(a,a.pageX,a.pageY))};t.on("mousedown",d),i.delegateSelector&&t.on("mousedown",i.delegateSelector,d);var c=function(a){var r=e(this),o=n(r,t,i);o.mouseDown&&o.doMove(a,a.pageX,a.pageY)};t.on("mousemove",c),i.delegateSelector&&t.on("mousemove",i.delegateSelector,c);var g=function(a){var o=e(this),s=n(o,t,i);return!s.ended&&(r.triggerHandler("mouseup",a),s.doEnd(a,a.pageX,a.pageY),void(s.mouseDown=!1))};t.on("mouseup",g),i.delegateSelector&&t.on("mouseup",i.delegateSelector,g)}i.trackDocument||t.on("mouseleave",function(a){var r=e(this),o=n(r,t,i);o.doEnd(a,a.pageX,a.pageY),o.mouseDown=!1})},r.on("mousemove",function(e){var t=o;if(t&&t.settings.useMouse&&t.mouseDown&&t.settings.trackDocument){var n=e.pageX,r=e.pageY;if(t.settings.trackDocumentNormalize){var i=a(t,n,r);n=i.x,r=i.y}t.doMove(e,n,r)}}).on("mouseup",function(e,t){var n=o;if(n&&n.settings.useMouse&&n.settings.trackDocument){if("undefined"!=typeof t&&(e=t),!("pageX"in e))return;var r=e.pageX,i=e.pageY;if(n.settings.trackDocumentNormalize){var s=a(n,r,i);r=s.x,i=s.y}n.doEnd(e,r,i),n.mouseDown=!1}})}(jQuery);
