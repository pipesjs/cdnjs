!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).parser=e()}}(function(){return function e(t,n,r){function i(a,f){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!f&&l)return l(a,!0);if(o)return o(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var g=n[a]={exports:{}};t[a][0].call(g.exports,function(e){var n=t[a][1][e];return i(n||e)},g,g.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){var r=function(e){this.name="InvalidXmlException",this.message=e,this.stack=(new Error).stack};(r.prototype=Object.create(Error.prototype)).constructor=r,t.exports=r},{}],2:[function(e,t,n){function r(e){for(var t=f(e,c),n="",r=0;r<t.length;r++)n+=t[r][1];return n}function i(e,t){if(t){var n=e.split(":"),r="/"===e.charAt(0)?"/":"";2===n.length&&(e=r+n[1])}return e}function o(e,t){return e=e?!t||isNaN(e)?""+e:-1!==e.indexOf(".")?Number.parseFloat(e):Number.parseInt(e,10):""}function a(e,t,n,r){if(e=e||e.trim(),!t&&e.length>3){for(var o=f(e,v),a={},l=0;l<o.length;l++)a[n+i(o[l][1],r)]=o[l][3];return a}}var f=e("./util").getAllMatches,l=function(e,t,n){this.tagname=e,this.parent=t,this.child=[],this.val=n,this.addChild=function(e){this.child.push(e)}},s=new RegExp("<(\\/?[\\w:-]+)([^>]*)>(<!\\[CDATA\\[([^\\]\\]]*)\\]\\]>)*([^<]+)?","g"),g={attrPrefix:"@_",textNodeName:"#text",ignoreNonTextNodeAttr:!0,ignoreTextNodeAttr:!0,ignoreNameSpace:!1,ignoreRootElement:!1,textNodeConversion:!0},u=function(e){e||(e={});for(var t=["attrPrefix","ignoreNonTextNodeAttr","ignoreTextNodeAttr","ignoreNameSpace","ignoreRootElement","textNodeName","textNodeConversion"],n=0;n<t.length;n++)void 0===e[t[n]]&&(e[t[n]]=g[t[n]]);return e},h=function(e,t){t=u(t);for(var n=f(e,s),g=new l("!xml"),h=g,d=0;d<n.length;d++){var c,v=i(n[d][1],t.ignoreNameSpace),p=d+1<n.length?i(n[d+1][1],t.ignoreNameSpace):void 0,x=n[d][2],w=void 0===n[d][4]?n[d][5]:r(n[d][0]);if(0!==v.indexOf("/")){var m="/"===x.charAt(x.length-1),N=new l(v,h);if(m)c=a(x,t.ignoreTextNodeAttr,t.attrPrefix,t.ignoreNameSpace),N.val=c||"",h.addChild(N);else if("/"+v===p)c=a(x,t.ignoreTextNodeAttr,t.attrPrefix,t.ignoreNameSpace),w=o(w,t.textNodeConversion),c?(c[t.textNodeName]=w,N.val=c):N.val=w||"",h.addChild(N),d++;else{if(c=a(x,t.ignoreNonTextNodeAttr,t.attrPrefix,t.ignoreNameSpace))for(var A in c)c.hasOwnProperty(A)&&N.addChild(new l(A,N,c[A]));h.addChild(N),h=N}}else h=h.parent}return g},d=function(e,t){return p(h(e,t))},c=new RegExp("<!\\[CDATA\\[([^\\]\\]]*)\\]\\]>","g"),v=new RegExp("(\\S+)=(.)([^=>]*)\\2","g"),p=function(e){var t={};if(e.val||""===e.val)return e.val;for(var n=0;n<e.child.length;n++){var r=e.child[n].tagname,i=p(e.child[n]);if(void 0!==t[r]){if(!Array.isArray(t[r])){var o=t[r];t[r]=[],t[r].push(o)}t[r].push(i)}else t[r]=i}return t};n.parse=d,n.getTraversalObj=h,n.convertToJson=p,n.validate=e("./validator").validate},{"./util":3,"./validator":4}],3:[function(e,t,n){var r=function(e,t){for(var n=[],r=t.exec(e);r;){for(var i=[],o=0;o<r.length;o++)i.push(r[o]);n.push(i),r=t.exec(e)}return n};n.getAllMatches=r},{}],4:[function(e,t,n){function r(e,t,n){for(var r=t;r<e.length&&("-"!==e[r]||"-"!==e[r+1]||">"!==e[r+2]);r++);if("\x3c!--"===e.substr(t,4)&&"--\x3e"===e.substr(r,3))return e.substring(t,r);throw new u("Invalid comment tag at "+n+":"+t)}function i(e,t,n){for(var r=t;r<e.length;r++)if("<"===e[r]&&"/"===e[r+1]){r--;break}if("<![CDATA["===e.substr(t,9)&&"]]>"===e.substr(r-2,3))return e.substring(t,r);throw new u("Invalid CDATA tag at "+n+":"+t)}function o(e,t,n){e=e.replace(/\s/g," ");for(var r=t;r<e.length&&" "!==e[r]&&">"!==e[r];r++);if(">"!==e[r-1])for(var i=r;i<e.length&&">"!==e[i];i++)if(" "!==e[i])throw new u("Invalid closing tag at "+n+":"+t);return e.substring(t,r)}function a(e,t,n){for(var r=t;r<e.length&&">"!==e[r];r++);if(">"===e[r]){var i=e.substring(t,r);if(i.length>4){var o=f([],i,d,t,n);o=f(o,i,c,t,n);var a=g(i,v);for(r=0;r<a.length;r++)if(!o[a[r][1].trim()])throw new u("Invalid arguments at "+n+":"+t)}return i}throw new u("Not closing tag at "+n+":"+t)}function f(e,t,n,r,i){for(var o=g(t,n),a=0;a<o.length;a++){var f=o[a][1];if(e[f])throw new u("Argument "+f+" is redefined at "+i+":"+r);e[f]=!0}return e}function l(e,t){for(var n=t;n<e.length&&(" "!==e[n]&&">"!==e[n]&&("/"!==e[n]||">"!==e[n+1]));n++);return e.substring(t,n)}function s(e,t){for(var n=t;n<e.length&&"<"!==e[n];n++);return e.substring(t,n)}var g=e("./util").getAllMatches,u=e("./InvalidXmlException"),h=function(e){e=e.replace(/[ \t]/g," ");for(var t=[],n="",f=1,g=0;g<e.length;g++)if("\n"===e[g])f++;else if("<"===e[g]){if(" "===e[g+1])throw new u("Invalid tag at "+f+":"+g);if("!"===e[g+1]){var h="";if("-"===e[g+2])h=r(e,g,f);else{if("["!==e[g+2])throw new u("Invalid tag at "+f+":"+g);h=i(e,g,f)}g+=h.length-1}else if("/"===e[g+1]){if(g+=2,n=o(e,g,f),t[t.length-1]!==n)throw new u("closing tag is not matching at "+f+":"+g);t.pop(),g+=n.length}else{n=l(e,++g);var d=a(e,g+=n.length,f);!d||"/"!==d[d.length-1]&&"?"!==d[d.length-1]?t.push(n):g+=d.length;var c=s(e,++g);g+=c.length-1}}if(0===t.length)return!0;throw new u("closing tag is missing for "+t)},d=new RegExp('(?:[\\s]+([\\w:-]+)[\\s]*=[\\s]*"([^"]*)")',"g"),c=new RegExp("(?:[\\s]+([\\w:-]+)[\\s]*=[\\s]*'([^']*)')","g"),v=new RegExp("([\\w: -]+)[\\s]*=","g");n.validate=h},{"./InvalidXmlException":1,"./util":3}]},{},[2])(2)});