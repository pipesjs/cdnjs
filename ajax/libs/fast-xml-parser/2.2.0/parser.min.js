function resolveNameSpace(e,t){if(t){var r=e.split(":");2===r.length&&(e=r[1])}return e}function parseValue(e){return e=e?isNaN(e)?""+e:e.indexOf(".")!==-1?Number.parseFloat(e):Number.parseInt(e,10):""}function buildAttributesArr(e,t,r,a){if(e=e||e.trim(),!t&&e.length>3){for(var n=getAllMatches(e,attrsRegx),o={},i=0;i<n.length;i++){var l=r+resolveNameSpace(n[i][1],a);o[l]=n[i][2]}return o}}var getAllMatches=function(e,t){for(var r=[],a=t.exec(e);a;){for(var n=[],o=0;o<a.length;o++)n.push(a[o]);r.push(n),a=t.exec(e)}return r},xmlNode=function(e,t,r){this.tagname=e,this.parent=t,this.child=[],this.val=r,this.addChild=function(e){this.child.push(e)}},tagsRegx=new RegExp("<(\\/?[\\w:-]+)([^>]*)>([^<]+)?","g"),defaultOptions={attrPrefix:"@_",textNodeName:"#text",ignoreNonTextNodeAttr:!0,ignoreTextNodeAttr:!0,ignoreNameSpace:!1,ignoreRootElement:!1},buildOptions=function(e){e||(e={});for(var t=["attrPrefix","ignoreNonTextNodeAttr","ignoreTextNodeAttr","ignoreNameSpace","ignoreRootElement","textNodeName"],r=0;r<t.length;r++)void 0===e[t[r]]&&(e[t[r]]=defaultOptions[t[r]]);return e},getTraversalObj=function(e,t){t=buildOptions(t),e=e.replace(/>(\s+)/g,">");for(var r=getAllMatches(e,tagsRegx),a=new xmlNode("!xml"),n=a,o=0;o<r.length-1;o++){var i,l=resolveNameSpace(r[o][1],t.ignoreNameSpace),s=resolveNameSpace(r[o+1][1],t.ignoreNameSpace),d=r[o][2],g=r[o][3];if(0!==l.indexOf("/")){var u="/"===d.charAt(d.length-1),c=new xmlNode(l,n);if(u)i=buildAttributesArr(d,t.ignoreTextNodeAttr,t.attrPrefix,t.ignoreNameSpace),c.val=i||"",n.addChild(c);else if("/"+l===s)i=buildAttributesArr(d,t.ignoreTextNodeAttr,t.attrPrefix,t.ignoreNameSpace),g=parseValue(g),i?(i[t.textNodeName]=g,c.val=i):c.val=g||"",n.addChild(c),o++;else{if(i=buildAttributesArr(d,t.ignoreNonTextNodeAttr,t.attrPrefix,t.ignoreNameSpace))for(var p in i)i.hasOwnProperty(p)&&c.addChild(new xmlNode(p,c,i[p]));n.addChild(c),n=c}}else n=n.parent}return a},xml2json=function(e,t){return convertToJson(getTraversalObj(e,t))},attrsRegx=new RegExp("(\\S+)=.([^'\"]+)","g"),convertToJson=function(e){var t={};if(e.val||""===e.val)return e.val;for(var r=0;r<e.child.length;r++){var a=e.child[r].tagname,n=convertToJson(e.child[r]);if(void 0!==t[a]){if(!Array.isArray(t[a])){var o=t[a];t[a]=[],t[a].push(o)}t[a].push(n)}else t[a]=n}return t};"undefined"==typeof exports&&(exports=this),exports.parse=xml2json,exports.getTraversalObj=getTraversalObj,exports.convertToJson=convertToJson;
//# sourceMappingURL=parser.min.js.map