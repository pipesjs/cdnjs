!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.planout=e():t.planout=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),u=i(o),a=n(13),s=i(a),f=n(3),l=i(f),c=n(15),h=i(c),p=n(16),g=r(p),y=n(2),v=i(y),d=n(17),m=i(d);e["default"]={Namespace:g,Assignment:v["default"],Interpreter:s["default"],Experiment:u["default"],ExperimentSetup:m["default"],Ops:{Random:l["default"],Core:h["default"]}},t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(2),a=r(u),s=n(5),f=function(){function t(e){i(this,t),this.inputs=e,this._exposureLogged=!1,this._salt=null,this._inExperiment=!0,this.name=this.getDefaultExperimentName(),this._autoExposureLog=!0,this.setup(),this._assignment=new a["default"](this.getSalt()),this._assigned=!1}return o(t,[{key:"getDefaultExperimentName",value:function(){if((0,s.isObject)(this)&&this.constructor&&this!==this.window){var t=this.constructor.toString().match(/function\s*(\w+)/);if(t&&2===t.length)return t[1]}return"GenericExperiment"}},{key:"getDefaultParamNames",value:function(){var t=this.assign.toString(),e=t.split(".set(");return e.splice(0,1),(0,s.map)(e,function(t){var e=(0,s.trimTrailingWhitespace)(t.split(",")[0]);return e.substr(1,e.length-2)})}},{key:"requireAssignment",value:function(){this._assigned||this._assign()}},{key:"requireExposureLogging",value:function(t){this.shouldLogExposure(t)&&this.logExposure()}},{key:"_assign",value:function(){this.configureLogger();var t=this.assign(this._assignment,this.inputs);t||void 0===t?this._inExperiment=!0:this._inExperiment=!1,this._assigned=!0}},{key:"setup",value:function(){}},{key:"inExperiment",value:function(){return this._inExperiment}},{key:"addOverride",value:function(t,e){this._assignment.addOverride(t,e)}},{key:"setOverrides",value:function(t){this._assignment.setOverrides(t);var e=this._assignment.getOverrides(),n=this;(0,s.forEach)(Object.keys(e),function(t){void 0!==n.inputs[t]&&(n.inputs[t]=e[t])})}},{key:"getSalt",value:function(){return this._salt?this._salt:this.name}},{key:"setSalt",value:function(t){this._salt=t,this._assignment&&(this._assignment.experimentSalt=t)}},{key:"getName",value:function(){return this.name}},{key:"assign",value:function(t,e){throw"IMPLEMENT assign"}},{key:"getParamNames",value:function(){throw"IMPLEMENT getParamNames"}},{key:"shouldFetchExperimentParameter",value:function(t){var e=this.getParamNames();return e.indexOf(t)>=0}},{key:"setName",value:function(t){var e=/\s+/g;this.name=t.replace(e,"-"),this._assignment&&(this._assignment.experimentSalt=this.getSalt())}},{key:"__asBlob",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e={name:this.getName(),time:(new Date).getTime()/1e3,salt:this.getSalt(),inputs:this.inputs,params:this._assignment.getParams()};return(0,s.extend)(e,t),e}},{key:"setAutoExposureLogging",value:function(t){this._autoExposureLog=t}},{key:"getParams",value:function(){return this.requireAssignment(),this.requireExposureLogging(),this._assignment.getParams()}},{key:"get",value:function(t,e){return this.requireAssignment(),this.requireExposureLogging(t),this._assignment.get(t,e)}},{key:"toString",value:function(){return this.requireAssignment(),this.requireExposureLogging(),JSON.stringify(this.__asBlob())}},{key:"logExposure",value:function(t){this.inExperiment()&&(this._exposureLogged=!0,this.logEvent("exposure",t))}},{key:"shouldLogExposure",value:function(t){return!(void 0!==t&&!this.shouldFetchExperimentParameter(t))&&(this._autoExposureLog&&!this.previouslyLogged())}},{key:"logEvent",value:function(t,e){if(this.inExperiment()){var n;n=e?{event:t,extra_data:(0,s.shallowCopy)(e)}:{event:t},this.log(this.__asBlob(n))}}},{key:"configureLogger",value:function(){throw"IMPLEMENT configureLogger"}},{key:"log",value:function(t){throw"IMPLEMENT log"}},{key:"previouslyLogged",value:function(){throw"IMPLEMENT previouslyLogged"}}]),t}();e["default"]=f,t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(3),u=n(5),a=function(){function t(e,n){r(this,t),n||(n={}),this.experimentSalt=e,this._overrides=(0,u.shallowCopy)(n),this._data=(0,u.shallowCopy)(n),this.saltSeparator="."}return i(t,[{key:"evaluate",value:function(t){return t}},{key:"getOverrides",value:function(){return this._overrides}},{key:"addOverride",value:function(t,e){this._overrides[t]=e,this._data[t]=e}},{key:"setOverrides",value:function(t){this._overrides=(0,u.shallowCopy)(t);var e=this;(0,u.forEach)(Object.keys(this._overrides),function(t){e._data[t]=e._overrides[t]})}},{key:"set",value:function(t,e){return"_data"===t?void(this._data=e):"_overrides"===t?void(this._overrides=e):"experimentSalt"===t?void(this.experimentSalt=e):"saltSeparator"===t?void(this.saltSeparator=e):void((0,u.hasKey)(this._overrides,t)||(e instanceof o.PlanOutOpRandom?(e.args.salt||(e.args.salt=t),this._data[t]=e.execute(this)):this._data[t]=e))}},{key:"get",value:function(t){return"_data"===t?this._data:"_overrides"===t?this._overrides:"experimentSalt"===t?this.experimentSalt:"saltSeparator"===t?this.saltSeparator:this._data[t]}},{key:"getParams",value:function(){return this._data}},{key:"del",value:function(t){delete this._data[t]}},{key:"toString",value:function(){return String(this._data)}},{key:"length",value:function(){return Object.keys(this._data).length}}]),t}();e["default"]=a,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(4),f=n(6),l=r(f),c=n(5),h=function(t){function e(t){i(this,e);var n=o(this,Object.getPrototypeOf(e).call(this,t));return n.LONG_SCALE=0xfffffffffffff,n}return u(e,t),a(e,[{key:"compatHashCalculation",value:function(t){return parseInt(t.substr(0,13),16)}},{key:"compatZeroToOneCalculation",value:function(t){return this.getHash(t)/this.LONG_SCALE}},{key:"getUnit",value:function(t){var e=this.getArgMixed("unit");return(0,c.isArray)(e)||(e=[e]),t&&e.push(t),e}},{key:"getUniform",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments[2],r=this.compatZeroToOneCalculation(n);return r*(e-t)+t}},{key:"getHash",value:function(t){var e;if(this.args.full_salt)e=this.getArgString("full_salt")+".";else{var n=this.getArgString("salt");e=this.mapper.get("experimentSalt")+"."+n+this.mapper.get("saltSeparator")}var r=this.getUnit(t).map(function(t){return String(t)}).join("."),i=e+r,o=(0,l["default"])(i);return this.compatHashCalculation(o)}}]),e}(s.PlanOutOpSimple),p=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("min"),e=this.getArgNumber("max");return this.getUniform(t,e)}}]),e}(t)},g=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"compatRandomIntegerCalculation",value:function(t,e){return(this.getHash()+t)%(e-t+1)}},{key:"simpleExecute",value:function(){var t=this.getArgNumber("min"),e=this.getArgNumber("max");return this.compatRandomIntegerCalculation(t,e)}}]),e}(t)},y=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("p");if(t<0||t>1)throw"Invalid probability";return this.getUniform(0,1)<=t?1:0}}]),e}(t)},v=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgNumber("p"),e=this.getArgList("choices");if(t<0||t>1)throw"Invalid probability";if(0==e.length)return[];for(var n=[],r=0;r<e.length;r++){var i=e[r];this.getUniform(0,1,i)<=t&&n.push(i)}return n}}]),e}(t)},d=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"compatRandomIndexCalculation",value:function(t){return this.getHash()%t.length}},{key:"simpleExecute",value:function(){var t=this.getArgList("choices");if(0===t.length)return[];var e=this.compatRandomIndexCalculation(t);return t[e]}}]),e}(t)},m=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"simpleExecute",value:function(){var t=this.getArgList("choices"),e=this.getArgList("weights");if(0===t.length)return[];var n=0,r=e.map(function(t){return n+=t}),i=this.getUniform(0,n);return(0,c.reduce)(r,function(e,n,r){return e?e:i<=n?t[r]:e},null)}}]),e}(t)},E=function(t){return function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),a(e,[{key:"compatSampleIndexCalculation",value:function(t){return this.getHash(t)%(t+1)}},{key:"compatAllowSampleStoppingPoint",value:function(){return!0}},{key:"sample",value:function(t,e){for(var n=t.length,r=n-e,i=this.compatAllowSampleStoppingPoint(),o=n-1;o>0;o--){var u=this.compatSampleIndexCalculation(o),a=t[o];if(t[o]=t[u],t[u]=a,i&&r===o)return t.slice(o,n)}return t.slice(0,e)}},{key:"simpleExecute",value:function(){var t=(0,c.shallowCopy)(this.getArgList("choices")),e=0;return e=void 0!==this.args.draws?this.getArgNumber("draws"):t.length,this.sample(t,e)}}]),e}(t)};e["default"]={PlanOutOpRandom:h,SampleBuilder:E,Sample:E(h),WeightedChoiceBuilder:m,WeightedChoice:m(h),UniformChoiceBuilder:d,UniformChoice:d(h),BernoulliFilterBuilder:v,BernoulliFilter:v(h),BernoulliTrialBuilder:y,BernoulliTrial:y(h),RandomIntegerBuilder:g,RandomInteger:g(h),RandomFloatBuilder:p,RandomFloat:p(h)},t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.PlanOutOpUnary=e.PlanOutOpBinary=e.PlanOutOpCommutative=e.PlanOutOpSimple=e.PlanOutOp=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(5),s=function(){function t(e){o(this,t),this.args=e}return u(t,[{key:"execute",value:function(t){throw"Implement the execute function"}},{key:"dumpArgs",value:function(){console.log(this.args)}},{key:"getArgMixed",value:function(t){if(void 0===this.args[t])throw"Missing argument "+t;return this.args[t]}},{key:"getArgNumber",value:function(t){var e=this.getArgMixed(t);if("number"!=typeof e)throw t+" is not a number.";return e}},{key:"getArgString",value:function(t){var e=this.getArgMixed(t);if("string"!=typeof e)throw t+" is not a string.";return e}},{key:"getArgList",value:function(t){var e=this.getArgMixed(t);if("[object Array]"!==Object.prototype.toString.call(e))throw t+" is not a list";return e}},{key:"getArgObject",value:function(t){var e=this.getArgMixed(t);if("[object Object]"!==Object.prototype.toString.call(e))throw t+" is not an object.";return e}},{key:"getArgIndexish",value:function(t){var e=this.getArgMixed(t),n=Object.prototype.toString.call(e);if("[object Object]"!==n&&"[object Array]"!==n)throw t+" is not an list or object.";return e}}]),t}(),f=function(t){function e(){return o(this,e),r(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),u(e,[{key:"execute",value:function(t){this.mapper=t;var e=this;return(0,a.forEach)(Object.keys(this.args),function(n){e.args[n]=t.evaluate(e.args[n])}),this.simpleExecute()}}]),e}(s),l=function(t){function e(){return o(this,e),r(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){return this.unaryExecute(this.getArgMixed("value"))}},{key:"getUnaryString",value:function(){return this.args.op}},{key:"unaryExecute",value:function(t){throw"implement unaryExecute"}}]),e}(f),c=function(t){function e(){return o(this,e),r(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){var t=this.getArgMixed("left"),e=this.getArgMixed("right");return this.binaryExecute(t,e)}},{key:"getInfixString",value:function(){return this.args.op}},{key:"binaryExecute",value:function(t,e){throw"implement binaryExecute"}}]),e}(f),h=function(t){function e(){return o(this,e),r(this,Object.getPrototypeOf(e).apply(this,arguments))}return i(e,t),u(e,[{key:"simpleExecute",value:function(){return this.commutativeExecute(this.getArgList("values"))}},{key:"getCommutativeString",value:function(){return this.args.op}},{key:"commutativeExecute",value:function(t){throw"implement commutativeExecute"}}]),e}(f);e.PlanOutOp=s,e.PlanOutOpSimple=f,e.PlanOutOpCommutative=h,e.PlanOutOpBinary=c,e.PlanOutOpUnary=l},function(t,e){"use strict";function n(t,e){var n=L.length,r=t.constructor,i=f(r)&&r.prototype||Object.Prototype,o="constructor";for(S(t,o)&&!j(e,o)&&e.push(o);n--;)o=L[n],o in t&&t[o]!==i[o]&&!j(e,o)&&e.push(o)}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i=function(t){return t.replace(/^\s+|\s+$/g,"")},o=function(t){var e,n="undefined"!=typeof location,r="undefined"!=typeof window;if(n){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=i.exec(location.search);e=null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}else e="";return null!==e&&void 0!==e&&0!==e.length||!r||void 0===window.localStorage||null===window.localStorage?e:window.localStorage.getItem(t)},u=function M(t){var e=t;if(t&&"object"===("undefined"==typeof t?"undefined":r(t))){e="[object Array]"===Object.prototype.toString.call(t)?[]:{};for(var n in t)e[n]=M(t[n])}return e},a=function(t){var e="undefined"==typeof t?"undefined":r(t);return"function"===e||"object"===e&&!!t},s=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},f=function(t){return"function"==typeof t||!1},l=function U(t){if(!a(t))return[];if(Object.keys)return Object.keys(t);var U=[];for(var e in t)S(t,e)&&U.push(e);return I&&n(t,U),U},c=function(t){if(!a(t))return[];var e=[];for(var r in t)e.push(r);return I&&n(t,e),e},h=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],u=t(o),a=u.length,s=0;s<a;s++){var f=u[s];e&&void 0!==n[f]||(n[f]=o[f])}return n}},p=h(c),g=h(l),y=function(t){return t},v=function(t,e){var n=n(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var u=n[o];if(e[u]!==i[u]||!(u in i))return!1}return!0},d=function(t){return t=g({},t),function(e){return v(e,t)}},m=function(t,e,n){return null==t?y:f(t)?E(t,e,n):a(t)?d(t):_(t)},E=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},O=function(t,e,n){e=E(e,n);var r,i;if(k(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=l(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},b=function(t,e,n){e=m(e,n);for(var r=!k(t)&&l(t),i=(r||t).length,o=Array(i),u=0;u<i;u++){var a=r?r[u]:u;o[u]=e(t[a],a,t)}return o},w=function(t,e,n,r){e=E(e,r,4);var i=!k(t)&&l(t),o=(i||t).length,u=0;for(arguments.length<3&&(n=t[i?i[u]:u],u+=1);u>=0&&u<o;u++){var a=i?i[u]:u;n=e(n,t[a],a,t)}return n},x=function(t){return a(t)?s(t)?t.slice():p({},t):t},_=function(t){return function(e){return null==e?void 0:e[t]}},P=Math.pow(2,53)-1,A=_("length"),k=function(t){var e=A(t);return"number"==typeof e&&e>=0&&e<=P},S=function(t,e){return null!=t&&Object.prototype.hasOwnProperty.call(t,e)},I=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],j=function(t,e,n,r){return k(t)||(t=B(t)),("number"!=typeof n||r)&&(n=0),t.indexOf(e)>=0},B=function(t){for(var e=l(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},T=function(t){for(var e=[],n=0;n<t;n++)e.push(n);return e},R=function(t,e){return"undefined"!=typeof t[e]};e["default"]={deepCopy:u,map:b,reduce:w,getParameterByName:o,forEach:O,isFunction:f,trimTrailingWhitespace:i,hasKey:R,shallowCopy:x,extend:p,isObject:a,isArray:s,range:T},t.exports=e["default"]},function(t,e,n){(function(e){!function(){var r=n(11),i=n(12).utf8,o=n(12).bin,u=function(t){t.constructor==String?t=i.stringToBytes(t):"undefined"!=typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());var n=r.bytesToWords(t),o=8*t.length,u=[],a=1732584193,s=-271733879,f=-1732584194,l=271733878,c=-1009589776;n[o>>5]|=128<<24-o%32,n[(o+64>>>9<<4)+15]=o;for(var h=0;h<n.length;h+=16){for(var p=a,g=s,y=f,v=l,d=c,m=0;m<80;m++){if(m<16)u[m]=n[h+m];else{var E=u[m-3]^u[m-8]^u[m-14]^u[m-16];u[m]=E<<1|E>>>31}var O=(a<<5|a>>>27)+c+(u[m]>>>0)+(m<20?(s&f|~s&l)+1518500249:m<40?(s^f^l)+1859775393:m<60?(s&f|s&l|f&l)-1894007588:(s^f^l)-899497514);c=l,l=f,f=s<<30|s>>>2,s=a,a=O}a+=p,s+=g,f+=y,l+=v,c+=d}return[a,s,f,l,c]},a=function(t,e){var n=r.wordsToBytes(u(t));return e&&e.asBytes?n:e&&e.asString?o.bytesToString(n):r.bytesToHex(n)};a._blocksize=16,a._digestsize=20,t.exports=a}()}).call(e,n(7).Buffer)},function(t,e,n){(function(t,r){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function i(){function t(){}try{var e=new Uint8Array(1);return e.foo=function(){return 42},e.constructor=t,42===e.foo()&&e.constructor===t&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(n){return!1}}function o(){return t.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function t(e){return this instanceof t?(t.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof e?u(this,e):"string"==typeof e?a(this,e,arguments.length>1?arguments[1]:"utf8"):s(this,e)):arguments.length>1?new t(e,arguments[1]):new t(e)}function u(e,n){if(e=y(e,n<0?0:0|v(n)),!t.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;r++)e[r]=0;return e}function a(t,e,n){"string"==typeof n&&""!==n||(n="utf8");var r=0|m(e,n);return t=y(t,r),t.write(e,n),t}function s(e,n){if(t.isBuffer(n))return f(e,n);if(X(n))return l(e,n);if(null==n)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(n.buffer instanceof ArrayBuffer)return c(e,n);if(n instanceof ArrayBuffer)return h(e,n)}return n.length?p(e,n):g(e,n)}function f(t,e){var n=0|v(e.length);return t=y(t,n),e.copy(t,0,0,n),t}function l(t,e){var n=0|v(e.length);t=y(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function c(t,e){var n=0|v(e.length);t=y(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(e,n){return t.TYPED_ARRAY_SUPPORT?(n.byteLength,e=t._augment(new Uint8Array(n))):e=c(e,new Uint8Array(n)),e}function p(t,e){var n=0|v(e.length);t=y(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function g(t,e){var n,r=0;"Buffer"===e.type&&X(e.data)&&(n=e.data,r=0|v(n.length)),t=y(t,r);for(var i=0;i<r;i+=1)t[i]=255&n[i];return t}function y(e,n){t.TYPED_ARRAY_SUPPORT?(e=t._augment(new Uint8Array(n)),e.__proto__=t.prototype):(e.length=n,e._isBuffer=!0);var r=0!==n&&n<=t.poolSize>>>1;return r&&(e.parent=Q),e}function v(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(e,n){if(!(this instanceof d))return new d(e,n);var r=new t(e,n);return delete r.parent,r}function m(t,e){"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(r)return G(t).length;e=(""+e).toLowerCase(),r=!0}}function E(t,e,n){var r=!1;if(e=0|e,n=void 0===n||n===1/0?this.length:0|n,t||(t="utf8"),e<0&&(e=0),n>this.length&&(n=this.length),n<=e)return"";for(;;)switch(t){case"hex":return j(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return I(this,e,n);case"binary":return L(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function O(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var u=0;u<r;u++){var a=parseInt(e.substr(2*u,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+u]=a}return u}function b(t,e,n,r){return K(G(e,t.length-n),t,n,r)}function w(t,e,n,r){return K(H(e),t,n,r)}function x(t,e,n,r){return w(t,e,n,r)}function _(t,e,n,r){return K(W(e),t,n,r)}function P(t,e,n,r){return K(z(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?J.fromByteArray(t):J.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o=t[i],u=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=n){var s,f,l,c;switch(a){case 1:o<128&&(u=o);break;case 2:s=t[i+1],128===(192&s)&&(c=(31&o)<<6|63&s,c>127&&(u=c));break;case 3:s=t[i+1],f=t[i+2],128===(192&s)&&128===(192&f)&&(c=(15&o)<<12|(63&s)<<6|63&f,c>2047&&(c<55296||c>57343)&&(u=c));break;case 4:s=t[i+1],f=t[i+2],l=t[i+3],128===(192&s)&&128===(192&f)&&128===(192&l)&&(c=(15&o)<<18|(63&s)<<12|(63&f)<<6|63&l,c>65535&&c<1114112&&(u=c))}}null===u?(u=65533,a=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=a}return S(r)}function S(t){var e=t.length;if(e<=V)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=V));return n}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;i++)r+=String.fromCharCode(127&t[i]);return r}function L(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;i++)r+=String.fromCharCode(t[i]);return r}function j(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;o++)i+=F(t[o]);return i}function B(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function T(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,n,r,i,o,u){if(!t.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(n>o||n<u)throw new RangeError("value is out of bounds");if(r+i>e.length)throw new RangeError("index out of range")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function U(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;i++)t[n+i]=e>>>8*(r?i:3-i)&255}function C(t,e,n,r,i,o){if(e>i||e<o)throw new RangeError("value is out of bounds");if(n+r>t.length)throw new RangeError("index out of range");if(n<0)throw new RangeError("index out of range")}function N(t,e,n,r,i){return i||C(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(t,e,n,r,23,4),n+4}function D(t,e,n,r,i){return i||C(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(t,e,n,r,52,8),n+8}function Y(t){if(t=q(t).replace(tt,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function G(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],u=0;u<r;u++){if(n=t.charCodeAt(u),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(u+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function z(t,e){for(var n,r,i,o=[],u=0;u<t.length&&!((e-=2)<0);u++)n=t.charCodeAt(u),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function W(t){return J.toByteArray(Y(t))}function K(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}var J=n(8),Z=n(9),X=n(10);e.Buffer=t,e.SlowBuffer=d,e.INSPECT_MAX_BYTES=50,t.poolSize=8192;var Q={};t.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:i(),t.TYPED_ARRAY_SUPPORT?(t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array):(t.prototype.length=void 0,t.prototype.parent=void 0),t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,n){if(!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(e===n)return 0;for(var r=e.length,i=n.length,o=0,u=Math.min(r,i);o<u&&e[o]===n[o];)++o;return o!==u&&(r=e[o],i=n[o]),r<i?-1:i<r?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!X(e))throw new TypeError("list argument must be an Array of Buffers.");if(0===e.length)return new t(0);var r;if(void 0===n)for(n=0,r=0;r<e.length;r++)n+=e[r].length;var i=new t(n),o=0;for(r=0;r<e.length;r++){var u=e[r];u.copy(i,o),o+=u.length}return i},t.byteLength=m,t.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):E.apply(this,arguments)},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?0:t.compare(this,e)},t.prototype.indexOf=function(e,n){function r(t,e,n){for(var r=-1,i=0;n+i<t.length;i++)if(t[n+i]===e[r===-1?0:i-r]){if(r===-1&&(r=i),i-r+1===e.length)return n+r}else r=-1;return-1}if(n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n>>=0,0===this.length)return-1;if(n>=this.length)return-1;if(n<0&&(n=Math.max(this.length+n,0)),"string"==typeof e)return 0===e.length?-1:String.prototype.indexOf.call(this,e,n);if(t.isBuffer(e))return r(this,e,n);if("number"==typeof e)return t.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,n):r(this,[e],n);throw new TypeError("val must be string, number or Buffer")},t.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},t.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},t.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0);else{var i=r;r=e,e=0|n,n=i}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");r||(r="utf8");for(var u=!1;;)switch(r){case"hex":return O(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"binary":return x(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(u)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),u=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var V=4096;t.prototype.slice=function(e,n){var r=this.length;e=~~e,n=void 0===n?r:~~n,e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),n<0?(n+=r,n<0&&(n=0)):n>r&&(n=r),n<e&&(n=e);var i;if(t.TYPED_ARRAY_SUPPORT)i=t._augment(this.subarray(e,n));else{var o=n-e;i=new t(o,(void 0));for(var u=0;u<o;u++)i[u]=this[u+e]}return i.length&&(i.parent=this.parent||this),i},t.prototype.readUIntLE=function(t,e,n){t=0|t,e=0|e,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},t.prototype.readUIntBE=function(t,e,n){t=0|t,e=0|e,n||T(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},t.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,n){t=0|t,e=0|e,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},t.prototype.readIntBE=function(t,e,n){t=0|t,e=0|e,n||T(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},t.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),Z.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),Z.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),Z.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),Z.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,n,r){t=+t,e=0|e,n=0|n,r||R(this,t,e,n,Math.pow(2,8*n),0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},t.prototype.writeUIntBE=function(t,e,n,r){t=+t,e=0|e,n=0|n,r||R(this,t,e,n,Math.pow(2,8*n),0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},t.prototype.writeUInt8=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[n]=255&e,n+1},t.prototype.writeUInt16LE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8):M(this,e,n,!0),n+2},t.prototype.writeUInt16BE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=255&e):M(this,e,n,!1),n+2},t.prototype.writeUInt32LE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=255&e):U(this,e,n,!0),n+4},t.prototype.writeUInt32BE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e):U(this,e,n,!1),n+4},t.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e=0|e,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var o=0,u=1,a=t<0?1:0;for(this[e]=255&t;++o<n&&(u*=256);)this[e+o]=(t/u>>0)-a&255;return e+n},t.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e=0|e,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var o=n-1,u=1,a=t<0?1:0;for(this[e+o]=255&t;--o>=0&&(u*=256);)this[e+o]=(t/u>>0)-a&255;return e+n},t.prototype.writeInt8=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[n]=255&e,n+1},t.prototype.writeInt16LE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8):M(this,e,n,!0),n+2},t.prototype.writeInt16BE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=255&e):M(this,e,n,!1),n+2},t.prototype.writeInt32LE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24):U(this,e,n,!0),n+4},t.prototype.writeInt32BE=function(e,n,r){return e=+e,n=0|n,r||R(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e):U(this,e,n,!1),n+4},t.prototype.writeFloatLE=function(t,e,n){return N(this,t,e,!0,n)},t.prototype.writeFloatBE=function(t,e,n){return N(this,t,e,!1,n)},t.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},t.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},t.prototype.copy=function(e,n,r,i){if(r||(r=0),i||0===i||(i=this.length),n>=e.length&&(n=e.length),n||(n=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-n<i-r&&(i=e.length-n+r);var o,u=i-r;if(this===e&&r<n&&n<i)for(o=u-1;o>=0;o--)e[o+n]=this[o+r];else if(u<1e3||!t.TYPED_ARRAY_SUPPORT)for(o=0;o<u;o++)e[o+n]=this[o+r];else e._set(this.subarray(r,r+u),n);return u},t.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),n<e)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(n<0||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof t)for(r=e;r<n;r++)this[r]=t;else{var i=G(t.toString()),o=i.length;for(r=e;r<n;r++)this[r]=i[r%o]}return this}},t.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(t.TYPED_ARRAY_SUPPORT)return new t(this).buffer;for(var e=new Uint8Array(this.length),n=0,r=e.length;n<r;n+=1)e[n]=this[n];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=t.prototype;t._augment=function(e){return e.constructor=t,e._isBuffer=!0,e._set=e.set,e.get=$.get,e.set=$.set,e.write=$.write,e.toString=$.toString,e.toLocaleString=$.toString,e.toJSON=$.toJSON,e.equals=$.equals,e.compare=$.compare,e.indexOf=$.indexOf,e.copy=$.copy,e.slice=$.slice,e.readUIntLE=$.readUIntLE,e.readUIntBE=$.readUIntBE,e.readUInt8=$.readUInt8,e.readUInt16LE=$.readUInt16LE,e.readUInt16BE=$.readUInt16BE,e.readUInt32LE=$.readUInt32LE,e.readUInt32BE=$.readUInt32BE,e.readIntLE=$.readIntLE,e.readIntBE=$.readIntBE,e.readInt8=$.readInt8,e.readInt16LE=$.readInt16LE,e.readInt16BE=$.readInt16BE,e.readInt32LE=$.readInt32LE,e.readInt32BE=$.readInt32BE,e.readFloatLE=$.readFloatLE,e.readFloatBE=$.readFloatBE,e.readDoubleLE=$.readDoubleLE,e.readDoubleBE=$.readDoubleBE,e.writeUInt8=$.writeUInt8,e.writeUIntLE=$.writeUIntLE,e.writeUIntBE=$.writeUIntBE,e.writeUInt16LE=$.writeUInt16LE,e.writeUInt16BE=$.writeUInt16BE,e.writeUInt32LE=$.writeUInt32LE,e.writeUInt32BE=$.writeUInt32BE,e.writeIntLE=$.writeIntLE,e.writeIntBE=$.writeIntBE,e.writeInt8=$.writeInt8,e.writeInt16LE=$.writeInt16LE,e.writeInt16BE=$.writeInt16BE,e.writeInt32LE=$.writeInt32LE,e.writeInt32BE=$.writeInt32BE,e.writeFloatLE=$.writeFloatLE,e.writeFloatBE=$.writeFloatBE,e.writeDoubleLE=$.writeDoubleLE,e.writeDoubleBE=$.writeDoubleBE,e.fill=$.fill,e.inspect=$.inspect,e.toArrayBuffer=$.toArrayBuffer,e};var tt=/[^+\/0-9A-Za-z-_]/g}).call(e,n(7).Buffer,function(){return this}())},function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===u||e===c?62:e===a||e===h?63:e<s?-1:e<s+10?e-s+26+26:e<l+26?e-l:e<f+26?e-f+26:void 0}function n(t){function n(t){f[c++]=t}var r,i,u,a,s,f;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;s="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,f=new o(3*t.length/4-s),u=s>0?t.length-4:t.length;var c=0;for(r=0,i=0;r<u;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===s?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===s&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(a>>8&255),n(255&a)),f}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,u,a=t.length%3,s="";for(i=0,u=t.length-a;i<u;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],s+=n(o);switch(a){case 1:o=t[t.length-1],s+=e(o>>2),s+=e(o<<4&63),s+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],s+=e(o>>10),s+=e(o>>4&63),s+=e(o<<2&63),s+="="}return s}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,u="+".charCodeAt(0),a="/".charCodeAt(0),s="0".charCodeAt(0),f="a".charCodeAt(0),l="A".charCodeAt(0),c="-".charCodeAt(0),h="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}(e)},function(t,e){e.read=function(t,e,n,r,i){var o,u,a=8*i-r-1,s=(1<<a)-1,f=s>>1,l=-7,c=n?i-1:0,h=n?-1:1,p=t[e+c];for(c+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+c],c+=h,l-=8);for(u=o&(1<<-l)-1,o>>=-l,l+=r;l>0;u=256*u+t[e+c],c+=h,l-=8);if(0===o)o=1-f;else{if(o===s)return u?NaN:(p?-1:1)*(1/0);u+=Math.pow(2,r),o-=f}return(p?-1:1)*u*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var u,a,s,f=8*o-i-1,l=(1<<f)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,g=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,u=l):(u=Math.floor(Math.log(e)/Math.LN2),e*(s=Math.pow(2,-u))<1&&(u--,s*=2),e+=u+c>=1?h/s:h*Math.pow(2,1-c),e*s>=2&&(u++,s/=2),u+c>=l?(a=0,u=l):u+c>=1?(a=(e*s-1)*Math.pow(2,i),u+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),u=0));i>=8;t[n+p]=255&a,p+=g,a/=256,i-=8);for(u=u<<i|a,f+=i;f>0;t[n+p]=255&u,p+=g,u/=256,f-=8);t[n+p-g]|=128*y}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var n=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?n.push(e.charAt(i>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&n.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(r))>>>6-2*i);return n}};t.exports=n}()},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(2),a=r(u),s=n(14),f=n(5),l=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?"global_salt":arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=arguments[3];i(this,t),this._serialization=e,o?this._env=o:this._env=new a["default"](n),this.experimentSalt=this._experimentSalt=n,this._evaluated=!1,this._inExperiment=!1,this._inputs=(0,f.shallowCopy)(r)}return o(t,[{key:"inExperiment",value:function(){return this._inExperiment}},{key:"setEnv",value:function(t){return this._env=(0,f.deepCopy)(t),this}},{key:"has",value:function(t){return this._env[t]}},{key:"get",value:function(t,e){var n=this._inputs[t];null!==n&&void 0!==n||(n=e);var r=this._env.get(t);return void 0!==r&&null!==r?r:n}},{key:"getParams",value:function(){if(!this._evaluated){try{this.evaluate(this._serialization)}catch(t){t instanceof s.StopPlanOutException&&(this._inExperiment=t.inExperiment)}this._evaluated=!0}return this._env.getParams()}},{key:"set",value:function(t,e){return this._env.set(t,e),this}},{key:"getSaltSeparator",value:function(){return this._env.saltSeparator}},{key:"setOverrides",value:function(t){return this._env.setOverrides(t),this}},{key:"getOverrides",value:function(){return this._env.getOverrides()}},{key:"hasOverride",value:function(t){var e=this.getOverrides();return e&&void 0!==e[t]}},{key:"registerCustomOperators",value:function(t){(0,s.registerOperators)(t)}},{key:"evaluate",value:function(t){if((0,f.isObject)(t)&&t.op)return(0,s.operatorInstance)(t).execute(this);if((0,f.isArray)(t)){var e=this;return(0,f.map)(t,function(t){return e.evaluate(t)})}return t}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.registerOperators=e.StopPlanOutException=e.operatorInstance=e.isOperator=e.initFactory=e.operators=void 0;var o=n(15),u=r(o),a=n(3),s=r(a),f=n(5),l=function(){return{literal:u.Literal,get:u.Get,set:u.Set,seq:u.Seq,"return":u.Return,index:u.Index,array:u.Arr,equals:u.Equals,and:u.And,or:u.Or,">":u.GreaterThan,"<":u.LessThan,">=":u.GreaterThanOrEqualTo,"<=":u.LessThanOrEqualTo,"%":u.Mod,"/":u.Divide,not:u.Not,round:u.Round,negative:u.Negative,min:u.Min,max:u.Max,length:u.Length,coalesce:u.Coalesce,map:u.Map,cond:u.Cond,product:u.Product,sum:u.Sum,randomFloat:s.RandomFloat,randomInteger:s.RandomInteger,bernoulliTrial:s.BernoulliTrial,bernoulliFilter:s.BernoulliFilter,uniformChoice:s.UniformChoice,weightedChoice:s.WeightedChoice,sample:s.Sample}},c=l(),h=function(t){return(0,f.isObject)(t)&&t.op},p=function(t){var e=t.op;if(!c[e])throw"Unknown Operator "+e;return new c[e](t)},g=function(t){(0,f.forEach)(t,function(t,e){if(c[e])throw e+" already is defined";c[e]=t})},y=function v(t){i(this,v),this.inExperiment=t};e.operators=c,e.initFactory=l,e.isOperator=h,e.operatorInstance=p,e.StopPlanOutException=y,e.registerOperators=g},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Return=e.Length=e.Max=e.Min=e.Negative=e.Not=e.Round=e.Divide=e.Mod=e.GreaterThanOrEqualTo=e.LessThanOrEqualTo=e.LessThan=e.GreaterThan=e.Equals=e.Sum=e.Product=e.Or=e.And=e.Cond=e.Index=e.Coalesce=e.Map=e.Arr=e.Set=e.Seq=e.Get=e.Literal=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(4),s=n(14),f=n(5),l=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return this.getArgMixed("value")}}]),e}(a.PlanOutOp),c=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return t.get(this.getArgString("var"))}}]),e}(a.PlanOutOp),h=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){(0,f.forEach)(this.getArgList("seq"),function(e){t.evaluate(e)})}}]),e}(a.PlanOutOp),p=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=t.evaluate(this.getArgMixed("value")),n=!1;throw e&&(n=!0),new s.StopPlanOutException(n)}}]),e}(a.PlanOutOp),g=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=this.getArgString("var"),n=this.getArgMixed("value");t.hasOverride(e)||((0,s.isOperator)(n)&&!n.salt&&(n.salt=e),"experimentSalt"==e&&(t.experimentSalt=n),t.set(e,t.evaluate(n)))}}]),e}(a.PlanOutOp),y=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.map)(this.getArgList("values"),function(e){return t.evaluate(e)})}}]),e}(a.PlanOutOp),v=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){for(var e=this.getArgList("values"),n=0;n<e.length;n++){var r=e[n],i=t.evaluate(r);if(null!==i&&void 0!==i)return i}return null}}]),e}(a.PlanOutOp),d=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"simpleExecute",value:function(){var t=this.getArgIndexish("base"),e=this.getArgMixed("index");return"number"==typeof e?e>=0&&e<t.length?t[e]:void 0:t[e]}}]),e}(a.PlanOutOpSimple),m=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){var e=this.getArgList("cond");for(var n in e){var r=e[n]["if"],i=e[n].then;if(t.evaluate(r))return t.evaluate(i)}return null}}]),e}(a.PlanOutOp),E=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.reduce)(this.getArgList("values"),function(e,n){return e?Boolean(t.evaluate(n)):e},!0)}}]),e}(a.PlanOutOp),O=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"execute",value:function(t){return(0,f.reduce)(this.getArgList("values"),function(e,n){return e?e:Boolean(t.evaluate(n))},!1)}}]),e}(a.PlanOutOp),b=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return(0,f.reduce)(t,function(t,e){return t*e},1)}}]),e}(a.PlanOutOpCommutative),w=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return(0,f.reduce)(t,function(t,e){return t+e},0)}}]),e}(a.PlanOutOpCommutative),x=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"getInfixString",value:function(){return"=="}},{key:"binaryExecute",value:function(t,e){return t===e}}]),e}(a.PlanOutOpBinary),_=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t>e}}]),e}(a.PlanOutOpBinary),P=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t<e}}]),e}(a.PlanOutOpBinary),A=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t<=e}}]),e}(a.PlanOutOpBinary),k=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t>=e}}]),e}(a.PlanOutOpBinary),S=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments));
}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return t%e}}]),e}(a.PlanOutOpBinary),I=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"binaryExecute",value:function(t,e){return parseFloat(t)/parseFloat(e)}}]),e}(a.PlanOutOpBinary),L=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"unaryExecute",value:function(t){return Math.round(t)}}]),e}(a.PlanOutOpUnary),j=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"getUnaryString",value:function(){return"!"}},{key:"unaryExecute",value:function(t){return!t}}]),e}(a.PlanOutOpUnary),B=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"getUnaryString",value:function(){return"-"}},{key:"unaryExecute",value:function(t){return 0-t}}]),e}(a.PlanOutOpUnary),T=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return Math.min.apply(null,t)}}]),e}(a.PlanOutOpCommutative),R=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"commutativeExecute",value:function(t){return Math.max.apply(null,t)}}]),e}(a.PlanOutOpCommutative),M=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"unaryExecute",value:function(t){return t.length}}]),e}(a.PlanOutOpUnary),U=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),u(e,[{key:"simpleExecute",value:function(){var t=(0,f.deepCopy)(this.args);return delete t.op,delete t.salt,t}}]),e}(a.PlanOutOpSimple);e.Literal=l,e.Get=c,e.Seq=h,e.Set=g,e.Arr=y,e.Map=U,e.Coalesce=v,e.Index=d,e.Cond=m,e.And=E,e.Or=O,e.Product=b,e.Sum=w,e.Equals=x,e.GreaterThan=_,e.LessThan=P,e.LessThanOrEqualTo=A,e.GreaterThanOrEqualTo=k,e.Mod=S,e.Divide=I,e.Round=L,e.Not=j,e.Negative=B,e.Min=T,e.Max=R,e.Length=M,e.Return=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleNamespace=e.Namespace=void 0;var a=function E(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:E(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(1),l=r(f),c=n(2),h=r(c),p=n(3),g=n(5),y=n(17),v=function(t){function e(){return i(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),s(e,[{key:"configureLogger",value:function(){}},{key:"setup",value:function(){this.name="test_name"}},{key:"log",value:function(t){}},{key:"getParamNames",value:function(){return this.getDefaultParamNames()}},{key:"previouslyLogged",value:function(){return!0}},{key:"assign",value:function(t,e){}}]),e}(l["default"]),d=function(){function t(){i(this,t)}return s(t,[{key:"addExperiment",value:function(t,e,n){throw"IMPLEMENT addExperiment"}},{key:"removeExperiment",value:function(t){throw"IMPLEMENT removeExperiment"}},{key:"setAutoExposureLogging",value:function(t){throw"IMPLEMENT setAutoExposureLogging"}},{key:"inExperiment",value:function(){throw"IMPLEMENT inExperiment"}},{key:"get",value:function(t,e){throw"IMPLEMENT get"}},{key:"logExposure",value:function(t){throw"IMPLEMENT logExposure"}},{key:"logEvent",value:function(t,e){throw"IMPLEMENT logEvent"}},{key:"requireExperiment",value:function(){this._experiment||this._assignExperiment()}},{key:"requireDefaultExperiment",value:function(){this._defaultExperiment||this._assignDefaultExperiment()}}]),t}(),m=function(t){function e(t){i(this,e);var n=o(this,Object.getPrototypeOf(e).call(this,t));return n.name=n.getDefaultNamespaceName(),n.inputs=t||{},n.numSegments=1,n.segmentAllocations={},n.currentExperiments={},n._experiment=null,n._defaultExperiment=null,n.defaultExperimentClass=v,n._inExperiment=!1,n.setupDefaults(),n.setup(),n.availableSegments=(0,g.range)(n.numSegments),n.setupExperiments(),n}return u(e,t),s(e,[{key:"setupDefaults",value:function(){}},{key:"setup",value:function(){throw"IMPLEMENT setup"}},{key:"setupExperiments",value:function(){throw"IMPLEMENT setupExperiments"}},{key:"getPrimaryUnit",value:function(){return this._primaryUnit}},{key:"allowedOverride",value:function(){return!1}},{key:"getOverrides",value:function(){return{}}},{key:"setPrimaryUnit",value:function(t){this._primaryUnit=t}},{key:"addExperiment",value:function(t,e,n){var r=this.availableSegments.length;if(r<n)return!1;if(void 0!==this.currentExperiments[t])return!1;var i=new h["default"](this.name);i.set("sampled_segments",new p.Sample({choices:this.availableSegments,draws:n,unit:t}));for(var o=i.get("sampled_segments"),u=0;u<o.length;u++){this.segmentAllocations[o[u]]=t;var a=this.availableSegments.indexOf(o[u]);this.availableSegments[a]=this.availableSegments[r-1],this.availableSegments.splice(r-1,1),r-=1}this.currentExperiments[t]=e}},{key:"removeExperiment",value:function(t){var e=this;return void 0!==this.currentExperiments[t]&&((0,g.forEach)(Object.keys(this.segmentAllocations),function(n){e.segmentAllocations[n]===t&&(delete e.segmentAllocations[n],e.availableSegments.push(n))}),delete this.currentExperiments[t],!0)}},{key:"getSegment",value:function(){var t=new h["default"](this.name),e=new p.RandomInteger({min:0,max:this.numSegments-1,unit:this.inputs[this.getPrimaryUnit()]});return t.set("segment",e),t.get("segment")}},{key:"_assignExperiment",value:function(){this.inputs=(0,g.extend)(this.inputs,(0,y.getExperimentInputs)(this.getName()));var t=this.getSegment();if(void 0!==this.segmentAllocations[t]){var e=this.segmentAllocations[t];this._assignExperimentObject(e)}}},{key:"_assignExperimentObject",value:function(t){var e=new this.currentExperiments[t](this.inputs);e.setName(this.getName()+"-"+t),e.setSalt(this.getName()+"-"+t),this._experiment=e,this._inExperiment=e.inExperiment(),this._inExperiment||this._assignDefaultExperiment()}},{key:"_assignDefaultExperiment",value:function(){this._defaultExperiment=new this.defaultExperimentClass(this.inputs)}},{key:"defaultGet",value:function(t,n){return a(Object.getPrototypeOf(e.prototype),"requireDefaultExperiment",this).call(this),this._defaultExperiment.get(t,n)}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"previouslyLogged",value:function(){return this._experiment?this._experiment.previouslyLogged():null}},{key:"inExperiment",value:function(){return a(Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._inExperiment}},{key:"setAutoExposureLogging",value:function(t){this._autoExposureLoggingSet=t,this._defaultExperiment&&this._defaultExperiment.setAutoExposureLogging(t),this._experiment&&this._experiment.setAutoExposureLogging(t)}},{key:"setGlobalOverride",value:function(t){var e=this.getOverrides();if(e&&(0,g.hasKey)(e,t)){var n=e[t];n&&(0,g.hasKey)(this.currentExperiments,n.experimentName)&&(this._assignExperimentObject(n.experimentName),this._experiment.addOverride(t,n.value))}}},{key:"setLocalOverride",value:function(t){var e=(0,g.getParameterByName)("experimentOverride");e&&(0,g.hasKey)(this.currentExperiments,e)&&(this._assignExperimentObject(e),(0,g.getParameterByName)(t)&&this._experiment.addOverride(t,(0,g.getParameterByName)(t)))}},{key:"getParams",value:function(t){return a(Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this.getOriginalExperimentName()===t?this._experiment.getParams():null}},{key:"getOriginalExperimentName",value:function(){return this._experiment?this._experiment.getName().split("-")[1]:null}},{key:"get",value:function(t,n){return a(Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this.allowedOverride()&&this.setGlobalOverride(t),this.setLocalOverride(t),this._experiment?(void 0!==this._autoExposureLoggingSet&&this._experiment.setAutoExposureLogging(this._autoExposureLoggingSet),this._experiment.get(t,this.defaultGet(t,n))):this.defaultGet(t,n)}},{key:"logExposure",value:function(t){a(Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logExposure(t)}},{key:"logEvent",value:function(t,n){a(Object.getPrototypeOf(e.prototype),"requireExperiment",this).call(this),this._experiment&&this._experiment.logEvent(t,n)}},{key:"getDefaultNamespaceName",value:function(){if((0,g.isObject)(this)&&this.constructor&&this!==this.window){var t=this.constructor.toString().match(/function\s*(\w+)/);if(t&&2===t.length)return t[1]}return"GenericNamespace"}}]),e}(d);e.Namespace=d,e.SimpleNamespace=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i={},o={},u=function(t){return t?a((0,r.shallowCopy)(t)):{}},a=function(t){return(0,r.forEach)(Object.keys(t),function(e){(0,r.isFunction)(t[e])&&(t[e]=t[e]())}),t},s=function(t,e,n){n?(o[n]||(o[n]={}),o[n][t]=e):i[t]=e},f=function(t){var e=u(i);return t&&o[t]?(0,r.extend)(e,u(o[t])):e};e["default"]={registerExperimentInput:s,getExperimentInputs:f},t.exports=e["default"]}])});