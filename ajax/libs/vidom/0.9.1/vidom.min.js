/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.9.1
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom=t.vidom||{})}(this,function(t){"use strict";function e(t){t+="";for(var e=t.length,n=0;e-- >0;)switch(t[e]){case"&":n|=1;break;case'"':n|=2}return 1===(1&n)&&(t=t.replace(Qt,"&amp;")),2===(2&n)&&(t=t.replace(Xt,"&quot;")),t}function n(t,e){for(var n=t.length,i=0;i<n;)if(t[i++]==e)return!0;return!1}function i(t){return t.replace(Yt,"$1-$2").toLowerCase()}function o(t,e,n){if("type"===e&&"INPUT"===t.tagName){var i=t.value;t.setAttribute(e,""+n),t.value=i}else t.setAttribute(_(e),""+n)}function r(t,e,n){n?o(t,e,n):h(t,e)}function s(t,e,n){t[e]=n}function u(t,e,n){var i=t[e];for(var o in n)i[o]=null==n[o]?"":n[o]}function a(t,e,n){"value"===e&&"SELECT"===t.tagName?d(t,n):t[e]!==n&&(t[e]=n)}function h(t,e){t.removeAttribute(_(e))}function l(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?c(t):t[e]=m(t.tagName,e)}function d(t,e){var i=Array.isArray(e);if(i)for(var o=t.options,r=o.length,s=0,u=void 0;s<r;)u=o[s++],u.selected=null!=e&&n(e,u.value);else t.value=e}function c(t){for(var e=t.options,n=e.length,i=0;i<n;)e[i++].selected=!1}function f(t,n){return n===!1?"":_(t)+(n===!0?"":'="'+e(n)+'"')}function p(t,e){return e?_(t):""}function v(t,e){var n="",o=void 0;for(o in e)null!=e[o]&&(n+=i(o)+":"+e[o]+";");return n?t+'="'+n+'"':n}function m(t,e){var n=t+":"+e;if(oe.has(n))return oe.get(n);var i=void 0;ie.has(t)?i=ie.get(t):ie.set(t,i=document.createElement(t));var o=i[e];return oe.set(n,o),o}function _(t){return t in re?re[t]:re[t]=t.toLowerCase()}function g(t,e){if(Array.isArray(t))C(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],i=void 0,o=e[1];n!==o;)i=n.nextSibling,t.appendChild(n),n=i;t.appendChild(o)}else t.appendChild(e)}function y(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,i=t[1],o=i.parentNode;e!==i;)n=e.nextSibling,o.removeChild(e),e=n;o.removeChild(i)}else t.parentNode.removeChild(t)}function C(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],i=void 0,o=t[1],r=o.parentNode;n!==o;)i=n.nextSibling,r.insertBefore(n,e),n=i;r.insertBefore(o,e)}else e.parentNode.insertBefore(t,e)}function N(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var i=e.nextSibling;i?C(t,i):g(e.parentNode,t)}else C(t,e)}function A(t,e){Array.isArray(t)?(C(e,t),y(t)):t.parentNode.replaceChild(e,t)}function x(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,i=t[1],o=i.parentNode;e!==i;)n=e.nextSibling,o.removeChild(e),e=n;else t.textContent=""}function D(t,e,n){if(Array.isArray(t)){var i=t[1],o=i.previousSibling;o===t[0]?i.parentNode.insertBefore(document.createTextNode(e),i):o.nodeValue=e}else if(n){var r=t.firstChild;r?r.nodeValue=e:t.textContent=e}else t.innerHTML=e}function w(t){if(Array.isArray(t)){var e=t[0].nextSibling;e.parentNode.removeChild(e)}else t.textContent=""}function b(t){var e="on"+t;if(e in document)return!0;var n=document.createElement("div");return n.setAttribute(e,"return;"),"function"==typeof n[e]||"wheel"===t&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&document.implementation.hasFeature("Events.wheel","3.0")}function T(t,e){this.type=t,this.target=e.target,this.nativeEvent=e,this._isPropagationStopped=!1,this._isDefaultPrevented=!1,this._isPersisted=!1}function R(t,e){if(t in fe){var n=fe[t];if(!n._isPersisted)return n.target=e.target,n.nativeEvent=e,n._isPropagationStopped=!1,n._isDefaultPrevented=!1,n}return fe[t]=new T(t,e)}function k(t,e){return pe in t?t[pe]:e?null:t[pe]=ve++}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.type;if(we)for(var n=t.target,i=De.get(e),o=i.listenersCount,r=void 0,s=void 0,u=void 0,a=void 0;o&&n&&n!==document;){if((u=k(n,!0))&&(r=xe.get(u),r&&(s=r[e])&&(s(a||(a=R(e,t))),0===--o||a.isPropagationStopped())))return;n=n.parentNode}}function M(t){we&&xe.get(k(t.currentTarget))[t.type](R(t.type,t))}function E(t,e,n){if(De.has(e)){var i=De.get(e);i.set||(null!==i.setup?i.setup():i.bubbles&&document.addEventListener(e,S,!1),i.set=!0);var o=k(t),r=xe.get(o);"undefined"==typeof r&&xe.set(o,r={}),e in r||(i.bubbles?++i.listenersCount:t.addEventListener(e,M,!1)),r[e]=n}}function P(t,e){if(De.has(e)){var n=De.get(e);n.bubbles?--n.listenersCount:t.removeEventListener(e,M)}}function I(t,e){var n=k(t,!0);if(null!==n){var i=xe.get(n);"undefined"!=typeof i&&e in i&&(i[e]=null,P(t,e))}}function L(t){var e=k(t,!0);if(null!==e){var n=xe.get(e);if("undefined"!=typeof n){for(var i in n)n[i]&&P(t,i);xe.delete(e)}}}function U(){we=!1}function q(){we=!0}function O(t){return Array.isArray(t)?j(t):t.namespaceURI===be?null:t.namespaceURI}function j(t){return O((Array.isArray(t)?t[t.length-1]:t).parentNode)}function F(t,e){var n=t.getDomNode();ce.append(n,e.renderToDom(O(n))),e.mount()}function B(t,e){var n=e.getDomNode();ce.insertBefore(t.renderToDom(j(n)),n),t.mount()}function K(t){var e=t.getDomNode();t.unmount(),ce.remove(e)}function H(t,e,n){var i=document.activeElement;U(),ce.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==i&&i.focus(),q()}function V(t){for(var e=t.getDomNode(),n=t.children,i=n.length,o=0;o<i;)n[o++].unmount();ce.removeChildren(e)}function W(t,e){var n=t.getDomNode();t.unmount(),ce.replace(n,e.renderToDom(j(n))),e.mount()}function z(t,e,n){var i=t.getDomNode();Re.has(e)?E(i,Re.get(e),n):de(e).set(i,e,n)}function Z(t,e){var n=t.getDomNode();Re.has(e)?I(n,Re.get(e)):de(e).remove(n,e)}function $(t,e,n){ce.updateText(t.getDomNode(),e,n)}function G(t){ce.removeText(t.getDomNode())}function J(t,e){var n=void 0;if(null===e)Me.has(t)?n=Me.get(t):Me.set(t,n="!"===t?document.createComment(""):document.createElement(t));else{var i=e+":"+t;Me.has(i)?n=Me.get(i):Me.set(i,n=document.createElementNS(e,t))}return n.cloneNode()}function Q(t,e){var n=t.children,i=e.children,o=n.length,r=i.length;if(1===o&&1===r)return void n[0].patch(i[0]);for(var s=0,u=o-1,a=n[s],h=a.key,l=n[u],d=l.key,c=0,f=r-1,p=i[c],v=p.key,m=i[f],_=m.key,g=0,y=null,C=void 0,N=void 0,A={};s<=u&&c<=f;)s in A?g=1:u in A?g=2:h===v?(a.patch(p),g=5):d===_?(l.patch(m),g=10):null!==h&&h===_?(Se.moveChild(a,l,!0),a.patch(m),g=9):null!==d&&d===v?(Se.moveChild(l,a,!1),l.patch(p),g=6):null!==h&&null===v?(Se.insertChild(p,a),g=4):null===h&&null!==v?(Se.removeChild(a),g=1):(null===y&&(y=X(n,s,u)),v in y?(C=y[v],N=n[C],A[C]=!0,Se.moveChild(N,a,!1),N.patch(p)):Se.insertChild(p,a),g=4),1===(1&g)&&++s<=u&&(a=n[s],h=a.key),2===(2&g)&&--u>=s&&(l=n[u],d=l.key),4===(4&g)&&++c<=f&&(p=i[c],v=p.key),8===(8&g)&&--f>=c&&(m=i[f],_=m.key),g=0;for(;s<=u;)A[s]||Se.removeChild(n[s]),++s;for(;c<=f;)f<r-1?Se.insertChild(i[c],i[f+1]):Se.appendChild(e,i[c]),++c}function X(t,e,n){for(var i={},o=void 0;e<n;)o=t[e].key,null!==o&&(i[o]=e),++e;return i}function Y(){}function tt(t){return this.key=t,this}function et(t){return this._ref=t,this}function nt(){this.type=je,this.key=null,this.children=null,this._domNode=null,this._ctx=Ee}function it(t){if(null==t)return null;var e=Array.isArray(t)?t:[t];return e}function ot(t,e){var n={};for(var i in t)n[i]=t[i];for(var o in e)n[o]=e[o];return n}function rt(t){this.type=Be,this.key=null,this.attrs=Ee,this.children=null,this._component=t,this._rootNode=null,this._ctx=Ee}function st(){this.type=Oe,this.key=null,this.children=null,this._domNode=null}function ut(t){return null==t||"string"==typeof t?t:t.toString()}function at(){for(var t=0;t<He.length;)He[t++]();He=[]}function ht(t){1===He.push(t)&&Ke(at)}function lt(){this._listeners={}}function dt(t){this.type=Ue,this._childNode=t,this._ns=null}function ct(t,e,n,i,o){var r=k(t),s=Ve.get(r),u=void 0;if(s&&null!==s.tree){u=++s.id;var a=function(){if(s=Ve.get(r),s&&s.id===u){var t=s.tree,o=new dt(e);o.setNs(t._ns).setCtx(n),t.patch(o),s.tree=o,pt(i)}};o?a():ht(a)}else{if(Ve.set(r,s={tree:null,id:u=++We}),t.childNodes.length>0){var h=vt(t);if(null!==h){var l=s.tree=new dt(e);return l.setNs(O(t)).setCtx(n),l.adoptDom(h),l.mount(),void pt(i)}t.textContent=""}var d=function(){var o=Ve.get(r);if(o&&o.id===u){var s=o.tree=new dt(e);s.setNs(O(t)).setCtx(n),ce.append(t,s.renderToDom()),s.mount(),pt(i)}};o?d():ht(d)}}function ft(t,e,n){var i=k(t),o=Ve.get(i);o?!function(){var t=++o.id,r=function(){if(o=Ve.get(i),o&&o.id===t){Ve.delete(i);var n=o.tree;if(null!==n){var r=n.getDomNode();n.unmount(),ce.remove(r)}pt(e)}};o.tree?n?r():ht(r):n||pt(e)}():n||pt(e)}function pt(t){t&&t()}function vt(t){for(var e=t.childNodes,n=e.length,i=0,o=null,r=void 0;i<n;)r=e[i++],o?o.push(r):r.nodeType===Node.COMMENT_NODE&&"vidom"===r.textContent&&(o=[]);return o}function mt(t,e,n,i){"function"==typeof n&&(i=n,n=this),ct(t,e,n,i,!1)}function _t(t,e,n){ct(t,e,n,null,!0)}function gt(t,e){ft(t,e,!1)}function yt(t){ft(t,null,!0)}function Ct(){var t=[];return Ve.forEach(function(e){var n=e.tree;n&&t.push(n)}),t}function Nt(){this.__isMounted=!0,this.onMount()}function At(){this.__isMounted=!1,this.onUnmount()}function xt(t,e,n,i){if(this.isMounted()){t=this.__buildAttrs(t);var o=this.attrs,r=this.children,s=this.context;if(i){var u=this.__isUpdating;this.__isUpdating=!0,this.attrs=t,this.onAttrsReceive(o),this.children=e,this.onChildrenReceive(r),this.context=n,this.onContextReceive(s),this.__isUpdating=u}if(!this.__isUpdating){var a=this.shouldRerender(o,r,this.__prevState,s);if(a){var h=this.__rootNode;this.__rootNode=this.render(),h.patch(this.__rootNode),this.onUpdate(o,r,this.__prevState,s)}}}}function Dt(){return!0}function wt(){return null}function bt(t){return this.__rootNode.renderToDom(t)}function Tt(){return this.__rootNode.renderToString()}function Rt(t,e){return this.__rootNode.adoptDom(t,e)}function kt(){return this.__rootNode.getDomNode()}function St(){return Ee}function Mt(t){var e=void 0;null===this.__rootNode?e=t===Ee?t:ot(this.state,t):(this.update(this.state===this.__prevState?Et:null),e=ot(this.state,t)),this.state=e}function Et(){this.__prevState=this.state}function Pt(){var t=this.onRender(),e=null===t?Zt("!"):t,n=this.onChildContextRequest(),i=n===Ee?this.context:this.context===Ee?n:ot(this.context,n);return e.setCtx(i),e}function It(t){var e=this;this.__isUpdating?t&&ht(function(){return t.call(e)}):(this.__isUpdating=!0,ht(function(){if(e.isMounted()){e.__isUpdating=!1;e.__rootNode;e.patch(e.attrs,e.children,e.context,!1),t&&t.call(e)}}))}function Lt(){return this.__rootNode}function Ut(){return this.__isMounted}function qt(){return this}function Ot(t){if(t===this.attrs)return t;var e=this.constructor.defaultAttrs,n=null!=e,i=t===Ee?n?e:t:n?ot(e,t):t;return i}function jt(t,e){var n=function(t,e,n){this.attrs=this.__buildAttrs(t),this.children=e,this.state=Ee,this.context=n,this.__isMounted=!1,this.__isUpdating=!1,this.__rootNode=null,this.onInit(),this.__prevState=this.state,this.__rootNode=this.render()},i={constructor:n,onInit:Y,mount:Nt,unmount:At,onMount:Y,onUnmount:Y,onAttrsReceive:Y,onChildrenReceive:Y,onContextReceive:Y,shouldRerender:Dt,onRender:wt,onUpdate:Y,isMounted:Ut,setState:Mt,renderToDom:bt,renderToString:Tt,adoptDom:Rt,getDomNode:kt,getRootNode:Lt,render:Pt,update:It,patch:xt,onChildContextRequest:St,onRefRequest:qt,__buildAttrs:Ot};for(var o in t)i[o]=t[o];n.prototype=i;for(var r in e)n[r]=e[r];return n.__vidom__component__=!0,n}function Ft(t,e){var n=$e.get(t);n?n.push(e):$e.set(t,[e])}function Bt(t,e){for(var n=$e.get(t),i=n.length,o=0;o<i;){if(n[o]===e)return void(1===i?$e.delete(t):n.splice(o,1));o++}}function Kt(t){this.type=Fe,this.key=null,this.attrs=Ee,this.children=null,this._component=t,this._instance=null,this._ctx=Ee,this._ref=null}function Ht(t){t+="";for(var e=t.length,n=0;e-- >0;)switch(t[e]){case"&":n|=1;break;case"<":n|=2;break;case">":n|=4}return 1===(1&n)&&(t=t.replace(Xe,"&amp;")),2===(2&n)&&(t=t.replace(Ye,"&lt;")),4===(4&n)&&(t=t.replace(tn,"&gt;")),t}function Vt(t,e,n){var i=nn[e]||"div",o=on[i]||(on[i]=document.createElement(i));if(!n||!en[n]||en[n]===e)return o.innerHTML=t,o.removeChild(o.firstChild);var r=en[n];return o.innerHTML="<"+r+' xmlns="'+n+'">'+t+"</"+r+">",o.removeChild(o.firstChild).firstChild}function Wt(t){this.type=qe,this.tag=t,this.key=null,this.attrs=Ee,this.children=null,this._domNode=null,this._ns=null,this._escapeChildren=!0,this._ctx=Ee,this._ref=null}function zt(t){if(null==t)return null;var e=typeof t;if("object"===e){var n=Array.isArray(t)?t:[t];return n}return"string"===e?t:""+t}function Zt(t){switch(typeof t){case"string":switch(t){case"fragment":return new nt;case"text":return new st;case"input":return new Kt(Ze);case"textarea":return new Kt(an);case"select":return new Kt(hn);default:return new Wt(t)}case"function":return t.__vidom__component__?new Kt(t):new rt(t)}}function $t(t){return"<!--vidom-->"+t.renderToString()}function Gt(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:""+t;if(!Array.isArray(t))return t;if(0===t.length)return null;for(var n=t,i=0,o=!1,r=void 0,s=t.length,u={};i<s;){if(r=i in u?u[i]:Gt(t[i]),null===r)null!==n&&(o?n===t&&(n=t.slice(0,i)):n=null);else if("object"==typeof r)Array.isArray(r)?n=o?(n===t?n.slice(0,i):Array.isArray(n)?n:[Jt(n)]).concat(r):r:n!==t?o?Array.isArray(n)?n.push(r):n=[Jt(n),r]:n=r:r!==t[i]&&(o?(n=n.slice(0,i),n.push(r)):n=r),o=!0;else{for(var a=void 0,h=i;++h<s;)if(a=u[h]=Gt(t[h]),"string"==typeof a)r+=a;else if(null!==a)break;o?Array.isArray(n)?(n===t&&(n=n.slice(0,i)),n.push(Jt(r))):n=[n,Jt(r)]:n=""+r,i=h-1,o=!0}++i}return n}function Jt(t){return"object"==typeof t?t:Zt("text").setChildren(t)}var Qt=/&/g,Xt=/"/g,Yt=/([^A-Z]+)([A-Z])/g,te=void 0;"undefined"==typeof Map?(te=function(t){if(this._storage={},t)for(var e=0;e<t.length;e++)this._storage[t[e][0]]=t[e][1]},te.prototype={has:function(t){return t in this._storage},get:function(t){return this._storage[t]},set:function(t,e){return this._storage[t]=e,this},delete:function(t){return delete this._storage[t]},forEach:function(t,e){var n=this._storage;for(var i in n)t.call(e,n[i],i,this)}}):te=Map;var ee=te,ne=!1,ie=new ee,oe=new ee,re={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},se={set:o,remove:h,toString:f},ue={set:r,remove:h,toString:p},ae={set:s,remove:l,toString:f},he={set:s,remove:l,toString:p},le=new ee([["autoPlay",ue],["checked",he],["controls",ae],["disabled",ue],["id",ae],["ismap",ue],["loop",ae],["multiple",he],["muted",ae],["open",ue],["readOnly",he],["selected",he],["srcDoc",ae],["style",{set:u,remove:l,toString:v}],["value",{set:a,remove:l,toString:f}]]),de=function(t){return le.has(t)?le.get(t):se},ce={append:g,remove:y,insertBefore:C,move:N,replace:A,removeChildren:x,updateText:D,removeText:w};T.prototype={stopPropagation:function(){this._isPropagationStopped=!0;var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},isPropagationStopped:function(){return this._isPropagationStopped},preventDefault:function(){this._isDefaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1},isDefaultPrevented:function(){return this._isDefaultPrevented},persist:function(){this._isPersisted=!0}};var fe={},pe="__vidom__id__",ve=1,me="undefined"==typeof navigator?"":navigator.userAgent,_e=me.indexOf("Trident")>-1,ge=me.indexOf("Edge")>-1,ye=/iPad|iPhone|iPod/.test(me)&&"undefined"==typeof MSStream,Ce=["click","mousedown","mousemove","mouseout","mouseover","mouseup"],Ne=["blur","change","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","paste","submit","touchcancel","touchend","touchmove","touchstart","wheel"],Ae=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","load","loadeddata","loadedmetadata","loadstart","mouseenter","mouseleave","pause","play","playing","progress","ratechange","scroll","seeked","seeking","select","stalled","suspend","timeupdate","volumechange","waiting"];ye?Ae=[].concat(Ae,Ce):Ne=[].concat(Ne,Ce);var xe=new ee,De=new ee,we=!0;"undefined"!=typeof document&&!function(){for(var t={focus:"focusin",blur:"focusout"},e=0,n=void 0;e<Ne.length;)n=Ne[e++],De.set(n,{type:n,bubbles:!0,listenersCount:0,set:!1,setup:t[n]?b(t[n])?function(){var e=this.type;document.addEventListener(t[e],function(t){S(t,e)})}:function(){document.addEventListener(this.type,S,!0)}:null});for(e=0;e<Ae.length;)De.set(Ae[e++],{type:n,bubbles:!1,set:!1,setup:null})}();for(var be="http://www.w3.org/1999/xhtml",Te=["onAnimationEnd","onAnimationIteration","onAnimationStart","onBlur","onCanPlay","onCanPlayThrough","onChange","onClick","onComplete","onContextMenu","onCopy","onCut","onDblClick","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDragStart","onDrop","onDurationChange","onEmptied","onEnded","onError","onFocus","onInput","onKeyDown","onKeyPress","onKeyUp","onLoad","onLoadedData","onLoadedMetadata","onLoadStart","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","onPause","onPlay","onPlaying","onProgress","onRateChange","onScroll","onSeeked","onSeeking","onSelect","onStalled","onSubmit","onSuspend","onTimeUpdate","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onTransitionEnd","onVolumeChange","onWaiting","onWheel"],Re=new ee,ke=0;ke<Te.length;ke++)Re.set(Te[ke],Te[ke].substr(2).toLowerCase());var Se={appendChild:F,insertChild:B,removeChild:K,moveChild:H,removeChildren:V,replace:W,updateAttr:z,removeAttr:Z,updateText:$,removeText:G},Me=new ee,Ee={},Pe="undefined"==typeof console?null:console,Ie={},Le={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){Ie[t]=Pe?Pe[t]?function(e,n,i,o,r){var s=Le[t];switch(arguments.length){case 1:Pe[t](s,e);break;case 2:Pe[t](s,e,n);break;case 3:Pe[t](s,e,n,i);break;case 4:Pe[t](s,e,n,i,o);break;case 5:Pe[t](s,e,n,i,o,r)}}:function(){Pe.log.apply(Pe,arguments)}:Y});var Ue=1,qe=2,Oe=3,je=4,Fe=5,Be=6;nt.prototype={getDomNode:function(){return this._domNode},setKey:tt,setChildren:function(t){return this.children=it(t),this},setCtx:function(t){if(t!==Ee){this._ctx=t;var e=this.children;if(null!==e)for(var n=e.length,i=0;i<n;)e[i++].setCtx(t)}return this},renderToDom:function(t){var e=this.children,n=[J("!",null),J("!",null)],i=document.createDocumentFragment();if(i.appendChild(n[0]),null!==e)for(var o=e.length,r=0;r<o;)i.appendChild(e[r++].renderToDom(t));return i.appendChild(n[1]),this._domNode=n,i},renderToString:function(){var t=this.children,e="<!---->";if(null!==t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],i=this.children;if(null!==i)for(var o=i.length,r=0;r<o;)e=i[r++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this.children;if(null!==t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this.children;if(null!==t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},clone:function(){var t=new nt;return t.key=this.key,t.children=this.children,t._ctx=this._ctx,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Se.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(null!==e||null!==n){if(null===n||0===n.length)return void(null!==e&&e.length>0&&Se.removeChildren(this));if(null!==e&&0!==e.length)Q(this,t);else for(var i=n.length,o=0;o<i;)Se.appendChild(t,n[o++])}}};rt.prototype={getDomNode:function(){return null===this._rootNode?null:this._rootNode.getDomNode()},setKey:tt,setAttrs:function(t){return this.attrs=this.attrs===Ee?t:ot(this.attrs,t),this},setChildren:function(t){return this.children=t,this},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootNode().renderToDom(t)},renderToString:function(){return this._getRootNode().renderToString()},adoptDom:function(t,e){return this._getRootNode().adoptDom(t,e)},mount:function(){this._getRootNode().mount()},unmount:function(){null!==this._rootNode&&(this._rootNode.unmount(),this._rootNode=null)},clone:function(){var t=new rt(this._component);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._ctx=this._ctx,t},patch:function(t){if(this===t){var e=this._getRootNode();this._rootNode=null,e.patch(this._getRootNode())}else this.type===t.type&&this._component===t._component?(this._getRootNode().patch(t._getRootNode()),this._rootNode=null):(Se.replace(this,t),this._rootNode=null)},_getRootNode:function(){if(null!==this._rootNode)return this._rootNode;var t=this._component(this.attrs,this.children,this._ctx)||Zt("!");return t.setCtx(this._ctx),this._rootNode=t}};st.prototype={getDomNode:function(){return this._domNode},setKey:tt,setChildren:function(t){return this.children=ut(t),this},setCtx:function(){return this},renderToDom:function(){var t=document.createDocumentFragment(),e=[J("!",null),J("!",null)],n=this.children;return t.appendChild(e[0]),null!==n&&t.appendChild(document.createTextNode(n)),t.appendChild(e[1]),this._domNode=e,t},renderToString:function(){return"<!---->"+(this.children||"")+"<!---->"},adoptDom:function(t,e){var n=[t[e++]];return this.children&&e++,n.push(t[e++]),this._domNode=n,e},mount:Y,unmount:Y,clone:function(){var t=new st;return t.key=this.key,t.children=this.children,t},patch:function(t){this!==t&&(this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Se.replace(this,t))},_patchChildren:function(t){var e=this.children,n=t.children;e!==n&&(n?Se.updateText(this,n,!1):e&&Se.removeText(this))}};var Ke="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},He=[];lt.prototype={on:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this._listeners[t];if(i)for(var o=0,r=void 0;o<i.length;){if(r=i[o],r.fn===e&&r.fnCtx===n){i.splice(o,1);break}o++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];for(;n<e.length;){var s=e[n++],u=s.fn,a=s.fnCtx;u.call.apply(u,[a].concat(o))}}return this}},dt.prototype={getDomNode:function(){return this._childNode.getDomNode()},setNs:function(t){return t&&(this._ns=t),this},setCtx:function(t){return t&&this._childNode.setCtx(t),this},renderToDom:function(){return this._childNode.renderToDom(this._ns)},adoptDom:function(t){this._childNode.adoptDom(t,0)},patch:function(t){this._childNode.patch(t._childNode)},mount:function(){this._childNode.mount()},unmount:function(){this._childNode.unmount()}};var Ve=new ee,We=0,ze=new lt;ze.getRootNodes=Ct;var Ze=jt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new Wt("input").setAttrs(ot(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),i=this.attrs.value;"undefined"!=typeof i&&n.value!==i&&(n.value=i)}},onRefRequest:function(){return this.getDomNode()}}),$e=new ee,Ge=jt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Wt("input").setAttrs(ot(this.attrs,this._addAttrs))},onMount:function(){var t=this.attrs.name;t&&Ft(t,this)},onUpdate:function(t){var e=t.name,n=this.attrs.name;n!==e&&(e&&Bt(e,this),n&&Ft(n,this))},onUnmount:function(){var t=this.attrs.name;t&&Bt(t,this)},onChange:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),i=this.attrs,o=i.name,r=i.checked;if("undefined"!=typeof r&&n.checked!==r)if(o){for(var s=$e.get(o),u=s.length,a=0,h=void 0,l=void 0;a<u;)if(h=s[a++],l=h.attrs.checked,"undefined"!=typeof l){var d=h.getDomNode();l!==d.checked&&(d.checked=l)}}else n.checked=r}},onRefRequest:function(){return this.getDomNode()}}),Je=jt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Wt("input").setAttrs(ot(this.attrs,this._addAttrs))},onChange:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),i=this.attrs.checked;"undefined"!=typeof i&&n.checked!==i&&(n.checked=i)}},onRefRequest:function(){return this.getDomNode()}}),Qe=jt({onRender:function(){return new Wt("input").setAttrs(this.attrs)},onRefRequest:function(){return this.getDomNode()}});Kt.prototype={getDomNode:function(){return null===this._instance?null:this._instance.getDomNode()},setKey:tt,setRef:et,setAttrs:function(t){if(this.attrs=this.attrs===Ee?t:ot(this.attrs,t),this._component===Ze)switch(this.attrs.type){case"radio":this._component=Ge;break;case"checkbox":this._component=Je;break;case"file":this._component=Qe}return this},setChildren:function(t){return this.children=t,this},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.getRootNode().mount(),this._instance.mount(),null!==this._ref&&this._ref(this._instance.onRefRequest())},unmount:function(){null!==this._instance&&(this._instance.getRootNode().unmount(),this._instance.unmount(),this._instance=null),null!==this._ref&&this._ref(null)},clone:function(){var t=new Kt(this._component);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){var e=this._getInstance();this===t?e.patch(t.attrs,t.children,t._ctx,!0):this.type===t.type&&this._component===t._component?(e.patch(t.attrs,t.children,t._ctx,!0),t._instance=e,this._patchRef(t)):(Se.replace(this,t),this._instance=null)},_patchRef:function(t){null!==this._ref?this._ref!==t._ref&&(this._ref(null),null!==t._ref&&t._ref(t._instance.onRefRequest())):null!==t._ref&&t._ref(t._instance.onRefRequest())},_getInstance:function(){return null===this._instance?this._instance=new this._component(this.attrs,this.children,this._ctx):this._instance}};var Xe=/&/g,Ye=/</g,tn=/>/g,en={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},nn={thead:"table",tbody:"table",tfoot:"table",tr:"tbody",td:"tr"},on={},rn=new ee([["area",!0],["base",!0],["br",!0],["col",!0],["command",!0],["embed",!0],["hr",!0],["img",!0],["input",!0],["keygen",!0],["link",!0],["menuitem",!0],["meta",!0],["param",!0],["source",!0],["track",!0],["wbr",!0]]),sn=_e||ge,un=16;Wt.prototype={getDomNode:function(){return this._domNode},setKey:tt,setRef:et,setNs:function(t){return this._ns=t,this},setAttrs:function(t){return this.attrs=this.attrs===Ee?t:ot(this.attrs,t),this},setChildren:function(t){return this.children=zt(t),this},setHtml:function(t){return this.children=t,this._escapeChildren=!1,this},setCtx:function(t){if(t!==Ee){this._ctx=t;var e=this.children;if(null!==e&&"string"!=typeof e)for(var n=e.length,i=0;i<n;)e[i++].setCtx(t)}return this},renderToDom:function(t){var e=this.tag,n=this.children,i=this._ns||t;if(sn&&n&&"string"!=typeof n){var o=Vt(this.renderToString(),e,i);return this.adoptDom([o],0),o}var r=this._domNode=J(e,i),s=this.attrs;if(null!==n)if("string"==typeof n)this._escapeChildren?r.textContent=n:r.innerHTML=n;else for(var u=0,a=n.length;u<a;)r.appendChild(n[u++].renderToDom(i));if(s!==Ee){var h=void 0,l=void 0;for(h in s)null!=(l=s[h])&&(Re.has(h)?E(r,Re.get(h),l):de(h).set(r,h,l))}return r},renderToString:function(){var t=this.tag;if("!"===t)return"<!---->";var e=this._ns,i=this.attrs,o=this.children,r="<"+t;if(null!==e&&(r+=' xmlns="'+e+'"'),i!==Ee){var s=void 0,u=void 0,a=void 0;for(s in i)if(u=i[s],null!=u){if("value"===s)switch(t){case"textarea":o=u;continue;case"select":this.setCtx({value:u,multiple:i.multiple});continue;case"option":var h=this._ctx;(h.multiple?n(h.value,u):h.value===u)&&(r+=" "+de("selected").toString("selected",!0))}Re.has(s)||""===(a=de(s).toString(s,u))||(r+=" "+a)}}if(rn.has(t))r+="/>";else{if(r+=">",null!==o)if("string"==typeof o)r+=this._escapeChildren?Ht(o):o;else for(var l=0,d=o.length;l<d;)r+=o[l++].renderToString();r+="</"+t+">"}return r},adoptDom:function(t,e){var n=this._domNode=t[e],i=this.attrs,o=this.children;if(i!==Ee){var r=void 0,s=void 0;for(r in i)null!=(s=i[r])&&Re.has(r)&&E(n,Re.get(r),s)}if(null!==o&&"string"!=typeof o){var u=0,a=o.length;if(a>0)for(var h=n.childNodes,l=0;u<a;)l=o[u++].adoptDom(h,l)}return e+1},mount:function(){var t=this.children;if(null!==t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount();this._ref&&this._ref(this._domNode)},unmount:function(){var t=this.children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();L(this._domNode),this._domNode=null,this._ref&&this._ref(null)},clone:function(){var t=new Wt(this.tag);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._sets=un,t._ns=this._ns,t._escapeChildren=this._escapeChildren,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type&&this.tag===t.tag&&this._ns===t._ns?(t._domNode=this._domNode,this._patchAttrs(t),this._patchChildren(t),this._patchRef(t)):Se.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(null!==e||null!==n){var i="string"==typeof e,o="string"==typeof n;if(o)return i?void(e!==n&&Se.updateText(this,n,t._escapeChildren)):(null!==e&&e.length>0&&Se.removeChildren(this),void(""!==n&&Se.updateText(this,n,t._escapeChildren)));if(null===n||0===n.length)return void(e&&(i?Se.removeText(this):e.length>0&&Se.removeChildren(this)));if(i&&""!==e&&Se.removeText(this),i||null===e||0===e.length)for(var r=n.length,s=0;s<r;)Se.appendChild(t,n[s++]);else Q(this,t)}},_patchAttrs:function(t){var e=this.attrs,n=t.attrs;if(e!==n){var i=void 0;if(n!==Ee){var o=void 0,r=void 0,s=void 0,u=void 0;for(i in n)r=n[i],e===Ee||null==(o=e[i])?null!=r&&Se.updateAttr(this,i,r):null==r?Se.removeAttr(this,i):"object"==typeof r&&"object"==typeof o?(u=Array.isArray(r),s=Array.isArray(o),u||s?u&&s?this._patchAttrArr(i,o,r):Se.updateAttr(this,i,r):this._patchAttrObj(i,o,r)):o!==r&&Se.updateAttr(this,i,r)}if(e!==Ee)for(i in e)n!==Ee&&i in n||null==e[i]||Se.removeAttr(this,i)}},_patchAttrArr:function(t,e,n){if(e!==n){var i=e.length,o=!1;if(i===n.length)for(var r=0;!o&&r<i;)e[r]!=n[r]&&(o=!0),++r;else o=!0;o&&Se.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var i={},o=!1;for(var r in n)e[r]!=n[r]&&(o=!0,i[r]=n[r]);for(var s in e)null==e[s]||s in n||(o=!0,i[s]=null);o&&Se.updateAttr(this,t,i)}},_patchRef:function(t){null!==this._ref?this._ref!==t._ref&&(this._ref(null),null!==t._ref&&t._ref(t._domNode)):null!==t._ref&&t._ref(t._domNode)}};var an=jt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new Wt("textarea").setAttrs(ot(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),i=this.attrs.value;"undefined"!=typeof i&&n.value!==i&&(n.value=i)}},onRefRequest:function(){return this.getDomNode()}}),hn=jt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Wt("select").setAttrs(ot(this.attrs,this._addAttrs)).setChildren(this.children)},onChange:function(t){var e=t.target,i=this.attrs,o=i.onChange,r=i.multiple;if(o)if(r){for(var s=[],u=e.options,a=u.length,h=0,l=void 0;h<a;)l=u[h++],l.selected&&s.push(l.value);o(t,s)}else o(t);if(at(),this.isMounted()){var d=this.attrs,c=d.value,f=d.multiple;if("undefined"!=typeof c)if(f)for(var p=e.options,v=p.length,m=0,_=void 0;m<v;)_=p[m++],_.selected=n(c,_.value);else e.value!=c&&(e.value=c)}},onRefRequest:function(){return this.getDomNode()}}),ln=jt();t.node=Zt,t.createComponent=jt,t.renderToString=$t,
t.normalizeChildren=Gt,t.IS_DEBUG=ne,t.console=Ie,t.Component=ln,t.mount=mt,t.mountSync=_t,t.unmount=gt,t.unmountSync=yt,t.getMountedRootNodes=Ct,Object.defineProperty(t,"__esModule",{value:!0})});
