{"version":3,"file":"glamorous.umd.tiny.js","sources":["../src/react-compat.js","../src/constants.js","../src/get-glamor-classname.js","../src/create-glamorous.js","../src/tiny.js"],"sourcesContent":["/* eslint import/no-mutable-exports:0, import/prefer-default-export:0 */\nimport React from 'react'\n\nlet PropTypes\n\n/* istanbul ignore next */\nif (React.version.slice(0, 4) === '15.5') {\n  /* istanbul ignore next */\n  try {\n    PropTypes = require('prop-types')\n    /* istanbul ignore next */\n  } catch (error) {\n    // ignore\n  }\n}\n/* istanbul ignore next */\nPropTypes = PropTypes || React.PropTypes\n\nexport {PropTypes}\n","export const CHANNEL = '__glamorous__'\n","import {css, styleSheet} from 'glamor'\n/**\n * This function takes a className string and gets all the\n * associated glamor styles. It's used to merge glamor styles\n * from a className to make sure that specificity is not\n * a problem when passing a className to a component.\n * @param {String} [className=''] the className string\n * @return {Object} { glamorStyles, glamorlessClassName }\n *   - glamorStyles is an array of all the glamor styles objects\n *   - glamorlessClassName is the rest of the className string\n *     without the glamor classNames\n */\nfunction extractGlamorStyles(className = '') {\n  return className.toString().split(' ').reduce((groups, name) => {\n    if (name.indexOf('css-') === 0) {\n      const id = name.slice('css-'.length)\n      const {style} = styleSheet.registered[id]\n      groups.glamorStyles.push(style)\n    } else {\n      // eslint-disable-next-line max-len\n      groups.glamorlessClassName = `${groups.glamorlessClassName} ${name}`.trim()\n    }\n    return groups\n  }, {glamorlessClassName: '', glamorStyles: []})\n}\n\nexport default getGlamorClassName\n\nfunction getGlamorClassName(styles, props, cssOverrides, theme) {\n  const mappedArgs = styles.slice()\n  for (let i = mappedArgs.length; i--;) {\n    if (typeof mappedArgs[i] === 'function') {\n      mappedArgs[i] = mappedArgs[i](props, theme)\n    }\n  }\n  const {\n    glamorStyles: parentGlamorStyles,\n    glamorlessClassName,\n  } = extractGlamorStyles(props.className)\n  const glamorClassName = css(\n    ...mappedArgs,\n    ...parentGlamorStyles,\n    cssOverrides,\n  ).toString()\n  return `${glamorlessClassName} ${glamorClassName}`.trim()\n}\n","/*\n * This is a relatively small abstraction that's ripe for open sourcing.\n * Documentation is in the README.md\n */\nimport React, {Component} from 'react'\nimport {PropTypes} from './react-compat'\nimport {CHANNEL} from './constants'\nimport getGlamorClassName from './get-glamor-classname'\n\nexport default function createGlamorous(splitProps) {\n  /**\n   * This is the main export and the function that people\n   * interact with most directly.\n   *\n   * It accepts a component which can be a string or\n   * a React Component and returns\n   * a \"glamorousComponentFactory\"\n   * @param {String|ReactComponent} comp the component to render\n   * @param {Object} options helpful info for the GlamorousComponents\n   * @return {Function} the glamorousComponentFactory\n   */\n  return function glamorous(\n    comp,\n    {rootEl, displayName, forwardProps = []} = {},\n  ) {\n    return glamorousComponentFactory\n\n    /**\n     * This returns a React Component that renders the comp (closure)\n     * with a className based on the given glamor styles object(s)\n     * @param {...Object|Function} styles the styles to create with glamor.\n     *   If any of these are functions, they are invoked with the component\n     *   props and the return value is used.\n     * @return {ReactComponent} the ReactComponent function\n     */\n    function glamorousComponentFactory(...styles) {\n      /**\n       * This is a component which will render the comp (closure)\n       * with the glamorous styles (closure). Forwards any valid\n       * props to the underlying component.\n       * @param {Object} theme the theme object\n       * @return {ReactElement} React.createElement\n       */\n      class GlamorousComponent extends Component {\n        state = {theme: null}\n        setTheme = theme => this.setState({theme})\n\n        componentWillMount() {\n          const {theme} = this.props\n          if (this.context[CHANNEL]) {\n            // if a theme is provided via props,\n            // it takes precedence over context\n            this.setTheme(theme ? theme : this.context[CHANNEL].getState())\n          } else {\n            this.setTheme(theme || {})\n          }\n        }\n\n        componentWillReceiveProps(nextProps) {\n          if (this.props.theme !== nextProps.theme) {\n            this.setTheme(nextProps.theme)\n          }\n        }\n\n        componentDidMount() {\n          if (this.context[CHANNEL] && !this.props.theme) {\n            // subscribe to future theme changes\n            this.unsubscribe = this.context[CHANNEL].subscribe(this.setTheme)\n          }\n        }\n\n        componentWillUnmount() {\n          // cleanup subscription\n          this.unsubscribe && this.unsubscribe()\n        }\n\n        render() {\n          // in this function, we're willing to sacrafice a little on\n          // readability to get better performance because it actually\n          // matters.\n          const props = this.props\n          const {toForward, cssOverrides} = splitProps(\n            props,\n            GlamorousComponent,\n          )\n\n          // freeze the theme object in dev mode\n          const theme = process.env.NODE_ENV === 'production' ?\n            this.state.theme :\n            Object.freeze(this.state.theme)\n          // create className to apply\n          const fullClassName = getGlamorClassName(\n            GlamorousComponent.styles,\n            props,\n            cssOverrides,\n            theme,\n          )\n\n          return React.createElement(GlamorousComponent.comp, {\n            ref: props.innerRef,\n            ...toForward,\n            className: fullClassName,\n          })\n        }\n      }\n\n      GlamorousComponent.propTypes = {\n        className: PropTypes.string,\n        cssOverrides: PropTypes.object,\n        theme: PropTypes.object,\n        innerRef: PropTypes.func,\n        glam: PropTypes.object,\n      }\n\n      GlamorousComponent.contextTypes = {\n        [CHANNEL]: PropTypes.object,\n      }\n\n      Object.assign(\n        GlamorousComponent,\n        getGlamorousComponentMetadata({\n          comp,\n          styles,\n          rootEl,\n          forwardProps,\n          displayName,\n        }),\n      )\n      return GlamorousComponent\n    }\n  }\n\n  function getGlamorousComponentMetadata({\n    comp,\n    styles,\n    rootEl,\n    forwardProps,\n    displayName,\n  }) {\n    const componentsComp = comp.comp ? comp.comp : comp\n    return {\n      // join styles together (for anyone doing: glamorous(glamorous.a({}), {}))\n      styles: comp.styles ? comp.styles.concat(styles) : styles,\n      // keep track of the ultimate rootEl to render (we never\n      // actually render anything but\n      // the base component, even when people wrap a glamorous\n      // component in glamorous\n      comp: componentsComp,\n      rootEl: rootEl || componentsComp,\n      forwardProps,\n      // set the displayName to something that's slightly more\n      // helpful than `GlamorousComponent` :)\n      displayName: displayName || `glamorous(${getDisplayName(comp)})`,\n    }\n  }\n\n  function getDisplayName(comp) {\n    return typeof comp === 'string' ?\n      comp :\n      comp.displayName || comp.name || 'unknown'\n  }\n}\n","/* eslint no-unused-vars:0 */\nimport createGlamorous from './create-glamorous'\n\nfunction splitProps({\n  css: cssOverrides = {},\n  // these are plucked off\n  theme, // because they\n  className, // should never\n  innerRef, // be forwarded\n  glam, // to the lower\n  // component ever\n  ...rest\n}) {\n  return {toForward: rest, cssOverrides}\n}\n\nconst glamorous = createGlamorous(splitProps)\n\nexport default glamorous\n"],"names":["PropTypes","React","version","slice","require","error","CHANNEL","extractGlamorStyles","className","toString","split","reduce","groups","name","indexOf","id","length","style","styleSheet","registered","glamorStyles","push","glamorlessClassName","trim","getGlamorClassName","styles","props","cssOverrides","theme","mappedArgs","i","parentGlamorStyles","glamorClassName","css","createGlamorous","splitProps","glamorous","comp","rootEl","displayName","forwardProps","glamorousComponentFactory","GlamorousComponent","state","setTheme","setState","context","getState","nextProps","unsubscribe","subscribe","toForward","Object","freeze","fullClassName","createElement","innerRef","Component","propTypes","string","object","func","contextTypes","assign","getGlamorousComponentMetadata","componentsComp","concat","getDisplayName","glam","rest"],"mappings":"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"}