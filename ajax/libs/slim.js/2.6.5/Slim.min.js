class e extends HTMLElement{static polyfill(t){e.__isWCSupported||document.write('<script src="'+t+'"></script>')}static tag(t,i,r){void 0===r?r=i:e.__templateDict[t]=i,e.__prototypeDict[t]=r,document.registerElement(t,r)}static getTag(t){for(let i in e.__prototypeDict)if(e.__prototypeDict[i]===t)return i}static get interactionEventNames(){return["click","mouseover","mouseout","mousemove","mouseenter","mousedown","mouseup","dblclick","contextmenu","wheel","mouseleave","select","pointerlockchange","pointerlockerror","focus","blur","input","error","invalid","animationstart","animationend","animationiteration","reset","submit","resize","scroll","keydown","keypress","keyup","change"]}static plugin(t,i){if(["create","beforeRender","beforeRemove","afterRender"].indexOf(t)===-1)throw"Supported phase can be create, beforeRemove, beforeRender or afterRender only";e.__plugins[t].push(i)}static registerCustomAttribute(t,i){e.__customAttributeProcessors[t]=e.__customAttributeProcessors[t]||[],e.__customAttributeProcessors[t].push(i)}static __runPlugins(t,i){e.__plugins[t].forEach(e=>{e(i)})}static __moveChildrenBefore(e,t,i){for(;e.children.length;)t.parentNode.insertBefore(e.children[0],t);let r=Array.prototype.slice.call(t.querySelectorAll("*"));for(let n of r)i&&n.isSlim&&n.createdCallback()}static __moveChildren(e,t,i){for(;e.children.length;)t.appendChild(e.children[0]);let r=Array.prototype.slice.call(t.querySelectorAll("*"));for(let n of r)i&&n.isSlim&&n.createdCallback()}static __lookup(e,t){let i=t.split("."),r=i[0];for(;i.length&&e;)e=e[r=i.shift()];return{source:t,prop:r,obj:e}}static __createRepeater(t){void 0===e.__prototypeDict["slim-repeat"]&&e.__initRepeater();let i;e.__isWCSupported?(i=document.createElement("slim-repeat"),i.sourceNode=t.target,t.target.parentNode.insertBefore(i,t.target),t.repeater=i):(t.target.insertAdjacentHTML("beforebegin",'<slim-repeat slim-new="true"></slim-repeat>'),i=t.target.parentNode.querySelector('slim-repeat[slim-new="true"]'),i.__proto__=window.SlimRepeater.prototype,i.sourceNode=t.target,i.removeAttribute("slim-new"),i.createdCallback()),i._boundParent=t.source,t.target.parentNode.removeChild(t.target),i._isAdjacentRepeater=t.repeatAdjacent,i.setAttribute("source",t.properties[0]),i.setAttribute("target-attr",t.targetAttribute),t.repeater=i}static __dashToCamel(e){return e.indexOf("-")<0?e:e.replace(/-[a-z]/g,e=>{return e[1].toUpperCase()})}static __camelToDash(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}constructor(){super(),this.createdCallback()}find(e){return this.querySelector(e)}findAll(e){return Array.prototype.slice.call(this.querySelectorAll(e))}watch(e,t){let i={type:"W",properties:[e],executor:t,target:this,source:this};this._bindings=this._bindings||{},this._boundParent=this._boundParent||this,this.__bind(i)}callAttribute(t,i){if(!this._boundParent)throw"Unable to call attribute-bound method when no bound parent available";let r=this.getAttribute(t);if(null===r)return void(console.warn&&console.warn("Unable to call null attribute-bound method on bound parent "+this._boundParent.outerHTML));if("function"==typeof this[r])this[r](i);else if("function"==typeof this._boundParent[r])this._boundParent[r](i);else if(this._boundParent&&this._boundParent._boundParent&&"function"==typeof this._boundParent._boundParent[r])this._boundParent._boundParent[r](i);else{if(!this._boundRepeaterParent||"function"!=typeof this._boundRepeaterParent[r])throw"Unable to call attribute-bound method: "+r+" on bound parent "+this._boundParent.outerHTML+" with value "+i;this._boundRepeaterParent[r](i)}"function"==typeof this.update&&(this.isInteractive||e.autoAttachInteractionEvents||this.getAttribute("interactive"))&&this.update()}__bind(t){t.properties.forEach(i=>{let r;r=i.indexOf(".")>0?i.split(".")[0]:i;let n=t.source||t.target._boundParent||t.parentNode;n._bindings=n._bindings||{},n._bindings[r]=n._bindings[r]||{value:n[r],executors:[]},n.__lookupGetter__(i)||n.__defineGetter__(i,function(){return this._bindings[i].value}),n.__lookupSetter__(i)||n.__defineSetter__(i,function(e){this._bindings[i].value=e,t.sourceText&&(t.target.innerText=t.sourceText),this._executeBindings(i),"function"==typeof this[i+"Changed"]&&this[i+"Changed"](e)});let o;"C"===t.type?o=(()=>{t.executor()}):"P"===t.type?o=(()=>{if(!t.target.hasAttribute("slim-repeat")){let r=t.target._boundRepeaterParent,o=e.__lookup(r||n,i).obj||e.__lookup(t.target,i).obj;t.target[e.__dashToCamel(t.attribute)]=o,t.target.setAttribute(t.attribute,o)}}):"M"===t.type?o=(()=>{if(!t.target.hasAttribute("slim-repeat")){let i=t.target._boundRepeaterParent||n,r=i[t.method].apply(i,t.properties.map(e=>{return t.target[e]||i[e]}));t.target[e.__dashToCamel(t.attribute)]=r,t.target.setAttribute(t.attribute,r)}}):"T"===t.type?o=(()=>{let r=t.target._boundParent;t.target.innerText=t.target.innerText.replace(`[[${i}]]`,e.__lookup(r,i).obj)}):"R"===t.type?o=(()=>{t.repeater.renderList()}):"W"===t.type&&(o=(()=>{t.executor(e.__lookup(n,i).obj)})),o.descriptor=t,n._bindings[r].executors.push(o)})}static __processRepeater(e,t){return{type:"R",target:t,targetAttribute:t.getAttribute("slim-repeat-as")?t.getAttribute("slim-repeat-as"):"data",repeatAdjacent:t.hasAttribute("slim-repeat-adjacent")||"option"===t.localName,attribute:e.nodeName,properties:[e.nodeValue],source:t._boundParent}}static __processCustomAttribute(t,i){return{type:"C",target:i,properties:[t.nodeValue],executor:()=>{e.__customAttributeProcessors[t.nodeName].forEach(e=>{e(i,t.nodeValue)})}}}static extract(t,i){const r=(e.rxInject.exec(i),e.rxProp.exec(i)),n=e.rxMethod.exec(i);return r?t[r[1]]:n?t[n[1]].apply(t,n[3].replace(" ","").split(",")):void 0}static __processAttribute(t,i){if("slim-repeat"===t.nodeName)return e.__processRepeater(t,i);if(e.__customAttributeProcessors[t.nodeName])return e.__processCustomAttribute(t,i);const r=e.rxInject.exec(t.nodeValue),n=e.rxProp.exec(t.nodeValue),o=e.rxMethod.exec(t.nodeValue);return o?{type:"M",target:i,attribute:t.nodeName,method:o[1],properties:o[3].replace(" ","").split(",")}:n?{type:"P",target:i,attribute:t.nodeName,properties:[n[1]]}:r?{type:"I",target:i,attribute:t.nodeName,factory:r[1]}:void 0}get isVirtual(){let e=this;for(;e;){if(e=e.parentNode,!e)return!0;if("BODY"===e.nodeName)return!1}return!0}get useShadow(){return!1}get rootElement(){return this.useShadow?(this.__shadowRoot=this.__shadowRoot||this.createShadowRoot(),this.__shadowRoot):this}createdCallback(){this.isVirtual||this.__createdCallbackRunOnce||(this.__createdCallbackRunOnce=!0,this.initialize(),this.onBeforeCreated(),this._captureBindings(),e.__runPlugins("create",this),this.onCreated(),this.__onCreatedComplete=!0,this.onBeforeRender(),e.__runPlugins("beforeRender",this),e.__moveChildren(this._virtualDOM,this.rootElement,!0),this.onAfterRender(),e.__runPlugins("afterRender",this),this.update())}detachedCallback(){e.__runPlugins("beforeRemove",this),this.onRemoved()}_initInteractiveEvents(){!this.__eventsInitialized&&(e.autoAttachInteractionEvents||this.isInteractive||this.hasAttribute("interactive"))&&e.interactionEventNames.forEach(e=>{this.addEventListener(e,e=>{this.handleEvent(e)})})}initialize(){this._bindings=this._bindings||{},this._boundChildren=this._boundChildren||[],this._initInteractiveEvents(),this.__eventsInitialized=!0,this.alternateTemplate=this.alternateTemplate||null,this._virtualDOM=this._virtualDOM||document.createElement("slim-root")}get isSlim(){return!0}get template(){return e.__templateDict[this.nodeName.toLowerCase()]||null}get isInteractive(){return!1}handleEvent(e){this.hasAttribute("on"+e.type)?this.callAttribute("on"+e.type,e):this.hasAttribute(e.type)&&this.callAttribute(e.type,e)}connectedCallback(){this.attachedCallback()}disconnectedCallback(){this.detachedCallback()}attachedCallback(){this.onAdded()}onAdded(){}onRemoved(){}onBeforeCreated(){}onCreated(){}onBeforeRender(){}onAfterRender(){}onBeforeUpdate(){}onAfterUpdate(){}update(){this.onBeforeUpdate(),this._executeBindings(),this.onAfterUpdate()}render(t){e.__runPlugins("beforeRender",this),this.onBeforeRender(),this.alternateTemplate=t,this.initialize(),this.rootElement.innerHTML="",this._captureBindings(),this._executeBindings(),e.__moveChildren(this._virtualDOM,this.rootElement,!0),this.onAfterRender(),e.__runPlugins("afterRender",this)}_executeBindings(e){if(this._bindings){this._boundChildren.forEach(e=>{e.hasAttribute("bind")&&void 0!==e.sourceText&&(e.innerText=e.sourceText)});const t=e?[e]:Object.keys(this._bindings);t.forEach(e=>{this._bindings[e].executors.forEach(e=>{"T"!==e.descriptor.type&&e()})}),Object.keys(this._bindings).forEach(e=>{this._bindings[e].executors.forEach(e=>{"T"===e.descriptor.type&&e()})})}}_captureBindings(){const t=this;let i=this.alternateTemplate||this.template;if(i){if("string"==typeof i){this._virtualDOM.innerHTML=i;let e=this._virtualDOM.querySelector("slim-content");if(e)for(;t.children.length;)t.children[0]._boundParent=this.children[0]._boundParent||this,e.appendChild(this.children[0])}}else for(;this.children.length;)t._virtualDOM=this._virtualDOM||document.createElement("slim-root"),t._virtualDOM.appendChild(this.children[0]);let r=Array.prototype.slice.call(this._virtualDOM.querySelectorAll("*"));for(let n of r){n._sourceOuterHTML=n.outerHTML,n._boundParent=n._boundParent||this,t._boundChildren=this._boundChildren||[],t._boundChildren.push(n),t._boundChildren.push(n),n.getAttribute("slim-id")&&(n._boundParent[e.__dashToCamel(n.getAttribute("slim-id"))]=n);let i=n.getAttribute("slim-id");i&&(this[i]=n);let r=[];if(n.attributes)for(let o=0;o<n.attributes.length;o++){!n.isSlim&&e.interactionEventNames.indexOf(n.attributes[o].nodeName)>=0&&(n.isInteractive=!0,n.handleEvent=t.handleEvent.bind(n),n.callAttribute=t.callAttribute.bind(n),n.addEventListener(n.attributes[o].nodeName,n.handleEvent));let i=e.__processAttribute(n.attributes[o],n);if(i&&r.push(i),n[e.__dashToCamel(n.attributes[o].nodeName)]=n.attributes[o].nodeValue,"0"==n.attributes[o].nodeName.indexOf("#")){let e=n.attributes[o].nodeName.slice(1);this[e]=n}}r=r.sort(e=>{return"I"===e.type?-1:"R"===e.type?1:"C"===e.type?2:0}),r.forEach(t=>{"P"===t.type||"M"===t.type||"C"===t.type?this.__bind(t):"I"===t.type?e.__inject(t):"R"===t.type&&(e.__createRepeater(t),this.__bind(t))})}r=Array.prototype.slice.call(this._virtualDOM.querySelectorAll("*[bind]"));for(let n of r){let e=n.innerText.match(/\[\[([\w|.]+)\]\]/g);if(e&&n.children.length>0)throw"Bind Error: Illegal bind attribute use on element type "+n.localName+" with nested children.\n"+n.outerHTML;if(e){let t=[];for(let i=0;i<e.length;i++){let r=e[i].match(/([^\[].+[^\]])/)[0];t.push(r)}let r={type:"T",properties:t,target:n,sourceText:n.innerText};n.sourceText=n.innerText,this.__bind(r)}}}}e.rxInject=/\{(.+[^(\((.+)\))])\}/,e.rxProp=/\[\[(.+[^(\((.+)\))])\]\]/,e.rxMethod=/\[\[(.+)(\((.+)\)){1}\]\]/,e.__customAttributeProcessors={},e.__prototypeDict={},e.__templateDict={},e.__plugins={create:[],beforeRender:[],afterRender:[],beforeRemove:[]};try{e.__isWCSupported=function(){return"registerElement"in document&&"import"in document.createElement("link")&&"content"in document.createElement("template")}()}catch(t){e.__isWCSupported=!1}e.__initRepeater=function(){class t extends e{get useShadow(){return!1}get sourceData(){try{let t=e.__lookup(this._boundParent,this.getAttribute("source"));return t.obj||[]}catch(e){return[]}}onRemoved(){this.sourceData.unregisterSlimRepeater(this)}registerForRender(){this.pendingRender||(this.pendingRender=!0,setTimeout(()=>{this.checkoutRender()},0))}checkoutRender(){this.pendingRender=!1,this.renderList()}renderList(){let t=this.getAttribute("target-attr");if(this.sourceNode){this.clones&&this.clones.forEach(e=>{e.remove()}),this.clones=[],this.sourceData.registerSlimRepeater(this),this.sourceData.forEach((i,r)=>{let n=this.sourceNode.cloneNode(!0);n.removeAttribute("slim-repeat"),n.removeAttribute("slim-repeat-as"),n.setAttribute("slim-repeat-index",r),e.__isWCSupported||(this.insertAdjacentHTML("beforeEnd",n.outerHTML),n=this.find('*[slim-repeat-index="'+r.toString()+'"]')),n[t]=i,n.data_index=r,n.data_source=this.sourceData,n.sourceText=n.innerText,e.__isWCSupported&&this.insertAdjacentElement("beforeEnd",n),this.clones.push(n)}),this._captureBindings();for(let i of this.clones)i[t]=i[t],i._boundRepeaterParent=this._boundParent,void 0!==e.__prototypeDict[i.localName]||i.isSlim?i._boundParent=this._boundParent:i._boundParent=i,Array.prototype.slice.call(i.querySelectorAll("*")).forEach(e=>{e._boundParent=i._boundParent,e._boundRepeaterParent=i._boundRepeaterParent,e[t]=i[t],e.data_index=i.data_index,e.data_source=i.data_source});this._executeBindings(),this._isAdjacentRepeater?e.__moveChildrenBefore(this._virtualDOM,this,!0):e.__moveChildren(this._virtualDOM,this,!0)}}}e.tag("slim-repeat",t),window.SlimRepeater=t},window.Slim=e,function(){const e={};["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){e[t]=Array.prototype[t],Array.prototype[t]=function(){let i=e[t].apply(this,arguments);return this.registeredSlimRepeaters&&this.registeredSlimRepeaters.forEach(e=>{e.registerForRender()}),i}}),Array.prototype.registerSlimRepeater=function(e){void 0===this.registeredSlimRepeaters&&Object.defineProperty(this,"registeredSlimRepeaters",{enumerable:!1,configurable:!1,value:[]}),this.registeredSlimRepeaters.indexOf(e)<0&&this.registeredSlimRepeaters.push(e)},Array.prototype.unregisterSlimRepeater=function(e){this.registeredSlimRepeaters&&this.registeredSlimRepeaters.indexOf(e)>=0&&this.registeredSlimRepeaters.splice(this.registeredSlimRepeaters.indexOf(e),1)}}(),"undefined"!=typeof module&&module.exports&&(module.exports.Slim=e);