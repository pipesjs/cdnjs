!function(){var t;t="undefined"!=typeof module&&void 0!==module.exports?require("./pnglib"):window.PNGlib;var i=function(t,i){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof i?i:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var s=parseInt(this.hash.substr(-7),16)/268435455,r=this.options.saturation||this.defaults.saturation,o=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(s,r,o)};i.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new s(this.size,this.foreground,this.background):new t(this.size,this.size,256)},render:function(){var t=this.image(),i=this.size,s=Math.floor(i*this.margin),r=Math.floor((i-2*s)/5),o=Math.floor((i-5*r)/2);bg=t.color.apply(t,this.background),fg=t.color.apply(t,this.foreground);var e,n;for(e=0;e<15;e++)n=parseInt(this.hash.charAt(e),16)%2?bg:fg,e<5?this.rectangle(2*r+o,e*r+o,r,r,n,t):e<10?(this.rectangle(1*r+o,(e-5)*r+o,r,r,n,t),this.rectangle(3*r+o,(e-5)*r+o,r,r,n,t)):e<15&&(this.rectangle(0*r+o,(e-10)*r+o,r,r,n,t),this.rectangle(4*r+o,(e-10)*r+o,r,r,n,t));return t},rectangle:function(t,i,s,r,o,e){if(this.isSvg())e.rectangles.push({x:t,y:i,w:s,h:r,color:o});else{var n,h;for(n=t;n<t+s;n++)for(h=i;h<i+r;h++)e.buffer[e.index(n,h)]=o}},hsl2rgb:function(t,i,s){return t*=6,i=[s+=i*=s<.5?s:1-s,s-t%1*i*2,s-=i*=2,s,s+t%1*i,s+i],[255*i[~~t%6],255*i[(16|t)%6],255*i[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var s=function(t,i,s){this.size=t,this.foreground=this.color.apply(this,i),this.background=this.color.apply(this,s),this.rectangles=[]};s.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,i,s,r){var o=[t,i,s].map(Math.round);return o.push(r>=0&&r<=255?r/255:1),"rgba("+o.join(",")+")"},getDump:function(){var t,i,s,r=this.foreground,o=this.background,e=.005*this.size;for(i="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+o+";'><g style='fill:"+r+"; stroke:"+r+"; stroke-width:"+e+";'>",t=0;t<this.rectangles.length;t++)(s=this.rectangles[t]).color!=o&&(i+="<rect  x='"+s.x+"' y='"+s.y+"' width='"+s.w+"' height='"+s.h+"'/>");return i+="</g></svg>"},getBase64:function(){return btoa(this.getDump())}},"undefined"!=typeof module&&void 0!==module.exports?module.exports=i:window.Identicon=i}();