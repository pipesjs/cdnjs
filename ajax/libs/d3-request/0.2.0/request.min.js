!function(e,n){"use strict";function t(e,n){return n>e?-1:e>n?1:e>=n?0:NaN}function r(e){return 1===e.length&&(e=u(e)),{left:function(n,t,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=n.length);u>r;){var o=r+u>>>1;e(n[o],t)<0?r=o+1:u=o}return r},right:function(n,t,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=n.length);u>r;){var o=r+u>>>1;e(n[o],t)>0?u=o:r=o+1}return r}}}function u(e){return function(n,r){return t(e(n),r)}}function o(){}function i(e,n){var t=new o;if(e instanceof o)e.each(function(e,n){t.set(n,e)});else if(Array.isArray(e)){var r,u=-1,i=e.length;if(1===arguments.length)for(;++u<i;)t.set(u,e[u]);else for(;++u<i;)t.set(n.call(e,r=e[u],u),r)}else if(e)for(var a in e)t.set(a,e[a]);return t}function a(){return new s(arguments)}function s(e){function n(e){var n=(e+="").indexOf("."),t=e;if(n>=0?e=e.slice(0,n):t+=".",e&&!i.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}function t(e){return function(){for(var n,t,r=i[e],u=-1,o=r.length;++u<o;)(t=(n=r[u]).value)&&t.apply(this,arguments);return s}}var r,u=-1,o=e.length,i={},a={},s=this;for(s.on=function(e,t){if(e=n(e),arguments.length<2)return(t=a[e.name])&&t.value;if(e.type){var r,u=i[e.type],o=a[e.name];o&&(o.value=null,r=u.indexOf(o),i[e.type]=u=u.slice(0,r).concat(u.slice(r+1)),delete a[e.name]),t&&(t={value:t},a[e.name]=t,u.push(t))}else if(null==t)for(var c in i)if(t=a[c+e.name]){t.value=null;var u=i[c],r=u.indexOf(t);i[c]=u.slice(0,r).concat(u.slice(r+1)),delete a[t.name]}return s};++u<o;){if(r=e[u]+"",!r||r in s)throw new Error("illegal or duplicate type: "+r);i[r]=[],s[r]=t(r)}}function c(e,n){function t(){var e,n=h.status;if(!n&&l(h)||n>=200&&300>n||304===n){if(o)try{e=o.call(r,h)}catch(t){return void c.error.call(r,t)}else e=h;c.load.call(r,e)}else c.error.call(r,h)}var r,u,o,s,c=a("beforesend","progress","load","error"),p=i(),h=new XMLHttpRequest;return"undefined"==typeof XDomainRequest||"withCredentials"in h||!/^(http(s)?:)?\/\//.test(e)||(h=new XDomainRequest),"onload"in h?h.onload=h.onerror=t:h.onreadystatechange=function(){h.readyState>3&&t()},h.onprogress=function(e){c.progress.call(r,e)},r={header:function(e,n){return e=(e+"").toLowerCase(),arguments.length<2?p.get(e):(null==n?p.remove(e):p.set(e,n+""),r)},mimeType:function(e){return arguments.length?(u=null==e?null:e+"",r):u},responseType:function(e){return arguments.length?(s=e,r):s},response:function(e){return o=e,r},get:function(e,n){return r.send("GET",e,n)},post:function(e,n){return r.send("POST",e,n)},send:function(n,t,o){return o||"function"!=typeof t||(o=t,t=null),o&&1===o.length&&(o=f(o)),h.open(n,e,!0),null==u||p.has("accept")||p.set("accept",u+",*/*"),h.setRequestHeader&&p.each(function(e,n){h.setRequestHeader(n,e)}),null!=u&&h.overrideMimeType&&h.overrideMimeType(u),null!=s&&(h.responseType=s),o&&r.on("error",o).on("load",function(e){o(null,e)}),c.beforesend.call(r,h),h.send(null==t?null:t),r},abort:function(){return h.abort(),r},on:function(){var e=c.on.apply(c,arguments);return e===c?r:e}},n?r.get(n):r}function f(e){return function(n,t){e(null==n?t:null)}}function l(e){var n=e.responseType;return n&&"text"!==n?e.response:e.responseText}function p(e,n){return function(t,r){var u=c(t).mimeType(e).response(n);return r?u.get(r):u}}function h(e){function n(e,n){var r;return t(e,function(e,t){if(r)return r(e,t-1);var u=new Function("d","return {"+e.map(function(e,n){return JSON.stringify(e)+": d["+n+"]"}).join(",")+"}");r=n?function(e,t){return n(u(e),t)}:u})}function t(e,n){function t(){if(f>=c)return i;if(u)return u=!1,o;var n=f;if(34===e.charCodeAt(n)){for(var t=n;t++<c;)if(34===e.charCodeAt(t)){if(34!==e.charCodeAt(t+1))break;++t}f=t+2;var r=e.charCodeAt(t+1);return 13===r?(u=!0,10===e.charCodeAt(t+2)&&++f):10===r&&(u=!0),e.slice(n+1,t).replace(/""/g,'"')}for(;c>f;){var r=e.charCodeAt(f++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===e.charCodeAt(f)&&(++f,++a);else if(r!==s)continue;return e.slice(n,f-a)}return e.slice(n)}for(var r,u,o={},i={},a=[],c=e.length,f=0,l=0;(r=t())!==i;){for(var p=[];r!==o&&r!==i;)p.push(r),r=t();n&&null==(p=n(p,l++))||a.push(p)}return a}function r(n){if(Array.isArray(n[0]))return u(n);var t=Object.create(null),r=[];return n.forEach(function(e){for(var n in e)(n+="")in t||r.push(t[n]=n)}),[r.map(i).join(e)].concat(n.map(function(n){return r.map(function(e){return i(n[e])}).join(e)})).join("\n")}function u(e){return e.map(o).join("\n")}function o(n){return n.map(i).join(e)}function i(e){return a.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var a=new RegExp('["'+e+"\n]"),s=e.charCodeAt(0);return{parse:n,parseRows:t,format:r,formatRows:u}}function v(e,n){return function(t,r,u){arguments.length<3&&(u=r,r=null);var o=c(t).mimeType(e);return o.row=function(e){return arguments.length?o.response(m(n,r=e)):r},o.row(r),u?o.get(u):o}}function m(e,n){return function(t){return e.parse(t.responseText,n)}}var g=(r(t),"$");o.prototype=i.prototype={has:function(e){return g+e in this},get:function(e){return this[g+e]},set:function(e,n){return this[g+e]=n,this},remove:function(e){var n=g+e;return n in this&&delete this[n]},clear:function(){for(var e in this)e[0]===g&&delete this[e]},keys:function(){var e=[];for(var n in this)n[0]===g&&e.push(n.slice(1));return e},values:function(){var e=[];for(var n in this)n[0]===g&&e.push(this[n]);return e},entries:function(){var e=[];for(var n in this)n[0]===g&&e.push({key:n.slice(1),value:this[n]});return e},size:function(){var e=0;for(var n in this)n[0]===g&&++e;return e},empty:function(){for(var e in this)if(e[0]===g)return!1;return!0},each:function(e){for(var n in this)n[0]===g&&e.call(this,this[n],n.slice(1))}};i.prototype;a.prototype=s.prototype;var d=p("text/html",function(e){return document.createRange().createContextualFragment(e.responseText)}),y=p("application/json",function(e){return JSON.parse(e.responseText)}),x=p("text/plain",function(e){return e.responseText}),w=p("application/xml",function(e){return e.responseXML}),T=h(","),A=h("	"),C=v("text/csv",T),j=v("text/tab-separated-values",A);n.request=c,n.html=d,n.json=y,n.text=x,n.xml=w,n.csv=C,n.tsv=j,n.version="0.2.0","function"==typeof define&&define.amd?(e.request=n,define("request",[],function(){return n})):"object"==typeof module&&module.exports?module.exports=n:e.request=n}(this,{});