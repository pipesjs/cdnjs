/* Written by Erik Terwan - MIT license - https://github.com/terwanerik */
(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof module==="object"&&module.exports){module.exports=t()}else{e.ScrollTrigger=t()}})(this,function(){"use strict";return function(e,t,i){var n=function(e,t){this.element=t;this.defaultOptions=e;this.showCallback=null;this.hideCallback=null;this.visibleClass="visible";this.hiddenClass="invisible";this.addWidth=false;this.addHeight=false;this.once=false;var i=0;var n=0;this.left=function(e){return function(){return e.element.getBoundingClientRect().left}}(this);this.top=function(e){return function(){return e.element.getBoundingClientRect().top}}(this);this.xOffset=function(e){return function(t){var n=i;if(e.addWidth&&!t){n+=e.width()}else if(t&&!e.addWidth){n-=e.width()}return n}}(this);this.yOffset=function(e){return function(t){var i=n;if(e.addHeight&&!t){i+=e.height()}else if(t&&!e.addHeight){i-=e.height()}return i}}(this);this.width=function(e){return function(){return e.element.offsetWidth}}(this);this.height=function(e){return function(){return e.element.offsetHeight}}(this);this.addClass=function(e){var t=function(t,i){if(!e.element.classList.contains(t)){e.element.classList.add(t);if(typeof i==="function"){i()}}};var i=function(t,i){t=t.trim();var n=new RegExp("(?:^|\\s)"+t+"(?:(\\s\\w)|$)","ig");var l=e.element.className;if(!n.test(l)){e.element.className+=" "+t;if(typeof i==="function"){i()}}};return e.element.classList?t:i}(this);this.removeClass=function(e){var t=function(t,i){if(e.element.classList.contains(t)){e.element.classList.remove(t);if(typeof i==="function"){i()}}};var i=function(t,i){t=t.trim();var n=new RegExp("(?:^|\\s)"+t+"(?:(\\s\\w)|$)","ig");var l=e.element.className;if(n.test(l)){e.element.className=l.replace(n,"$1").trim();if(typeof i==="function"){i()}}};return e.element.classList?t:i}(this);this.init=function(e){return function(){var t=e.defaultOptions;var l=e.element.getAttribute("data-scroll");if(t){if(t.toggle&&t.toggle.visible){e.visibleClass=t.toggle.visible}if(t.toggle&&t.toggle.hidden){e.hiddenClass=t.toggle.hidden}if(t.centerHorizontal===true){i=e.element.offsetWidth/2}if(t.centerVertical===true){n=e.element.offsetHeight/2}if(t.offset&&t.offset.x){i+=t.offset.x}if(t.offset&&t.offset.y){n+=t.offset.y}if(t.addWidth){e.addWidth=t.addWidth}if(t.addHeight){e.addHeight=t.addHeight}if(t.once){e.once=t.once}}else{e.addWidth=l.indexOf("addWidth")>-1;e.addHeight=l.indexOf("addHeight")>-1;e.once=l.indexOf("once")>-1}e.showCallback=e.element.getAttribute("data-scroll-showCallback");e.hideCallback=e.element.getAttribute("data-scroll-hideCallback");var s=l.split("toggle(");if(s.length>1){var r=s[1].split(")")[0].split(",");if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}e.visibleClass=r[0].trim().replace(".","");e.hiddenClass=r[1].trim().replace(".","")}if(l.indexOf("centerHorizontal")>-1){i=e.element.offsetWidth/2}if(l.indexOf("centerVertical")>-1){n=e.element.offsetHeight/2}var f=l.split("offset(");if(f.length>1){var o=f[1].split(")")[0].split(",");i+=parseInt(o[0].replace("px",""));n+=parseInt(o[1].replace("px",""))}return e}}(this)};this.scrollElement=window;this.bindElement=document.body;var l=[];var s=[];var r={left:-1,top:-1};var f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){setTimeout(e,1e3/60)};var o=true;var a=function(e){return function(t,i,s){if(i!=undefined&&i!=null){e.bindElement=i}else{e.bindElement=document.body}if(s!=undefined&&s!=null){e.scrollElement=s}else{e.scrollElement=window}l=[].slice.call(e.bindElement.querySelectorAll("[data-scroll]"));l=l.map(function(e,i){var l=new n(t,e);return l.init()});if(l.length>0){o=true;c()}else{o=false}return e}}(this);this.attach=function(e){return function(t){s.push(t);if(!o){o=true;c()}return e}}(this);this.detach=function(e){return function(t){s.splice(s.indexOf(t),1);return e}}(this);var d=this;function c(){var e=d.scrollElement.innerWidth;var t=d.scrollElement.innerHeight;var i=!d.bindElement.scrollTop?document.documentElement.scrollTop:d.bindElement.scrollTop;var n=!d.bindElement.scrollLeft?document.documentElement.scrollLeft:d.bindElement.scrollLeft;if(r.left!=n||r.top!=i){for(var a=0;a<l.length;a++){var h=l[a];var m=h.left();var g=h.top();if(r.left>n){m-=h.xOffset(true)}else if(r.left<n){m+=h.xOffset(false)}if(r.top>i){g-=h.yOffset(true)}else if(r.top<i){g+=h.yOffset(false)}if(m<e&&m>=0&&g<t&&g>=0){h.addClass(h.visibleClass,function(){if(h.showCallback){u(h,h.showCallback)}});h.removeClass(h.hiddenClass);if(h.once){l.splice(a,1)}}else{h.addClass(h.hiddenClass);h.removeClass(h.visibleClass,function(){if(h.hideCallback){u(h,h.hideCallback)}})}}for(var v=0;v<s.length;v++){var p=s[v];p.call(d,n,i,e,t)}r.left=n;r.top=i}if(l.length>0||s.length>0){o=true;f(c)}else{o=false}}function u(e,t){var i=t.split("(");var n=i[0];if(i.length>1){i=i[1].split(")")[0]}else{i=undefined}if(window[n]){window[n].call(e.element,i)}}return a(e,t,i)}});
