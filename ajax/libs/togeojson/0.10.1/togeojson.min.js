toGeoJSON=function(){"use strict";function e(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function t(e,t){return e.getElementsByTagName(t)}function r(e,t){return e.getAttribute(t)}function n(e,t){return parseFloat(r(e,t))}function o(e,r){var n=t(e,r);return n.length?n[0]:null}function i(e){return e.normalize&&e.normalize(),e}function s(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function a(e){var t={};for(var r in e)e[r]&&(t[r]=e[r]);return t}function u(e){return e&&i(e),e&&e.firstChild&&e.firstChild.nodeValue||""}function l(e){return s(e.replace(m,"").split(","))}function c(e){for(var t=e.replace(d,"").split(y),r=[],n=0;n<t.length;n++)r.push(l(t[n]));return r}function f(e){var t=[n(e,"lon"),n(e,"lat")],r=o(e,"ele"),i=o(e,"time");return r&&t.push(parseFloat(u(r))),{coordinates:t,time:i?u(i):null}}function g(){return{type:"FeatureCollection",features:[]}}function p(e){return void 0!==e.xml?e.xml:h.serializeToString(e)}var h,m=/\s*/g,d=/^\s*|\s*$/g,y=/\s+/;return"undefined"!=typeof XMLSerializer?h=new XMLSerializer:"object"!=typeof exports||"object"!=typeof process||process.browser||(h=new(require("xmldom").XMLSerializer)),{kml:function(n){function i(e){var t,r;return e=e||"","#"===e.substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t=e.substr(2)),[t,isNaN(r)?void 0:r]}function a(e){return s(e.split(" "))}function f(e){var r=t(e,"coord","gx"),n=[],o=[];0===r.length&&(r=t(e,"gx:coord"));for(var i=0;i<r.length;i++)n.push(a(u(r[i])));for(var s=t(e,"when"),i=0;i<s.length;i++)o.push(u(s[i]));return{coords:n,times:o}}function h(e){var r,n,i,s,a,g=[],p=[];if(o(e,"MultiGeometry"))return h(o(e,"MultiGeometry"));if(o(e,"MultiTrack"))return h(o(e,"MultiTrack"));if(o(e,"gx:MultiTrack"))return h(o(e,"gx:MultiTrack"));for(i=0;i<y.length;i++)if(n=t(e,y[i]))for(s=0;s<n.length;s++)if(r=n[s],"Point"==y[i])g.push({type:"Point",coordinates:l(u(o(r,"coordinates")))});else if("LineString"==y[i])g.push({type:"LineString",coordinates:c(u(o(r,"coordinates")))});else if("Polygon"==y[i]){var m=t(r,"LinearRing"),d=[];for(a=0;a<m.length;a++)d.push(c(u(o(m[a],"coordinates"))));g.push({type:"Polygon",coordinates:d})}else if("Track"==y[i]||"gx:Track"==y[i]){var v=f(r);g.push({type:"LineString",coordinates:v.coords}),v.times.length&&p.push(v.times)}return{geoms:g,coordTimes:p}}for(var m=g(),d={},y=["Polygon","LineString","Point","Track","gx:Track"],v=t(n,"Placemark"),k=t(n,"Style"),S=0;S<k.length;S++)d["#"+r(k[S],"id")]=e(p(k[S])).toString(16);for(var T=0;T<v.length;T++)m.features=m.features.concat(function(e){var n,s=h(e),a={},l=u(o(e,"name")),c=u(o(e,"styleUrl")),f=u(o(e,"description")),g=o(e,"TimeSpan"),p=o(e,"ExtendedData"),m=o(e,"LineStyle"),y=o(e,"PolyStyle");if(!s.geoms.length)return[];if(l&&(a.name=l),c&&d[c]&&(a.styleUrl=c,a.styleHash=d[c]),f&&(a.description=f),g){var v=u(o(g,"begin")),k=u(o(g,"end"));a.timespan={begin:v,end:k}}if(m){var S=i(u(o(m,"color"))),T=S[0],x=S[1],b=parseFloat(u(o(m,"width")));T&&(a.stroke=T),isNaN(x)||(a["stroke-opacity"]=x),isNaN(b)||(a["stroke-width"]=b)}if(y){var L=i(u(o(y,"color"))),N=L[0],M=L[1],F=u(o(y,"fill")),P=u(o(y,"outline"));N&&(a.fill=N),isNaN(M)||(a["fill-opacity"]=M),F&&(a["fill-opacity"]="1"===F?1:0),P&&(a["stroke-opacity"]="1"===P?1:0)}if(p){var w=t(p,"Data"),z=t(p,"SimpleData");for(n=0;n<w.length;n++)a[w[n].getAttribute("name")]=u(o(w[n],"value"));for(n=0;n<z.length;n++)a[z[n].getAttribute("name")]=u(z[n])}s.coordTimes.length&&(a.coordTimes=1===s.coordTimes.length?s.coordTimes[0]:s.coordTimes);var C={type:"Feature",geometry:1===s.geoms.length?s.geoms[0]:{type:"GeometryCollection",geometries:s.geoms},properties:a};return r(e,"id")&&(C.id=r(e,"id")),[C]}(v[T]));return m},gpx:function(e){function r(e,r){var n=t(e,r),o=[],i=[],s=n.length;if(!(s<2)){for(var a=0;a<s;a++){var u=f(n[a]);o.push(u.coordinates),u.time&&i.push(u.time)}return{line:o,times:i}}}function n(e){var t,r=["name","desc","author","copyright","link","time","keywords"],n={};for(t=0;t<r.length;t++)n[r[t]]=u(o(e,r[t]));return a(n)}var i,s,l=t(e,"trk"),c=t(e,"rte"),p=t(e,"wpt"),h=g();for(i=0;i<l.length;i++)(s=function(e){for(var o,i=t(e,"trkseg"),s=[],a=[],u=0;u<i.length;u++)o=r(i[u],"trkpt"),o.line&&s.push(o.line),o.times.length&&a.push(o.times);if(0!==s.length){var l=n(e);return a.length&&(l.coordTimes=1===s.length?a[0]:a),{type:"Feature",properties:l,geometry:{type:1===s.length?"LineString":"MultiLineString",coordinates:1===s.length?s[0]:s}}}}(l[i]))&&h.features.push(s);for(i=0;i<c.length;i++)(s=function(e){var t=r(e,"rtept");if(t){var o={type:"Feature",properties:n(e),geometry:{type:"LineString",coordinates:t}};return t.times.length&&(o.geometry.times=t.times),o}}(c[i]))&&h.features.push(s);for(i=0;i<p.length;i++)h.features.push(function(e){var t=n(e);return t.sym=u(o(e,"sym")),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:f(e).coordinates}}}(p[i]));return h}}}(),"undefined"!=typeof module&&(module.exports=toGeoJSON);
//# sourceMappingURL=togeojson.min.js.map