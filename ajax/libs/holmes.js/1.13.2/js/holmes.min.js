!function(t,o){"use strict";"function"==typeof define&&define.amd?define([],function(){return t.holmes=o(document)}):"object"==typeof exports?module.exports=o(document):t.holmes=o(document)}(this,function(t){"use strict";function o(e){function p(){var e=!1;if(o.prototype.options.minCharacters){var p;if(o.prototype.input instanceof HTMLInputElement)p=o.prototype.input.value.toLowerCase().length;else{if(!o.prototype.input.contentEditable)throw new Error("The Holmes input was no <input> or contenteditable.");p=o.prototype.input.textContent.toLowerCase().length}if(o.prototype.options.minCharacters>p&&0!==p)return}if(o.prototype.searchString,o.prototype.input instanceof HTMLInputElement)o.prototype.searchString=o.prototype.input.value.toLowerCase();else{if(!o.prototype.input.contentEditable)throw new Error("The Holmes input was no <input> or contenteditable.");o.prototype.searchString=o.prototype.input.textContent.toLowerCase()}o.prototype.options.dynamic&&(o.prototype.elements=t.querySelectorAll(o.prototype.options.find),o.prototype.elementsLength=o.prototype.elements.length);var r,s=new RegExp("("+o.prototype.searchString+")(?![^<]*>)","gi");for(r=0;r<o.prototype.elementsLength;r++)-1===o.prototype.elements[r].textContent.toLowerCase().indexOf(o.prototype.searchString)?(o.prototype.options.class.visible&&o.prototype.elements[r].classList.remove(o.prototype.options.class.visible),o.prototype.elements[r].classList.contains(o.prototype.options.class.hidden)||(o.prototype.elements[r].classList.add(o.prototype.options.class.hidden),o.prototype.hidden++,"function"==typeof o.prototype.options.onHidden&&o.prototype.options.onHidden(o.prototype.elements[r]))):(o.prototype.options.class.visible&&o.prototype.elements[r].classList.add(o.prototype.options.class.visible),o.prototype.elements[r].classList.contains(o.prototype.options.class.hidden)&&(o.prototype.elements[r].classList.remove(o.prototype.options.class.hidden),o.prototype.hidden--,n&&"function"==typeof o.prototype.options.onFound&&o.prototype.options.onFound(o.prototype.placeholder),"function"==typeof o.prototype.options.onVisible&&o.prototype.options.onVisible(o.prototype.elements[r]),n=!1),o.prototype.options.mark&&(o.prototype.elements[r].innerHTML=o.prototype.elements[r].innerHTML.replace(/<\/?mark>/g,""),o.prototype.searchString.length&&(o.prototype.elements[r].innerHTML=o.prototype.elements[r].innerHTML.replace(s,"<mark>$1</mark>"))),e=!0);"function"==typeof o.prototype.options.onInput&&o.prototype.options.onInput(o.prototype.searchString),e||n?n||o.prototype.options.placeholder&&o.prototype.placeholder.classList.add(o.prototype.options.class.hidden):(n=!0,o.prototype.options.placeholder&&o.prototype.placeholder.classList.remove(o.prototype.options.class.hidden),"function"==typeof o.prototype.options.onEmpty&&o.prototype.options.onEmpty(o.prototype.placeholder))}var n=!1;if("object"!=typeof e)throw new Error('The options need to be given inside an object like this:\nholmes({\n\tfind:".result",\n\tdynamic:false\n});\n see also https://haroen.me/holmes/doc/module-holmes.html');if(o.prototype.options=e,void 0===o.prototype.options.find)throw new Error('A find argument is needed. That should be a querySelectorAll for each of the items you want to match individually. You should have something like: \nholmes({\n\tfind:".result"\n});\nsee also https://haroen.me/holmes/doc/module-holmes.html');o.prototype.start=function(){if(void 0===o.prototype.options.input&&(o.prototype.options.input="input[type=search]"),void 0===o.prototype.options.placeholder&&(o.prototype.options.placeholder=!1),void 0===o.prototype.options.mark&&(o.prototype.options.mark=!1),void 0===o.prototype.options.class&&(o.prototype.options.class={}),void 0===o.prototype.options.class.visible&&(o.prototype.options.class.visible=!1),void 0===o.prototype.options.class.hidden&&(o.prototype.options.class.hidden="hidden"),void 0===o.prototype.options.dynamic&&(o.prototype.options.dynamic=!1),void 0===o.prototype.options.minCharacters&&(o.prototype.options.minCharacters=0),o.prototype.input=t.querySelector(o.prototype.options.input),o.prototype.elements=t.querySelectorAll(o.prototype.options.find),o.prototype.elementsLength=o.prototype.elements.length,o.prototype.hidden=0,o.prototype.options.placeholder){if(o.prototype.placeholder=t.createElement("div"),o.prototype.placeholder.id="holmes-placeholder",o.prototype.placeholder.classList.add(o.prototype.options.class.hidden),o.prototype.placeholder.innerHTML=o.prototype.options.placeholder,!o.prototype.elements[0].parentNode)throw new Error("The Holmes placeholder could't be put; the elements had no parent.");o.prototype.elements[0].parentNode.appendChild(o.prototype.placeholder)}if(o.prototype.options.class.visible){var e;for(e=0;e<o.prototype.elementsLength;e++)o.prototype.elements[e].classList.add(o.prototype.options.class.visible)}o.prototype.input.addEventListener("input",p)},void 0===o.prototype.options.instant&&(o.prototype.options.instant=!1),o.prototype.options.instant?o.prototype.start():window.addEventListener("DOMContentLoaded",o.prototype.start),o.prototype.stop=function(){return new Promise(function(t,e){if(o.prototype.input.removeEventListener("input",p),!o.prototype.placeholder.parentNode)throw new Error("The Holmes placeholder has no parent.");if(o.prototype.placeholder.parentNode.removeChild(o.prototype.placeholder),o.prototype.options.mark){var n;for(n=0;n<o.prototype.elementsLength;n++)o.prototype.elements[n].innerHTML=o.prototype.elements[n].innerHTML.replace(/<\/?mark>/g,"")}t("This instance of Holmes has been stopped.")})},o.prototype.clear=function(){if(console.log(o.prototype.input),o.prototype.input instanceof HTMLInputElement)o.prototype.input.value="";else{if(!o.prototype.input.contentEditable)throw new Error("The Holmes input was no <input> or contenteditable.");o.prototype.input.textContent=""}if(o.prototype.options.class.visible)for(var t=0;t<o.prototype.elementsLength;t++)o.prototype.elements[t].classList.remove(o.prototype.options.class.hidden),o.prototype.elements[t].classList.add(o.prototype.options.class.visible);else for(var t=0;t<o.prototype.elementsLength;t++)o.prototype.elements[t].classList.remove(o.prototype.options.class.hidden);o.prototype.options.placeholder&&(o.prototype.placeholder.classList.add(o.prototype.options.class.hidden),o.prototype.options.class.visible&&o.prototype.placeholder.classList.remove(o.prototype.options.class.visible)),o.prototype.hidden=0},o.prototype.count=function(){return{all:o.prototype.elementsLength,hidden:o.prototype.hidden,visible:o.prototype.elementsLength-o.prototype.hidden}}}return o});