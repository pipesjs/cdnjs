!function(o,t){"use strict";"function"==typeof define&&define.amd?define([],function(){return o.holmes=t(document)}):"object"==typeof exports?module.exports=t(document):o.holmes=t(document)}(this,function(o){"use strict";function t(e){function p(){if(t.prototype.input instanceof HTMLInputElement)return t.prototype.input.value.toLowerCase();if(t.prototype.input.contentEditable)return t.prototype.input.textContent.toLowerCase();throw new Error("The Holmes input was no <input> or contenteditable.")}function n(o){t.prototype.options.class.visible&&o.classList.remove(t.prototype.options.class.visible),o.classList.contains(t.prototype.options.class.hidden)||(o.classList.add(t.prototype.options.class.hidden),t.prototype.hidden++,"function"==typeof t.prototype.options.onHidden&&t.prototype.options.onHidden(o)),t.prototype.options.mark&&(o.innerHTML=o.innerHTML.replace(/<\/?mark>/g,""))}function r(o){t.prototype.options.class.visible&&o.classList.add(t.prototype.options.class.visible),o.classList.contains(t.prototype.options.class.hidden)&&(o.classList.remove(t.prototype.options.class.hidden),t.prototype.hidden--,"function"==typeof t.prototype.options.onVisible&&t.prototype.options.onVisible(o)),t.prototype.options.mark&&(o.innerHTML=o.innerHTML.replace(/<\/?mark>/g,""),t.prototype.searchString.length&&(o.innerHTML=o.innerHTML.replace(t.prototype.regex,"<mark>$1</mark>")))}function i(){var e=!1;t.prototype.searchString=p(),t.prototype.options.minCharacters&&0!==t.prototype.searchString.length&&t.prototype.options.minCharacters>t.prototype.searchString.length||(t.prototype.options.dynamic&&(t.prototype.elements=o.querySelectorAll(t.prototype.options.find),t.prototype.elementsLength=t.prototype.elements.length,t.prototype.elementsArray=Array.prototype.slice.call(t.prototype.elements)),t.prototype.options.mark&&(t.prototype.regex=new RegExp("("+t.prototype.searchString+")(?![^<]*>)","gi")),t.prototype.elementsArray.forEach(function(o){-1===o.textContent.toLowerCase().indexOf(t.prototype.searchString)?n(o):(r(o),s&&"function"==typeof t.prototype.options.onFound&&t.prototype.options.onFound(t.prototype.placeholderNode),s=!1,e=!0)}),"function"==typeof t.prototype.options.onInput&&t.prototype.options.onInput(t.prototype.searchString),e||s?s||t.prototype.options.placeholder&&t.prototype.placeholderNode.classList.add(t.prototype.options.class.hidden):(s=!0,t.prototype.options.placeholder&&t.prototype.placeholderNode.classList.remove(t.prototype.options.class.hidden),"function"==typeof t.prototype.options.onEmpty&&t.prototype.options.onEmpty(t.prototype.placeholderNode)))}var s=!1;if("object"!=typeof e)throw new Error('The options need to be given inside an object like this:\nholmes({\n\tfind:".result"\n});\nsee also https://haroen.me/holmes/doc/module-holmes.html');if("string"!=typeof e.find)throw new Error('A find argument is needed. That should be a querySelectorAll for each of the items you want to match individually. You should have something like: \nholmes({\n\tfind:".result"\n});\nsee also https://haroen.me/holmes/doc/module-holmes.html');t.prototype.options={input:"input[type=search]",find:void 0,placeholder:void 0,mark:!1,class:{visible:void 0,hidden:"hidden"},dynamic:!1,instant:!1,minCharacters:0,onHidden:void 0,onVisible:void 0,onEmpty:void 0,onFound:void 0,onInput:void 0},t.prototype._mergeObj=function(o,e){if(!(o instanceof Object&&e instanceof Object))throw new Error("One of both arguments isn't an object.");Object.keys(o).forEach(function(p){typeof e[p]!=typeof o[p]&&void 0!==o[p]||(e[p]instanceof Object?t.prototype._mergeObj(o[p],e[p]):o[p]=e[p])})},t.prototype._mergeObj(t.prototype.options,e),t.prototype.start=function(){if(t.prototype.running=!0,t.prototype.input=o.querySelector(t.prototype.options.input),!t.prototype.options.find)throw new Error('A find argument is needed. That should be a querySelectorAll for each of the items you want to match individually. You should have something like: \nholmes({\n\tfind:".result"\n});\nsee also https://haroen.me/holmes/doc/module-holmes.html');if(t.prototype.elements=o.querySelectorAll(t.prototype.options.find),t.prototype.elementsLength=t.prototype.elements.length,t.prototype.elementsArray=Array.prototype.slice.call(t.prototype.elements),t.prototype.hidden=0,t.prototype.options.placeholder){if(t.prototype.placeholderNode=o.createElement("div"),t.prototype.placeholderNode.id="holmes-placeholder",t.prototype.placeholderNode.classList.add(t.prototype.options.class.hidden),t.prototype.placeholderNode.innerHTML=t.prototype.options.placeholder,!(t.prototype.elements[0].parentNode instanceof Element))throw new Error("The Holmes placeholder could't be put; the elements had no parent.");t.prototype.elements[0].parentNode.appendChild(t.prototype.placeholderNode)}t.prototype.options.class.visible&&t.prototype.elementsArray.forEach(function(o){o.classList.add(t.prototype.options.class.visible)}),t.prototype.input.addEventListener("input",i)},p.prototype.set=function(o){if(t.prototype.input instanceof HTMLInputElement)t.prototype.input.value=o;else{if(!t.prototype.input.contentEditable)throw new Error("The Holmes input was no <input> or contenteditable.");t.prototype.input.textContent=o}},"boolean"!=typeof t.prototype.options.instant&&(t.prototype.options.instant=!1),t.prototype.options.instant?t.prototype.start(e):window.addEventListener("DOMContentLoaded",function(){t.prototype.start(e)}),t.prototype.stop=function(){return new Promise(function(o,e){try{if(t.prototype.input.removeEventListener("input",i),t.prototype.options.placeholder){if(!t.prototype.placeholderNode.parentNode)throw new Error("The Holmes placeholderNode has no parent.");t.prototype.placeholderNode.parentNode.removeChild(t.prototype.placeholderNode)}t.prototype.options.mark&&t.prototype.elementsArray.forEach(function(o){o.innerHTML=o.innerHTML.replace(/<\/?mark>/g,"")}),t.prototype.running=!1,o("This instance of Holmes has been stopped.")}catch(o){e(o)}})},t.prototype.clear=function(){p.prototype.set(""),t.prototype.options.class.visible?t.prototype.elementsArray.forEach(function(o){o.classList.remove(t.prototype.options.class.hidden),o.classList.add(t.prototype.options.class.visible)}):t.prototype.elementsArray.forEach(function(o){o.classList.remove(t.prototype.options.class.hidden)}),t.prototype.options.placeholder&&(t.prototype.placeholderNode.classList.add(t.prototype.options.class.hidden),t.prototype.options.class.visible&&t.prototype.placeholderNode.classList.remove(t.prototype.options.class.visible)),t.prototype.hidden=0},t.prototype.count=function(){return{all:t.prototype.elementsLength,hidden:t.prototype.hidden,visible:t.prototype.elementsLength-t.prototype.hidden}}}return t});