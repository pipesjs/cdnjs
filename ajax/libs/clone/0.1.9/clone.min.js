"use strict";function objectToString(e){return Object.prototype.toString.call(e)}function clone(e,t){function r(e,t,o,l){var c;if("object"==typeof e){if(null==e)return e;for(c in n)if(n[c]===e)return u.push({resolveTo:c,child:o,i:l}),null;if(n[t]=e,util.isArray(e)){o=[];for(c in e)o[c]=r(e[c],t+"["+c+"]",o,c)}else if(util.isDate(e))o=new Date(e.getTime());else if(util.isRegExp(e))o=new RegExp(e.source);else if(i&&Buffer.isBuffer(e))o=new Buffer(e.length),e.copy(o);else{o={},o.__proto__=e.__proto__;for(c in e)o[c]=r(e[c],t+"["+c+"]",o,c)}f[t]=o}else o=e;return o}void 0===t&&(t=!0);var o,i="undefined"!=typeof Buffer,n={},f={},u=[];if(t){var l=r(e,"*");for(o in u){var c=u[o];c&&c.child&&c.i in c.child&&(c.child[c.i]=f[c.resolveTo])}return l}var s;if("object"==typeof e){if(null==e)return e;if("Array"===e.constructor.name){s=[];for(o in e)s[o]=clone(e[o],t)}else if(util.isDate(e))s=new Date(e.getTime());else if(util.isRegExp(e))s=new RegExp(e.source);else{s={},s.__proto__=e.__proto__;for(o in e)s[o]=clone(e[o],t)}}else s=e;return s}var util={isArray:function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===objectToString(e)},isDate:function(e){return"object"==typeof e&&"[object Date]"===objectToString(e)},isRegExp:function(e){return"object"==typeof e&&"[object RegExp]"===objectToString(e)}};module.exports=clone,clone.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t};