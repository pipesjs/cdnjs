!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e["vue-ls"]=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e){function t(t){var n=JSON.parse(e.newValue),r=JSON.parse(e.oldValue),i="object"===("undefined"==typeof n?"undefined":o(n))?n.value:r,a=r&&"object"===("undefined"==typeof r?"undefined":o(r))?r.value:r;t(i,a,e.url||e.uri)}e||(e=window.event);var n=r[e.key];n&&n.forEach(t)}var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={};try{var i=window.localStorage,a="__storage_test__";i.setItem(a,a),i.removeItem(a)}catch(e){throw new Error("Local storage not supported by this browser")}var u=function(){function o(){e(this,o),this.storage=window.localStorage,window.addEventListener?window.addEventListener("storage",t,!1):window.attachEvent?window.attachEvent("onstorage",t):window.onstorage=t,Object.defineProperty(this,"length",{get:function(){return this.storage.length}})}return n(o,[{key:"install",value:function(e,t){this.options=Object.assign({namespace:""},t||{});var n=this;e.localStorage=n,Object.defineProperty(e.prototype,"$localStorage",{get:function(){return n}})}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.storage.setItem(this.options.namespace+e,JSON.stringify({value:t,expire:null!==n?(new Date).getTime()+n:null}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.storage.getItem(this.options.namespace+e);if(null!==n){var o=JSON.parse(n);if(null===o.expire)return o.value;if(o.expire>=(new Date).getTime())return o.value;this.remove(e)}return t}},{key:"key",value:function(e){return this.storage.key(e)}},{key:"remove",value:function(e){return this.storage.removeItem(this.options.namespace+e)}},{key:"clear",value:function(){if(0!==this.length)for(var e=0;e<this.length;e++){var t=this.storage.key(e),n=new RegExp("^"+this.options.namespace+".+","i");n.test(t)!==!1&&this.storage.removeItem(t)}}},{key:"on",value:function(e,t){r[e]?r[e].push(t):r[e]=[t]}},{key:"off",value:function(e,t){var n=r[e];n.length>1?n.splice(n.indexOf(t),1):r[e]=[]}}]),o}();return"undefined"!=typeof window&&"undefined"!=typeof window.Vue&&window.Vue.use(new u),u});
