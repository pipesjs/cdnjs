"undefined"==typeof Map&&(Map=function(){this.clear()},Map.prototype={set:function(t,e){return this._[t]=e,this},get:function(t){return this._[t]},has:function(t){return t in this._},"delete":function(t){return t in this._&&delete this._[t]},clear:function(){this._=Object.create(null)},get size(){var t=0;for(var e in this._)++t;return t},forEach:function(t){for(var e in this._)t(this._[e],e,this)}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.dispatch=e()}(this,function(){"use strict";function t(){this.listeners=[],this.listenerByName=new Map}function e(e){function n(t){return function(){return t.dispatch(this,arguments),c}}var i,r,s=-1,o=e.length,u=new Map,c=this;for(c.on=function(t,e){var n=(t+="").indexOf("."),i="";return n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t?(t=u.get(t),arguments.length<2?t.on(i):(t.on(i,e),c)):2===arguments.length?(null==e&&u.forEach(function(t){t.on(i,null)}),c):void 0};++s<o;){if(r=e[s]+"",r in c)throw new Error("illegal or duplicate type: "+r);i=new t,u.set(r,i),c[r]=n(i)}}t.prototype={dispatch:function(t,e){for(var n,i=this.listeners,r=-1,s=i.length;++r<s;)(n=i[r].value)&&n.apply(t,e)},on:function(t,e){var n,i=this.listeners,r=this.listenerByName,s=r.get(t+="");return arguments.length<2?s&&s.value:(s&&(s.value=null,this.listeners=i=i.slice(0,n=i.indexOf(s)).concat(i.slice(n+1)),r["delete"](t)),void(e&&(e={value:e},r.set(t,e),i.push(e))))}};var n=function(){return new e(arguments)},i=n;return i});