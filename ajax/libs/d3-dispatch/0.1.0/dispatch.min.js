!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.dispatch=n()}(this,function(){"use strict";function e(e){function n(e){var n=(e+="").indexOf("."),t=e;if(n>=0?e=e.slice(0,n):t+=".",e&&!u.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}function t(e){return function(){for(var n,t,r=u[e],i=-1,o=r.length;++i<o;)(t=(n=r[i]).value)&&t.apply(this,arguments);return l}}var r,i=-1,o=e.length,u={},a={},l=this;for(l.on=function(e,t){if(e=n(e),arguments.length<2)return(t=a[e.name])&&t.value;if(e.type){var r,i=u[e.type],o=a[e.name];o&&(o.value=null,r=i.indexOf(o),u[e.type]=i=i.slice(0,r).concat(i.slice(r+1)),delete a[e.name]),t&&(t={value:t},a[e.name]=t,i.push(t))}else if(null==t)for(var f in u)if(t=a[f+e.name]){t.value=null;var i=u[f],r=i.indexOf(t);u[f]=i.slice(0,r).concat(i.slice(r+1)),delete a[t.name]}return l};++i<o;){if(r=e[i]+"",!r||r in l)throw new Error("illegal or duplicate type: "+r);u[r]=[],l[r]=t(r)}}function n(){return new e(arguments)}n.prototype=e.prototype;var t=n;return t});