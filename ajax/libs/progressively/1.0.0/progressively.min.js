!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a)}):"object"==typeof exports?module.exports=b:a.progressively=b(a)}(this,function(a){"use strict";function b(a,b){var c={};for(var d in a)c[d]=b.hasOwnProperty(d)?b[d]:a[d];return c}function c(a){return null===a.offsetParent}function d(a,b){if(c(a))return!1;var d=a.getBoundingClientRect();return d.top>=0&&d.left>=0&&d.bottom<=(window.innerHeight||document.el.clientHeight)&&d.right<=(window.innerWidth||document.el.clientWidth)}function e(a){setTimeout(function(){var b=new Image;b.onload=function(){a.src=this.src,a.classList.remove("progressive--not-loaded"),a.classList.add("progressive--is-loaded"),i(a),j.check()},b.src=a.dataset.progressive},g.delay)}function f(){h||(clearTimeout(h),h=setTimeout(function(){j.render(),h=null},g.throttle))}var g,h,i,j={};return i=function(){},g={throttle:300,delay:100,afterload:function(){},imgload:function(){}},j.init=function(c){c=c||{},g=b(g,c),i=g.imgload||i,j.render(),document.addEventListener?(a.addEventListener("scroll",f,!1),a.addEventListener("load",f,!1)):(a.attachEvent("onscroll",f),a.attachEvent("onload",f))},j.render=function(){for(var a,b=document.querySelectorAll(".progressive__img"),c=document.querySelectorAll(".progressive"),f=b.length-1;f>=0;--f)a=b[f],d(a)&&a.classList.contains("progressive--not-loaded")&&e(a);b.length&&c.length||this.drop()},j.check=function(){for(var a=0,b=document.querySelectorAll(".progressive__img"),c=b.length-1;c>=0;--c)b[c].classList.contains("progressive--is-loaded")&&a++;a===b.length-1&&g.afterload()},j.drop=function(){document.removeEventListener?a.removeEventListener("scroll",f):a.detachEvent("onscroll",f),clearTimeout(h)},j});