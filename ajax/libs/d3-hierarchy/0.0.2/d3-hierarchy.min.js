!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define("d3-hierarchy",["exports"],r):r(n.d3_hierarchy={})}(this,function(n){"use strict";function r(){return function(n){for(var r,t=-1,u=n.length,a=new Array(u);++t<u;)r=n[t],a[t]=e(r.source,r.end);return a}}function e(n,r){for(var e=u(n,r),t=[n];n!==e;)n=n.parent,t.push(n);for(var a=t.length;r!==e;)t.splice(a,0,r),r=r.parent;return t}function t(n){for(var r=[],e=n.parent;null!=e;)r.push(n),n=e,e=e.parent;return r.push(n),r}function u(n,r){if(n===r)return n;var e=t(n),u=t(r),a=null;for(n=e.pop(),r=u.pop();n===r;)a=n,n=e.pop(),r=u.pop();return a}function a(n,r){for(var e=[n];null!=(n=e.pop());)if(r(n),(u=n.children)&&(t=u.length))for(var t,u;--t>=0;)e.push(u[t])}function l(n,r){for(var e=[n],t=[];null!=(n=e.pop());)if(t.push(n),(a=n.children)&&(u=a.length))for(var u,a,l=-1;++l<u;)e.push(a[l]);for(;null!=(n=t.pop());)r(n)}function i(n){var r=[];return n.forEach(function(n){n.children&&n.children.forEach(function(e){r.push({source:n,target:e})})}),r}function c(n){return n.children}function o(n){return n.value}function f(n,r){return r.value-n.value}function h(n,r){return n.sort=function(){var e=r.sort.apply(r,arguments);return e===r?n:e},n.children=function(){var e=r.children.apply(r,arguments);return e===r?n:e},n.value=function(){var e=r.value.apply(r,arguments);return e===r?n:e},n.nodes=n,n.links=i,n}function d(){function n(u){var a,i=[u],c=[];for(u.parent=null,u.depth=0;null!=(a=i.pop());)if(c.push(a),(f=e.call(n,a,a.depth))&&(o=f.length)){for(var o,f,h;--o>=0;)i.push(h=f[o]),h.parent=a,h.depth=a.depth+1;t&&(a.value=0),a.children=f}else t&&(a.value=+t.call(n,a,a.depth)||0),delete a.children;return l(u,function(n){var e,u;r&&(e=n.children)&&e.sort(r),t&&(u=n.parent)&&(u.value+=n.value)}),c}var r=f,e=c,t=o;return n.nodes=n,n.links=i,n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(r){return arguments.length?(e=r,n):e},n.value=function(r){return arguments.length?(t=r,n):t},n.revalue=function(r){return t&&(a(r,function(n){n.children&&(n.value=0)}),l(r,function(r){var e;r.children||(r.value=+t.call(n,r,r.depth)||0),(e=r.parent)&&(e.value+=r.value)})),r},n}function p(n,r){return n.parent===r.parent?1:2}function v(n){var r=n.children;return r.length?r[0]:n.t}function s(n){var r,e=n.children;return(r=e.length)?e[r-1]:n.t}function x(n,r,e){var t=e/(r.i-n.i);r.c-=t,r.s+=e,n.c+=t,r.z+=e,r.m+=e}function y(n){for(var r,e=0,t=0,u=n.children,a=u.length;--a>=0;)r=u[a],r.z+=e,r.m+=e,e+=r.s+(t+=r.c)}function g(n,r,e){return n.a.parent===r.parent?n.a:e}function m(){function n(n,u){var h=c.call(this,n,u),d=h[0],p=r(d);if(l(p,e),p.parent.m=-p.z,a(p,t),m)a(d,i);else{var v=d,s=d,x=d;a(d,function(n){n.x<v.x&&(v=n),n.x>s.x&&(s=n),n.depth>x.depth&&(x=n)});var y=o(v,s)/2-v.x,g=f[0]/(s.x+o(s,v)/2+y),_=f[1]/(x.depth||1);a(d,function(n){n.x=(n.x+y)*g,n.y=n.depth*_})}return h}function r(n){for(var r,e={A:null,children:[n]},t=[e];null!=(r=t.pop());)for(var u,a=r.children,l=0,i=a.length;i>l;++l)t.push((a[l]=u={_:a[l],parent:r,children:(u=a[l].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=u);return e.children[0]}function e(n){var r=n.children,e=n.parent.children,t=n.i?e[n.i-1]:null;if(r.length){y(n);var a=(r[0].z+r[r.length-1].z)/2;t?(n.z=t.z+o(n._,t._),n.m=n.z-a):n.z=a}else t&&(n.z=t.z+o(n._,t._));n.parent.A=u(n,t,n.parent.A||e[0])}function t(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,r,e){if(r){for(var t,u=n,a=n,l=r,i=u.parent.children[0],c=u.m,f=a.m,h=l.m,d=i.m;l=s(l),u=v(u),l&&u;)i=v(i),a=s(a),a.a=n,t=l.z+h-u.z-c+o(l._,u._),t>0&&(x(g(l,n,e),n,t),c+=t,f+=t),h+=l.m,c+=u.m,d+=i.m,f+=a.m;l&&!s(a)&&(a.t=l,a.m+=h-f),u&&!v(i)&&(i.t=u,i.m+=c-d,e=n)}return e}function i(n){n.x*=f[0],n.y=n.depth*f[1]}var c=d().sort(null).value(null),o=p,f=[1,1],m=null;return n.separation=function(r){return arguments.length?(o=r,n):o},n.size=function(r){return arguments.length?(m=null==(f=r)?i:null,n):m?null:f},n.nodeSize=function(r){return arguments.length?(m=null==(f=r)?null:i,n):m?f:null},h(n,c)}function _(n){return n.reduce(function(n,r){return n+r.x},0)/n.length}function k(n){return 1+n.reduce(function(n,r){return Math.max(n,r.y)},0)}function z(n){for(var r;(r=n.children)&&r.length;)n=r[0];return n}function M(n){for(var r,e;(r=n.children)&&(e=r.length);)n=r[e-1];return n}function b(){function n(n,a){var i,c=r.call(this,n,a),o=c[0],f=0;l(o,function(n){var r=n.children;r&&r.length?(n.x=_(r),n.y=k(r)):(n.x=i?f+=e(n,i):0,n.y=0,i=n)});var h=z(o),d=M(o),p=h.x-e(h,d)/2,v=d.x+e(d,h)/2;return l(o,u?function(n){n.x=(n.x-o.x)*t[0],n.y=(o.y-n.y)*t[1]}:function(n){n.x=(n.x-p)/(v-p)*t[0],n.y=(1-(o.y?n.y/o.y:1))*t[1]}),c}var r=d().sort(null).value(null),e=p,t=[1,1],u=!1;return n.separation=function(r){return arguments.length?(e=r,n):e},n.size=function(r){return arguments.length?(u=null==(t=r),n):u?null:t},n.nodeSize=function(r){return arguments.length?(u=null!=(t=r),n):u?t:null},h(n,r)}function q(n){return E(A(n),[])}function A(n){for(var r,e=(n=n.slice()).length,t=null,u=t;e;){var a={id:n.length-e,value:n[e-1],next:null};u=u?u.next=a:t=a,n[r]=n[--e]}return{head:t,tail:u}}function E(n,r){var e,t,u,a=null,l=n.head;switch(r.length){case 1:e=r[0];break;case 2:e=w(r[0],r[1]);break;case 3:e=S(r[0],r[1],r[2])}for(;l;)u=l.value,t=l.next,e&&N(e,u)?a=l:(a?(n.tail=a,a.next=null):n.head=n.tail=null,r.push(u),e=E(n,r),r.pop(),n.head?(l.next=n.head,n.head=l):(l.next=null,n.head=n.tail=l),a=n.tail,a.next=t),l=t;return n.tail=a,e}function N(n,r){var e=n.x-r.x,t=n.y-r.y;return Math.sqrt(e*e+t*t)<n.r-r.r+1e-6}function w(n,r){var e=n.x,t=n.y,u=n.r,a=r.x,l=r.y,i=r.r,c=a-e,o=l-t,f=i-u,h=Math.sqrt(c*c+o*o);return{x:(e+a+c/h*f)/2,y:(t+l+o/h*f)/2,r:(h+u+i)/2}}function S(n,r,e){var t=n.x,u=n.y,a=n.r,l=r.x,i=r.y,c=r.r,o=e.x,f=e.y,h=e.r,d=2*(t-l),p=2*(u-i),v=2*(c-a),s=t*t+u*u-a*a-l*l-i*i+c*c,x=2*(t-o),y=2*(u-f),g=2*(h-a),m=t*t+u*u-a*a-o*o-f*f+h*h,_=x*p-d*y,k=(p*m-y*s)/_-t,z=(y*v-p*g)/_,M=(x*s-d*m)/_-u,b=(d*g-x*v)/_,q=z*z+b*b-1,A=2*(k*z+M*b+a),E=k*k+M*M-a*a,N=(-A-Math.sqrt(A*A-4*q*E))/(2*q);return{x:k+z*N+t,y:M+b*N+u,r:N}}function j(n,r){return n.value-r.value}function O(n,r){var e=n._pack_next;n._pack_next=r,r._pack_prev=n,r._pack_next=e,e._pack_prev=r}function P(n,r){n._pack_next=r,r._pack_prev=n}function B(n,r){var e=r.x-n.x,t=r.y-n.y,u=n.r+r.r;return.999*u*u>e*e+t*t}function C(n){if((r=n.children)&&(c=r.length)){var r,e,t,u,a,l,i,c;if(r.forEach(D),e=r[0],e.x=-e.r,e.y=0,c>1&&(t=r[1],t.x=t.r,t.y=0,c>2))for(u=r[2],H(e,t,u),O(e,u),e._pack_prev=u,O(u,t),t=e._pack_next,a=3;c>a;a++){H(e,t,u=r[a]);var o=0,f=1,h=1;for(l=t._pack_next;l!==t;l=l._pack_next,f++)if(B(l,u)){o=1;break}if(1==o)for(i=e._pack_prev;i!==l._pack_prev&&!B(i,u);i=i._pack_prev,h++);o?(h>f||f==h&&t.r<e.r?P(e,t=l):P(e=i,t),a--):(O(e,u),t=u)}var u=q(r);for(a=0;c>a;++a)e=r[a],e.x-=u.x,e.y-=u.y;n.r=u.r,r.forEach(F)}}function D(n){n._pack_next=n._pack_prev=n}function F(n){delete n._pack_next,delete n._pack_prev}function G(n,r,e,t){var u=n.children;if(n.x=r+=t*n.x,n.y=e+=t*n.y,n.r*=t,u)for(var a=-1,l=u.length;++a<l;)G(u[a],r,e,t)}function H(n,r,e){var t=n.r+e.r,u=r.x-n.x,a=r.y-n.y;if(t&&(u||a)){var l=r.r+e.r,i=u*u+a*a;l*=l,t*=t;var c=.5+(t-l)/(2*i),o=Math.sqrt(Math.max(0,2*l*(t+i)-(t-=i)*t-l*l))/(2*i);e.x=n.x+c*u+o*a,e.y=n.y+c*a-o*u}else e.x=n.x+t,e.y=n.y}function I(){function n(n,a){var i=e.call(this,n,a),c=i[0],o=u[0],f=u[1],h=null==r?Math.sqrt:"function"==typeof r?r:function(){return r};if(c.x=c.y=0,l(c,function(n){n.r=+h(n.value)}),l(c,C),t){var d=t*(r?1:Math.max(2*c.r/o,2*c.r/f))/2;l(c,function(n){n.r+=d}),l(c,C),l(c,function(n){n.r-=d})}return G(c,o/2,f/2,r?1:1/Math.max(2*c.r/o,2*c.r/f)),i}var r,e=d().sort(j),t=0,u=[1,1];return n.size=function(r){return arguments.length?(u=[+r[0],+r[1]],n):u.slice()},n.radius=function(e){return arguments.length?(r=null==e||"function"==typeof e?e:+e,n):r},n.padding=function(r){return arguments.length?(t=+r,n):t},h(n,e)}function J(n){var r,e,t=n.children,u=0;if(t)for(r=0,e=t.length;e>r;++r)u=Math.max(u,J(t[r]));return 1+u}function K(n,r,e,t){var u=n.children;if(n.x=r,n.y=n.depth*t,n.dx=e,n.dy=t,u&&(a=u.length)){var a,l,i,c=-1;for(e=n.value?e/n.value:0;++c<a;)K(l=u[c],r,i=l.value*e,t),r+=i}}function L(){function n(n,t){var u=r.call(this,n,t);return K(u[0],0,e[0],e[1]/J(u[0])),u}var r=d(),e=[1,1];return n.size=function(r){return arguments.length?(e=[+r[0],+r[1]],n):e.slice()},h(n,r)}function Q(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function R(n,r){var e=n.x+r[3],t=n.y+r[0],u=n.dx-r[1]-r[3],a=n.dy-r[0]-r[2];return 0>u&&(e+=u/2,u=0),0>a&&(t+=a/2,a=0),{x:e,y:t,dx:u,dy:a}}function T(){function n(n){var r=v.call(i,n,n.depth);return null==r?Q(n):R(n,"number"==typeof r?[r,r,r,r]:r)}function r(n){return R(n,v)}function e(n,r){for(var e,t,u=-1,a=n.length;++u<a;)t=(e=n[u]).value*(0>r?0:r),e.area=isNaN(t)||0>=t?0:t}function t(n){var r=n.children;if(r&&r.length){var u,i,c,o=s(n),f=[],h=r.slice(),d=1/0,p="slice"===y?o.dx:"dice"===y?o.dy:"slice-dice"===y?1&n.depth?o.dy:o.dx:Math.min(o.dx,o.dy);for(e(h,o.dx*o.dy/n.value),f.area=0;(c=h.length)>0;)f.push(u=h[c-1]),f.area+=u.area,"squarify"!==y||(i=a(f,p))<=d?(h.pop(),d=i):(f.area-=f.pop().area,l(f,p,o,!1),p=Math.min(o.dx,o.dy),f.length=f.area=0,d=1/0);f.length&&(l(f,p,o,!0),f.length=f.area=0),r.forEach(t)}}function u(n){var r=n.children;if(r&&r.length){var t,a=s(n),i=r.slice(),c=[];for(e(i,a.dx*a.dy/n.value),c.area=0;t=i.pop();)c.push(t),c.area+=t.area,null!=t.z&&(l(c,t.z?a.dx:a.dy,a,!i.length),c.length=c.area=0);r.forEach(u)}}function a(n,r){for(var e,t=n.area,u=0,a=1/0,l=-1,i=n.length;++l<i;)(e=n[l].area)&&(a>e&&(a=e),e>u&&(u=e));return t*=t,r*=r,t?Math.max(r*u*g/t,t/(r*a*g)):1/0}function l(n,r,e,t){var u,a=-1,l=n.length,i=e.x,c=e.y,o=r?f(n.area/r):0;if(r==e.dx){for((t||o>e.dy)&&(o=e.dy);++a<l;)u=n[a],u.x=i,u.y=c,u.dy=o,i+=u.dx=Math.min(e.x+e.dx-i,o?f(u.area/o):0);u.z=!0,u.dx+=e.x+e.dx-i,e.y+=o,e.dy-=o}else{for((t||o>e.dx)&&(o=e.dx);++a<l;)u=n[a],u.x=i,u.y=c,u.dx=o,c+=u.dy=Math.min(e.y+e.dy-c,o?f(u.area/o):0);u.z=!1,u.dy+=e.y+e.dy-c,e.x+=o,e.dx-=o}}function i(n){var r=c||o(n),a=r[0];return a.x=0,a.y=0,a.dx=p[0],a.dy=p[1],c&&o.revalue(a),e([a],a.dx*a.dy/a.value),(c?u:t)(a),x&&(c=r),r}var c,o=d(),f=Number,p=[1,1],v=null,s=Q,x=!1,y="squarify",g=U;return i.size=function(n){return arguments.length?(p=[+n[0],+n[1]],i):p.slice()},i.padding=function(e){if(!arguments.length)return Array.isArray(v)?v.slice():v;var t;return s=null==e?(v=null,Q):"function"==(t=typeof e)?(v=e,n):"number"===t?(v=[e,e,e,e],r):(v=[+e[0],+e[1],+e[2],+e[3]],r),i},i.round=function(n){return arguments.length?(f=n?Math.round:Number,i):f!==Number},i.sticky=function(n){return arguments.length?(x=!!n,c=null,i):x},i.ratio=function(n){return arguments.length?(g=+n,i):g},i.mode=function(n){return arguments.length?(y=V.hasOwnProperty(n)?n+"":"squarify",i):y},h(i,o)}var U=(1+Math.sqrt(5))/2,V={slice:1,dice:1,"slice-dice":1,squarify:1},W="0.0.2";n.version=W,n.bundle=r,n.cluster=b,n.links=i,n.pack=I,n.partition=L,n.tree=m,n.treemap=T});