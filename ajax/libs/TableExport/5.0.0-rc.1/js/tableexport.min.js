/*!
 * TableExport.js v5.0.0-rc.1 (https://www.travismclarke.com)
 *
 * Copyright (c) 2017 - Travis Clarke - https://www.travismclarke.com
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at

 * http://www.apache.org/licenses/LICENSE-2.0

 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(t,e){if("function"==typeof define&&define.amd)define(function(t){var r;try{r=t("jquery")}catch(o){}return e(r,t("blobjs"),t("file-saverjs"),t("xlsx"))});else if("object"==typeof exports&&"string"!=typeof exports.nodeName){var r;try{r=require("jquery")}catch(o){}module.exports=e(r,require("blobjs"),require("file-saverjs"),require("xlsx"))}else t.TableExport=e(t.jQuery,t.Blob,t.saveAs,t.XLSX)}(this,function(t,e,r,o){"use strict";function n(){for(var t=arguments,e=1;e<t.length;e++)for(var r in t[e])t[e].hasOwnProperty(r)&&(t[0][r]=t[e][r]);return t[0]}function a(t){return"undefined"==typeof t.length?[].concat(t):[].slice.call(t)}function i(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.cls)}function s(t){return!isNaN(t)}function p(t){return"undefined"!=typeof t}function l(t){return t&&[].concat.apply([],t)}function u(t,e,r){var o={};return t?(o.bootstrapClass=e[0]+" ",o.bootstrapTheme=e[1]+" ",o.bootstrapSpacing=e[2]+" "):(o.bootstrapClass=r+" ",o.bootstrapTheme="",o.bootstrapSpacing=""),o}var c=function(t,e){var r=this;if(!t)return new Error('"selectors" is required');if(!r)return new c(t,e);r.settings=n({},r.defaults,e),r.selectors=a(t);var i=r.settings;i.ignoreRows=i.ignoreRows instanceof Array?i.ignoreRows:[i.ignoreRows],i.ignoreCols=i.ignoreCols instanceof Array?i.ignoreCols:[i.ignoreCols],i.ignoreCSS=r.ignoreCSS instanceof Array?r.ignoreCSS.join(", "):r.ignoreCSS,i.emptyCSS=r.emptyCSS instanceof Array?r.emptyCSS.join(", "):r.emptyCSS,i.formatValue=r.formatValue.bind(this,i.trimWhitespace),i.bootstrapSettings=u(i.bootstrap,r.bootstrapConfig,r.defaultButton);var s={};r.getExportData=function(){return s},r.selectors.forEach(function(t){var e={};e.rows=a(t.querySelectorAll("tbody > tr")),e.rows=i.headers?a(t.querySelectorAll("thead > tr")).concat(e.rows):e.rows,e.rows=i.footers?e.rows.concat(a(t.querySelectorAll("tfoot > tr"))):e.rows,e.thAdj=i.headers?t.querySelectorAll("thead > tr").length:0,e.filename="id"===i.filename?t.getAttribute("id")?t.getAttribute("id"):r.defaultFilename:i.filename?i.filename:r.defaultFilename,e.uuid=g(t),e.checkCaption=function(e){var r=t.querySelectorAll("caption.tableexport-caption");r.length?r[0].appendChild(e):(r=document.createElement("caption"),r.className=i.bootstrapSettings.bootstrapSpacing+i.position+" tableexport-caption",r.appendChild(e),t.insertBefore(r,t.firstChild))},e.setExportData=function(){return function(t){var r=f.getInstance().getItem(t),o=t.substring(t.indexOf("-")+1);s[e.uuid]=s[e.uuid]||{},s[e.uuid][o]=JSON.parse(r)}}(),e.rcMap=(new d).build.call(r,e);var n={};for(var p in h)n[h[p]]=0;i.formats.forEach(function(t){!(!o||v||t!==h.XLS)&&(t=h.BIFF2),!(o&&!v||t!==h.XLSX)&&(t=h.XLS),n[t]||(e.setExportData(r.exporters[t].call(r,e)),n[t]++)})});var p=document.querySelectorAll("button[tableexport-id]");return b(p,"click",r.downloadHandler,r),r};c.prototype={version:"5.0.0-rc.1",defaults:{headers:!0,footers:!0,formats:["xls","csv","txt"],filename:"id",bootstrap:!1,exportButtons:!0,position:"bottom",ignoreRows:null,ignoreCols:null,trimWhitespace:!0},CONSTANTS:{FORMAT:{XLSX:"xlsx",BIFF2:"biff2",XLS:"xls",CSV:"csv",TXT:"txt"},TYPE:{STRING:"s",NUMBER:"n",BOOLEAN:"b",DATE:"d"}},charset:"charset=utf-8",defaultFilename:"myDownload",defaultButton:"button-default",ignoreCSS:"tableexport-ignore",emptyCSS:"tableexport-empty",bootstrapConfig:["btn","btn-default","btn-toolbar"],rowDel:"\r\n",entityMap:{"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47;"},formatConfig:{xlsx:{defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},xls:{defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},csv:{defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"text/csv",fileExtension:".csv"},txt:{defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"}},typeConfig:{string:{defaultClass:"tableexport-string"},number:{defaultClass:"tableexport-number",assert:function(t){return!isNaN(t)}},"boolean":{defaultClass:"tableexport-boolean",assert:function(t){return"true"===t.toLowerCase()||"false"===t.toLowerCase()}},date:{defaultClass:"tableexport-date",assert:function(t){return!/.*%/.test(t)&&!isNaN(Date.parse(t))}}},exporters:{xlsx:function(t){var e=this,r=e.settings,o=c.prototype.formatConfig[h.XLSX],n=t.rcMap,i=a(t.rows).map(function(t,o){if(n.isIgnore(o))return n.handleRowColMapProp(n.TYPE.IGNORE);var i=t.querySelectorAll("th, td");return a(i).map(function(t,a){var i={v:r.formatValue(t.textContent),t:e.getType(t.className)};return n.isIgnore(o,a)?n.handleRowColMapProp(n.TYPE.IGNORE):n.isEmpty(o,a)?n.handleRowColMapProp(n.TYPE.EMPTY):n.handleRowColMapProp(n.TYPE.DEFAULT,o,a,i)}).filter(p)}).map(l).filter(p),s=JSON.stringify({data:i,filename:t.filename,mimeType:o.mimeType,fileExtension:o.fileExtension}),u=y({uuid:t.uuid,type:h.XLSX});return r.exportButtons&&t.checkCaption(c.prototype.createObjButton(u,s,o.buttonContent,o.defaultClass,r.bootstrapSettings)),f.getInstance().setItem(u,s,!0)},biff2:function(t){var e=this,r=e.settings,o=c.prototype.formatConfig[h.XLS],n=t.rcMap,i=a(t.rows).map(function(t,o){if(n.isIgnore(o))return n.handleRowColMapProp(n.TYPE.IGNORE);var i=t.querySelectorAll("th, td");return a(i).map(function(t,a){var i={v:r.formatValue(t.textContent),t:e.getType(t.className)};return n.isIgnore(o,a)?n.handleRowColMapProp(n.TYPE.IGNORE):n.isEmpty(o,a)?n.handleRowColMapProp(n.TYPE.EMPTY):n.handleRowColMapProp(n.TYPE.DEFAULT,o,a,i)}).filter(p)}).map(l).filter(p),s=JSON.stringify({data:i,filename:t.filename,mimeType:o.mimeType,fileExtension:o.fileExtension}),u=y({uuid:t.uuid,type:h.XLS});return r.exportButtons&&t.checkCaption(c.prototype.createObjButton(u,s,o.buttonContent,o.defaultClass,r.bootstrapSettings)),f.getInstance().setItem(u,s,!0)},xls:function(t){var e=this,r=e.settings,o=c.prototype.formatConfig[h.XLS],n=o.separator,i=t.rcMap,s=a(t.rows).map(function(t,e){if(i.isIgnore(e))return i.handleRowColMapProp(i.TYPE.IGNORE);var o=t.querySelectorAll("th, td");return a(o).map(function(t,o){var a=r.formatValue(t.textContent);return i.isIgnore(e,o)?i.handleRowColMapProp(i.TYPE.IGNORE):i.isEmpty(e,o)?i.handleRowColMapProp(i.TYPE.EMPTY):i.handleRowColMapProp(i.TYPE.DEFAULT,e,o,a,n)}).filter(p).join(n)}).filter(p).join(e.rowDel),l=JSON.stringify({data:s,filename:t.filename,mimeType:o.mimeType,fileExtension:o.fileExtension}),u=y({uuid:t.uuid,type:h.XLS});return r.exportButtons&&t.checkCaption(c.prototype.createObjButton(u,l,o.buttonContent,o.defaultClass,r.bootstrapSettings)),f.getInstance().setItem(u,l,!0)},csv:function(t){var e=this,r=e.settings,o=c.prototype.formatConfig[h.CSV],n=o.separator,i=t.rcMap,s=a(t.rows).map(function(t,e){if(i.isIgnore(e))return i.handleRowColMapProp(i.TYPE.IGNORE);var o=t.querySelectorAll("th, td");return a(o).map(function(t,o){var a='"'+r.formatValue(t.textContent.replace(/"/g,'""'))+'"';return i.isIgnore(e,o)?i.handleRowColMapProp(i.TYPE.IGNORE):i.isEmpty(e,o)?i.handleRowColMapProp(i.TYPE.EMPTY):i.handleRowColMapProp(i.TYPE.DEFAULT,e,o,a,n)}).filter(p).join(n)}).filter(p).join(e.rowDel),l=JSON.stringify({data:s,filename:t.filename,mimeType:o.mimeType,fileExtension:o.fileExtension}),u=y({uuid:t.uuid,type:h.CSV});return r.exportButtons&&t.checkCaption(c.prototype.createObjButton(u,l,o.buttonContent,o.defaultClass,r.bootstrapSettings)),f.getInstance().setItem(u,l,!0)},txt:function(t){var e=this,r=e.settings,o=c.prototype.formatConfig[h.TXT],n=o.separator,i=t.rcMap,s=a(t.rows).map(function(t,e){if(i.isIgnore(e))return i.handleRowColMapProp(i.TYPE.IGNORE);var o=t.querySelectorAll("th, td");return a(o).map(function(t,o){var a=r.formatValue(t.textContent);return i.isIgnore(e,o)?i.handleRowColMapProp(i.TYPE.IGNORE):i.isEmpty(e,o)?i.handleRowColMapProp(i.TYPE.EMPTY):i.handleRowColMapProp(i.TYPE.DEFAULT,e,o,a,n)}).filter(p).join(n)}).filter(p).join(e.rowDel),l=JSON.stringify({data:s,filename:t.filename,mimeType:o.mimeType,fileExtension:o.fileExtension}),u=y({uuid:t.uuid,type:h.TXT});return r.exportButtons&&t.checkCaption(c.prototype.createObjButton(u,l,o.buttonContent,o.defaultClass,r.bootstrapSettings)),f.getInstance().setItem(u,l,!0)}},createObjButton:function(t,e,r,o,n){var a=document.createElement("button");return a.setAttribute("tableexport-id",t),a.className=n.bootstrapClass+n.bootstrapTheme+o,a.textContent=r,a},escapeHtml:function(t){return String(t).replace(/[&<>'\/]/g,function(t){return c.prototype.entityMap[t]})},unescapeHtml:function(t){var e=String(t);for(var r in this.entityMap)e=e.replace(RegExp(this.entityMap[r],"g"),r);return e},formatValue:function(t,e){return t?e.trim():e},getType:function(t){if(!t)return"";var e=c.prototype.typeConfig;return~t.indexOf(e.string.defaultClass)?m.STRING:~t.indexOf(e.number.defaultClass)?m.NUMBER:~t.indexOf(e["boolean"].defaultClass)?m.BOOLEAN:~t.indexOf(e.date.defaultClass)?m.DATE:""},dateNum:function(t,e){e&&(t+=1462);var r=Date.parse(t),o=(r-new Date(Date.UTC(1899,11,30)))/864e5;return Math.floor(o)},createSheet:function(t){for(var e={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=c.prototype.typeConfig,a=0;a!==t.length;++a)for(var i=0;i!==t[a].length;++i){r.s.r>a&&(r.s.r=a),r.s.c>i&&(r.s.c=i),r.e.r<a&&(r.e.r=a),r.e.c<i&&(r.e.c=i);var s=t[a][i];if(s&&s.v){var p=o.utils.encode_cell({c:i,r:a});s.t||(n.number.assert(s.v)?s.t=m.NUMBER:n["boolean"].assert(s.v)?s.t=m.BOOLEAN:n.date.assert(s.v)?s.t=m.DATE:s.t=m.STRING),s.t===m.DATE&&(s.t=m.NUMBER,s.z=o.SSF._table[14],s.v=this.dateNum(s.v)),e[p]=s}}return r.s.c<1e7&&(e["!ref"]=o.utils.encode_range(r)),e},downloadHandler:function(t){var e=t.target,r=JSON.parse(f.getInstance().getItem(e.getAttribute("tableexport-id"))),o=r.data,n=r.filename,a=r.mimeType,i=r.fileExtension;this.export2file(o,a,n,i)},Workbook:function(){this.SheetNames=[],this.Sheets={}},string2ArrayBuffer:function(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),o=0;o!==t.length;++o)r[o]=255&t.charCodeAt(o);return e},export2file:function(t,o,n,a){if(t=this.getRawData(t,a,n),v){var i="data:"+o+";"+this.charset+","+t;this.downloadDataURI(i,n,a)}else r(new e([t],{type:o+";"+this.charset}),n+a,!0)},downloadDataURI:function(t,e,r){var o=encodeURI(t),n=document.createElement("a");n.setAttribute("href",o),n.setAttribute("download",e+r),document.body.appendChild(n),n.click()},getRawData:function(t,e,r){if(o&&!v&&e.substring(1,4)===h.XLS){var n=new this.Workbook,a=this.createSheet(t),i=e.substring(1)===h.XLS?h.BIFF2:h.XLSX;r=r||"",n.SheetNames.push(r),n.Sheets[r]=a;var s={bookType:i,bookSST:!1,type:"binary"},p=o.write(n,s);t=this.string2ArrayBuffer(p)}return t},getFileSize:function(t,e){var r=this.getRawData(t,e);return r instanceof ArrayBuffer?r.byteLength:this.string2ArrayBuffer(r).byteLength},update:function(t){return c.prototype.remove.call(this),new c(this.selectors,n({},this.defaults,t))},reset:function(){return c.prototype.remove.call(this),new c(this.selectors,this.settings)},remove:function(){this.selectors.forEach(function(t){var e=t.querySelector("caption.tableexport-caption");e&&t.removeChild(e)})}};var f=function(){this._instance=null,this.store=localStorage,this.namespace="te-",this.getKey=function(t){return this.namespace+t},this.setItem=function(t,e,r){var o=this.getKey(t);if(!this.exists(o)||r)return"string"!=typeof e?this.error('"value" must be a string'):(this.store.setItem(o,e),t)},this.getItem=function(t){var e=this.getKey(t);return this.store.getItem(e)},this.exists=function(t){var e=this.getKey(t);return null!==this.store.getItem(e)},this.removeItem=function(t){var e=this.getKey(t);return this.store.removeItem(e)},this.error=function(t){return new Error("error:",t)}};f.getInstance=function(){return this._instance||(this._instance=new f),this._instance};var d=function(){this.rcMap=[],this.isIgnore=function(t,e){var r=d.prototype.TYPE.IGNORE;return this.getRowColMapProp(t,e,r)},this.isEmpty=function(t,e){var r=d.prototype.TYPE.EMPTY;return this.getRowColMapProp(t,e,r)},this.isSpan=function(t){var e=d.prototype.TYPE.SPAN;return this.getRowColMapProp(t,void 0,e)},this.getRowColMapProp=function(t,e,r){if(this.rcMap[t]){if("undefined"==typeof e)return this.rcMap[t][r];if(this.rcMap[t][e])return this.rcMap[t][e][r]}return!1},this.setRowColMapProp=function(t,e,r,o){this.rcMap[t]=this.rcMap[t]||[],"undefined"==typeof r?this.rcMap[t][e]=o:"undefined"==typeof e?this.rcMap[t][r]=o:(this.rcMap[t][e]=this.rcMap[t][e]||[],this.rcMap[t][e][r]=o)},this.convertSpanToArray=function(t,e,r,o){if(this.rcMap[t]&&this.isSpan(t)){for(var n=e+d.prototype.OFFSET,a=0,i=0,p=null,l=Math.max.apply(Math,Object.keys(this.rcMap[t]).filter(s)),u=0;u<=l&&(p=this.rcMap[t][u],p?a=i>=e?a+p:a:i++,i!==n);u++);return"undefined"!=typeof o?new Array(a).concat(r).join(o):new Array(a).concat(r)}return r},this.handleRowColMapProp=function(t,e,r,o,n){switch(t){case d.prototype.TYPE.IGNORE:return;case d.prototype.TYPE.EMPTY:return" ";case d.prototype.TYPE.DEFAULT:default:return this.convertSpanToArray(e,r,o,n)}}};d.prototype={OFFSET:1,TYPE:{IGNORE:"ignore",EMPTY:"empty",SPAN:"span",DEFAULT:"default"},build:function(t){var e=this,r=e.settings,o=1,n=new d,s=function(t){n.setRowColMapProp(t,void 0,n.TYPE.IGNORE,!0)},p=function(t,e){n.setRowColMapProp(t,e,n.TYPE.IGNORE,!0)},l=function(t,e){n.setRowColMapProp(t,e,n.TYPE.EMPTY,!0)},u=function(t,e,r){var o=t.getAttribute("rowspan"),a=t.hasAttribute("colspan");a&&c(t,e,r);for(var i=1;i<o;i++)n.setRowColMapProp(i+e,void 0,n.TYPE.SPAN,!0),n.setRowColMapProp(i+e,r,void 0,1),a&&c(t,i+e,r)},c=function(t,e,r){var a=t.getAttribute("colspan");n.setRowColMapProp(e,void 0,n.TYPE.SPAN,!0),n.setRowColMapProp(e,r+o,void 0,a-o)};return a(t.rows).map(function(e,o){(~r.ignoreRows.indexOf(o-t.thAdj)||i(e,r.ignoreCSS))&&s(o);var n=e.querySelectorAll("th, td");return a(n).map(function(t,e){(~r.ignoreCols.indexOf(e)||i(t,r.ignoreCSS))&&p(o,e),i(t,r.emptyCSS)&&l(o,e),t.hasAttribute("rowspan")?u(t,o,e):t.hasAttribute("colspan")&&c(t,o,e)})}),n}};var m=function(){return c.prototype.CONSTANTS.TYPE}(),h=function(){return c.prototype.CONSTANTS.FORMAT}(),g=function(){var t=0;return function(e){return e.id||(e.id="tableexport-"+ ++t),e.id}}(),y=function(){var t,e,r=0;return function(o){var n=o.type;if(o=JSON.stringify(o),0===o.length)return r;for(t=0;t<o.length;t++)e=o.charCodeAt(t),r=(r<<5)-r+e,r|=0;return r.toString(16).substring(1)+"-"+n}}(),b=function(){var t=null;return function(e,r,o,n){for(var a=o.bind(n),i=0;i<e.length;++i)t&&e[i].removeEventListener(r,t,!1),e[i].addEventListener(r,a,!1);t=a}}(),v=function(t){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substring(0,4))}(navigator.userAgent||navigator.vendor||window.opera);if(t){t.fn.tableExport=function(t){return new c(this,t)};for(var w in c.prototype)t.fn.tableExport[w]=c.prototype[w]}return c.TableExport=c,c});