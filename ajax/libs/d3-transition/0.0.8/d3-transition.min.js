!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection"),require("d3-ease"),require("d3-interpolate"),require("d3-dispatch"),require("d3-timer")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-ease","d3-interpolate","d3-dispatch","d3-timer"],e):e(t.d3_transition={},t.d3_selection,t.d3_ease,t.d3_interpolate,t.d3_dispatch,t.d3_timer)}(this,function(t,e,n,r,i,u){"use strict";function a(t,n){return"transform"===n&&t.namespaceURI===e.namespaces.svg?r.interpolateTransform:r.interpolate}function o(t){return function(){this.removeAttribute(t)}}function s(t){return function(){this.removeAttributeNS(t.space,t.local)}}function l(t,e){return function(){var n=this.getAttribute(t);return n!==e?a(this,t)(n,e):void 0}}function c(t,e){return function(){var n=this.getAttributeNS(t.space,t.local);return n!==e?r.interpolate(n,e):void 0}}function h(t,e){return function(){var n,r=e.apply(this,arguments);return null==r?void this.removeAttribute(t):(n=this.getAttribute(t),r+="",n!==r?a(this,t)(n,r):void 0)}}function f(t,e){return function(){var n,i=e.apply(this,arguments);return null==i?void this.removeAttributeNS(t.space,t.local):(n=this.getAttributeNS(t.space,t.local),i+="",n!==i?r.interpolate(n,i):void 0)}}function d(t,n){var r=e.namespace(t);return this.attrTween(t,(null==n?r.local?s:o:"function"==typeof n?r.local?f:h:r.local?c:l)(r,n))}function p(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}function _(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n}function v(t,n){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;var i=e.namespace(t);return this.tween(r,(i.local?p:_)(i,n))}function y(t,e,n,r,i,u){var a=t[e];if(a){if(g(t,e,n))return}else t[e]=a={active:null,pending:[]};m(t,e,{id:n,index:r,group:i,dispatch:et,tweens:[],time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null})}function g(t,e,n){var r=t[e];if(r){var i=r.active;if(i&&i.id===n)return i;for(var u=r.pending,a=u.length;--a>=0;)if((i=u[a]).id===n)return i}}function m(t,e,n){function r(e,r){var o,s,l,c,h=a.active,f=a.pending,d=n.tweens;for(o=0,s=-1,l=f.length;l>o;++o)c=f[o],c.id<n.id?c.timer.stop():c.id>n.id&&(f[++s]=c);for(f.length=s+1,a.active=n,u.timerOnce(function(){a.active===n&&(n.timer.restart(i,n.delay,n.time),i(e))},0,r),h&&(h.timer.stop(),h.dispatch.interrupt.call(t,t.__data__,h.index,h.group)),n.dispatch.start.call(t,t.__data__,n.index,n.group),o=0,s=-1,l=d.length;l>o;++o)(c=d[o].value.call(t,t.__data__,n.index,n.group))&&(d[++s]=c);d.length=s+1}function i(r){var i,u,o=n.tweens,s=r/n.duration,l=s>=1?1:n.ease.call(null,s);for(i=0,u=o.length;u>i;++i)o[i].call(null,l);s>=1&&(a.active=null,a.pending.length||delete t[e],n.timer.stop(),n.dispatch.end.call(t,t.__data__,n.index,n.group))}var a=t[e];a.pending.push(n),n.timer=u.timer(function(t,e){n.delay<=t?r(t-n.delay,e):n.timer.restart(r,n.delay,n.time)},0,n.time)}function w(t,e,n){return function(){g(this,t,e).delay=+n.apply(this,arguments)}}function A(t,e,n){return n=+n,function(){g(this,t,e).delay=n}}function x(t){var e=this._key,n=this._id;return arguments.length?this.each(("function"==typeof t?w:A)(e,n,t)):g(this.node(),e,n).delay}function b(t,e,n){return function(){g(this,t,e).duration=+n.apply(this,arguments)}}function k(t,e,n){return n=+n,function(){g(this,t,e).duration=n}}function P(t){var e=this._key,n=this._id;return arguments.length?this.each(("function"==typeof t?b:k)(e,n,t)):g(this.node(),e,n).duration}function S(t,e,n){return function(){g(this,t,e).ease=n}}function C(t){var e=this._key,n=this._id;return arguments.length?this.each(S(e,n,t)):g(this.node(),e,n).ease}function N(t){"function"!=typeof t&&(t=e.matcher(t));for(var n=this._groups,r=n.length,i=new Array(r),u=0;r>u;++u)for(var a,o=n[u],s=o.length,l=i[u]=[],c=0;s>c;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new W(i,this._parents,this._key,this._id)}function T(t,e,n,r){return function(){var u=g(this,t,e),a=u.dispatch;a===et&&(u.dispatch=a=i.dispatch("start","end","interrupt")),a.on(n,r)}}function V(t,e){var n=this._key,r=this._id;if(arguments.length<2){var i=g(this.node(),n,r);return i&&i.dispatch.on(t)}return this.each(T(n,r,t,e))}function q(t){return function(){var e=this.parentNode;e&&!this[t]&&e.removeChild(this)}}function D(){return this.on("end.remove",q(this._key))}function z(t){var n=this._key,r=this._id;"function"!=typeof t&&(t=e.selector(t));for(var i=this._groups,u=i.length,a=new Array(u),o=0;u>o;++o)for(var s,l,c=i[o],h=c.length,f=a[o]=new Array(h),d=0;h>d;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),f[d]=l,y(f[d],n,r,d,f,g(s,n,r)));return new W(a,this._parents,n,r)}function I(t){var n=this._key,r=this._id;"function"!=typeof t&&(t=e.selectorAll(t));for(var i=this._groups,u=i.length,a=[],o=[],s=0;u>s;++s)for(var l,c=i[s],h=c.length,f=0;h>f;++f)if(l=c[f]){for(var d,p=t.call(l,l.__data__,f,c),_=g(l,n,r),v=0,m=p.length;m>v;++v)(d=p[v])&&y(d,n,r,v,p,_);a.push(p),o.push(l)}return new W(i,o,n,r)}function O(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function j(t){return function(){var e=O(this).getComputedStyle(this,null),n=e.getPropertyValue(t),i=(this.style.removeProperty(t),e.getPropertyValue(t));return n!==i?r.interpolate(n,i):void 0}}function R(t){return function(){this.style.removeProperty(t)}}function U(t,e){return function(){var n=O(this).getComputedStyle(this,null).getPropertyValue(t);return n!==e?r.interpolate(n,e):void 0}}function B(t,e){return function(){var n,i=e.apply(this,arguments);return null==i?void this.style.removeProperty(t):(n=O(this).getComputedStyle(this,null).getPropertyValue(t),i+="",n!==i?r.interpolate(n,i):void 0)}}function E(t,e,n){return null==e?this.styleTween(t,j(t)).on("end.style."+t,R(t)):this.styleTween(t,("function"==typeof e?B:U)(t,e),n)}function F(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}function G(t,e,n){var r="style."+t;return arguments.length<2?(r=this.tween(r))&&r._value:this.tween(r,F(t,e,null==n?"":n))}function H(t){return t=null==t?"":t+"",function(){this.textContent=t}}function J(t){return function(){var e=t.apply(this,arguments);null==e&&(e=""),this.textContent=e}}function K(t){return this.tween("text",("function"==typeof t?J:H)(t))}function L(){for(var t=this._key,e=this._id,n=Y(),r=this._groups,i=r.length,u=0;i>u;++u)for(var a,o=r[u],s=o.length,l=0;s>l;++l)if(a=o[l]){var c=g(a,t,e);y(a,t,n,l,o,{time:c.time,delay:c.delay+c.duration,duration:c.duration,ease:c.ease})}return new W(r,this._parents,t,n)}function M(t,e,n,r){return function(){for(var i,u=g(this,t,e).tweens,a=0,o=u.length;o>a;++a)if((i=u[a]).name===n)return i.value=r;u.push({name:n,value:r})}}function Q(t,e){var n=this._key,r=this._id,i=t+"";if(arguments.length<2){var u=g(this.node(),n,r);if(u)for(var a,o=u.tweens,s=0,l=o.length;l>s;++s)if((a=o[s]).name===i)return a.value;return null}return this.each(M(n,r,i,e))}function W(t,e,n,r){this._groups=t,this._parents=e,this._key=n,this._id=r}function X(t){return e.selection().transition(t)}function Y(){return++nt}function Z(t){return t?"__transition_"+t+"__":"__transition__"}function $(t){var e=Z(t);return this.each(function(){var t=this[e];if(t){for(var n=t.pending,r=t.active,i=0,u=n.length;u>i;++i)n[i].timer.stop();n.length=0,r&&(t.active=null,r.timer.stop(),r.dispatch.interrupt.call(this,this.__data__,r.index,r.group)),delete this[e]}})}function tt(t){for(var e=Y(),r=Z(t),i={time:Date.now(),delay:0,duration:250,ease:n.easeCubicInOut},u=this._groups,a=u.length,o=new Array(a),s=0;a>s;++s)for(var l,c=u[s],h=c.length,f=o[s]=new Array(h),d=0;h>d;++d)(l=c[d])&&y(f[d]=l,r,e,d,f,i);return new W(o,this._parents,r,e)}var et=i.dispatch("start","end","interrupt"),nt=0,rt=e.selection.prototype;W.prototype=X.prototype={select:z,selectAll:I,filter:N,transition:L,call:rt.call,nodes:rt.nodes,node:rt.node,size:rt.size,empty:rt.empty,each:rt.each,on:V,attr:d,attrTween:v,style:E,styleTween:G,text:K,remove:D,tween:Q,delay:x,duration:P,ease:C},e.selection.prototype.interrupt=$,e.selection.prototype.transition=tt;var it="0.0.8";t.version=it,t.transition=X});