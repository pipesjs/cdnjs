/*! angular-fontselect v0.6.4 */
!function(a,b){"use strict";function c(a){return a.toLowerCase().replace(/[^a-z]+/g,"-")}function d(a){for(var b=a.replace("-"," ").split(" "),c=0,d=b.length;d>c;c++)b[c]=b[c].charAt(0).toUpperCase()+b[c].slice(1);return b.join(" ")}function e(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}function f(){for(var a=this,b=0,c=W.length;c>b;b++)a[W[b]]=arguments[b];return a._init(),a}var g=a.module("jdFontselect",[]),h="websafe",i="google",j={};j[h]=!0,j[i]=!0;var k=10,l="src/partials/",m=".controller",n="jdFontselect.fonts",o=[{name:"Arial",key:"arial",category:"sansserif",stack:'Arial, "Helvetica Neue", Helvetica, sans-serif',popularity:3,lastModified:"2014-01-28"},{name:"Consolas",key:"consolas",category:"sans-serif",stack:'Consolas, "Lucida Console", Monaco, monospace',popularity:1,lastModified:"2014-02-04"},{name:"Courier New",key:"couriernew",category:"serif",stack:'"Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace',popularity:1,lastModified:"2014-01-28"},{name:"Georgia",key:"georgia",category:"serif",stack:'Georgia, Palatino, "Palatino Linotype", Times, "Times New Roman", serif',popularity:2,lastModified:"2014-02-04"},{name:"Helvetica",key:"helvetica",category:"sansserif",stack:'Helvetica, "Helvetica Neue", Arial, sans-serif',popularity:3,lastModified:"2014-02-04"},{name:"Impact",key:"impact",category:"display",stack:'Impact, Haettenschweiler, "Arial Narrow Bold", sans-serif',popularity:3,lastModified:"2014-02-04"},{name:"Lucida Sans",key:"lucidasans",category:"sansserif",stack:'"Lucida Sans", "Lucida Grande", "Lucida Sans Unicode", sans-serif',popularity:3,lastModified:"2014-02-04"},{name:"Palatino",key:"palatino",category:"serif",stack:'Palatino, "Palatino Linotype", Georgia, Times, "Times New Roman", serif',popularity:2,lastModified:"2014-02-04"},{name:"Tahoma",key:"tahoma",category:"sansserif",stack:"Tahoma, Verdana, Geneva, sans-serif",popularity:6,lastModified:"2014-02-04"},{name:"Trebuchet",key:"trebuchet",category:"sansserif",stack:'"Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif',popularity:6,lastModified:"2014-02-04"},{name:"Verdana",key:"verdana",category:"sansserif",stack:"Verdana, Geneva, sans-serif",popularity:6,lastModified:"2014-01-28"},{name:"Times New Roman",key:"timesnewroman",category:"serif",stack:'TimesNewRoman, "Times New Roman", Times, Baskerville, Georgia, serif',popularity:2,lastModified:"2014-01-28"},{name:"Brush Script",key:"brushscript",category:"handwriting",stack:'"Brush Script MT", cursive',popularity:5,lastModified:"2014-01-29"}],p=[{key:"serif",fallback:"serif"},{key:"sansserif",fallback:"sans-serif"},{key:"handwriting",fallback:"cursive"},{key:"display",fallback:"cursive"},{key:"other",fallback:"sans-serif"}],q="next",r="prev",s=["name","key","stack"],t=!1,u="get",v="https://www.googleapis.com/webfonts/v1/webfonts",w="http://fonts.googleapis.com/css",x="cyrillic",y="cyrillic-ext",z="greek",A="greek-ext",B="latin",C="latin-ext",D="vietnamese",E=[B,C,z,A,x,y,D],F=!1,G=["regular","400","300","500"],H=["light","100","200"],I=["bold","600","700","800","900"],J=["italic","400italic","300italic","500italic"],K=["lightitalic","100italic","200italic"],L=["bolditalic","600italic","700italic","800italic","900italic"],M=G.concat(H,I,J,K,L),N=27,O=38,P=40,Q=37,R=39,S=[{key:"name",dir:!1},{key:"popularity",dir:!0},{key:"lastModified",dir:!0}],T={sort:{attr:b,direction:!0},providers:j,category:b,font:b,search:b,subsets:{latin:!0}},U={button:"Choose Font",search:"Search by Fontname",providerLabel:"Providers",subsetLabel:"Subsets",styleLabel:"Font Styles",pageLabel:"Page: ",fontFabel:"Fonts: ",closeButton:"Close",page:{prev:"◄",next:"►"},provider:{websafe:"Websafe Fonts",google:"Google Fonts"},category:{serif:"Serif",sansserif:"Sans Serif",display:"Display",handwriting:"Handwriting",other:"Other"},subset:{cyrillic:"Cyrillic","cyrillic-ext":"Cyrillic Extended",greek:"Greek","greek-ext":"Greek Extended",latin:"Latin","latin-ext":"Latin Extended",vietnamese:"Vietnamese"},sort:{popularity:"Popularity",name:"Alphabet",lastModified:"Latest"},sortdir:{desc:"▼",asc:"▲"}};g.constant("jdFontselectConfig",{googleApiKey:!1});var V={handwriting:["Patrick Hand SC","Grand Hotel","Calligraffitti","Coming Soon","Crafty Girls","Homemade Apple","Just Another Hand","Montez","Permanent Marker","Rancho","Redressed","Rochester","Rock Salt","Satisfy","Schoolbell","Sunshiney","Walter Turncoat","Yellowtail","Aguafina Script","Aladin","Alex Brush","Allura","Amatic SC","Annie Use Your Telescope","Architects Daughter","Arizonia","Bad Script","Berkshire Swash","Bilbo","Bilbo Swash Caps","Bonbon","Butterfly Kids","Cedarville Cursive","Clicker Script","Condiment","Cookie","Courgette","Covered By Your Grace","Damion","Dancing Script","Dawning of a New Day","Delius","Delius Swash Caps","Delius Unicase","Devonshire","Dr Sugiyama","Eagle Lake","Engagement","Euphoria Script","Felipa","Fondamento","Give You Glory","Gloria Hallelujah","Gochi Hand","Great Vibes","Handlee","Herr Von Muellerhoff","Indie Flower","Italianno","Jim Nightshade","Julee","Just Me Again Down Here","Kaushan Script","Kristi","La Belle Aurore","League Script","Leckerli One","Loved by the King","Lovers Quarrel","Marck Script","Meddon","Meie Script","Merienda","Merienda One","Mervale Script","Miama","Miss Fajardose","Miss Saint Delafield","Molle","Monsieur La Doulaise","Mr Bedford","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Neucha","Niconne","Norican","Nothing You Could Do","Over the Rainbow","Pacifico","Parisienne","Patrick Hand","Pecita","Petit Formal Script","Pinyon Script","Princess Sofia","Quintessential","Qwigley","Reenie Beanie","Romanesco","Rouge Script","Ruge Boogie","Ruthie","Sacramento","Shadows Into Light","Shadows Into Light Two","Short Stack","Sofia","Stalemate","Sue Ellen Francisco","Swanky and Moo Moo","Tangerine","The Girl Next Door","Vibur","Waiting for the Sunrise","Yesteryear","Zeyada","Domine","Donegal One"],sansserif:["Wendy One","Tauri","Sintony","Pathway Gothic One","Noto Sans","Monda","Merriweather Sans","Exo 2","Aclonica","Alef","Alegreya Sans","Alegreya Sans SC","Denk One","Droid Sans","Droid Sans Mono","Open Sans","Open Sans Condensed","Roboto","Roboto Condensed","Syncopate","ABeeZee","Abel","Acme","Actor","Advent Pro","Aldrich","Allerta","Allerta Stencil","Amaranth","Anaheim","Andika","Anonymous Pro","Antic","Anton","Archivo Black","Archivo Narrow","Arimo","Armata","Asap","Asul","Average Sans","Basic","Belleza","BenchNine","Bubbler One","Cabin","Cabin Condensed","Cagliostro","Candal","Cantarell","Cantora One","Capriola","Carme","Carrois Gothic","Carrois Gothic SC","Changa","Chau Philomene One","Chivo","Coda Caption","Convergence","Cousine","Cuprum","Days One","Didact Gothic","Doppio One","Dorsa","Dosis","Duru Sans","Economica","Electrolize","Englebert","Exo","Federo","Fjalla One","Francois One","Fresca","Gafata","Galdeano","Geo","Gudea","Hammersmith One","Hermeneus One","Homenaje","Imprima","Inconsolata","Inder","Istok Web","Jockey One","Josefin Sans","Josefin Sans Std Light","Julius Sans One","Jura","Karla","Kite One","Krona One","Lato","Lekton","Magra","Mako","Marmelad","Marvel","Maven Pro","Merge One","Metrophobic","Michroma","Molengo","Montserrat","Montserrat Alternates","Montserrat Subrayada","Mouse Memoirs","Muli","News Cycle","Nobile","Numans","Nunito","Orbitron","Orienta","Oswald","Oxygen","Oxygen Mono","Paytone One","Philosopher","Play","Pontano Sans","Port Lligat Sans","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","Puritan","Quantico","Quattrocento Sans","Questrial","Quicksand","Raleway","Rambla","Rationale","Ropa Sans","Rosario","Ruda","Ruluko","Rum Raisin","Russo One","Sansation","Scada","Seymour One","Shanti","Share Tech","Share Tech Mono","Signika","Signika Negative","Six Caps","Snippet","Source Code Pro","Source Sans Pro","Spinnaker","Strait","Strong","Telex","Tenor Sans","Terminal Dosis","Terminal Dosis Light","Text Me One","Titillium Web","Tuffy","Varela","Varela Round","Viga","Voltaire","Wire One","Yanone Kaffeesatz","Ubuntu","Ubuntu Condensed","Ubuntu Mono"],display:["Vampiro One","Snowburst One","Purple Purse","New Rocker","Milonga","Margarine","Lily Script One","Kavoon","Hanalei","Hanalei Fill","Fruktur","Freckle Face","Elsie","Elsie Swash Caps","Cherry Cream Soda","Chewy","Creepster Caps","Crushed","Fontdiner Swanky","Irish Grover","Irish Growler","Kranky","Luckiest Guy","Maiden Orange","Mountains of Christmas","Slackey","Smokum","Special Elite","Unkempt","Abril Fatface","Akronim","Alfa Slab One","Allan","Almendra Display","Amarante","Arbutus","Asset","Astloch","Atomic Age","Aubrey","Audiowide","Autour One","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","Bangers","Baumans","Bevan","Bigelow Rules","Bigshot One","Black Ops One","Boogaloo","Bowlby One","Bowlby One SC","Bubblegum Sans","Buda","Butcherman","Butcherman Caps","Cabin Sketch","Caesar Dressing","Carter One","Ceviche One","Changa One","Chango","Chela One","Chelsea Market","Cherry Swash","Chicle","Cinzel Decorative","Clara","Coda","Codystar","Combo","Comfortaa","Concert One","Contrail One","Corben","Creepster","Croissant One","Diplomata","Diplomata SC","Dynalight","Eater","Eater Caps","Emblema One","Emilys Candy","Erica One","Ewert","Expletus Sans","Fascinate","Fascinate Inline","Faster One","Federant","Finger Paint","Flamenco","Flavors","Forum","Fredericka the Great","Fredoka One","Frijole","Fugaz One","Galindo","Geostar","Geostar Fill","Germania One","Glass Antiqua","Goblin One","Gorditas","Graduate","Gravitas One","Griffy","Gruppo","Happy Monkey","Henny Penny","Iceberg","Iceland","Jacques Francois Shadow","Jolly Lodger","Joti One","Keania One","Kelly Slab","Kenia","Knewave","Lancelot","Lemon","Lemon One","Life Savers","Lilita One","Limelight","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Love Ya Like A Sister","Macondo","Macondo Swash Caps","McLaren","MedievalSharp","Medula One","Megrim","Metal Mania","Metamorphous","Miltonian","Miltonian Tattoo","Miniver","Modern Antiqua","Monofett","Monoton","Mystery Quest","Nixie One","Nosifer","Nosifer Caps","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Offside","Oldenburg","Oleo Script","Oleo Script Swash Caps","Oregano","Original Surfer","Overlock","Overlock SC","Paprika","Passero One","Passion One","Patua One","Peralta","Piedra","Pirata One","Plaster","Playball","Poetsen One","Poiret One","Poller One","Pompiere","Press Start 2P","Prosto One","Racing Sans One","Raleway Dots","Rammetto One","Ranchers","Revalia","Ribeye","Ribeye Marrow","Righteous","Risque","Ruslan Display","Rye","Sail","Salsa","Sancreek","Sansita One","Sarina","Seaweed Script","Sevillana","Share","Shojumaru","Sigmar One","Simonetta","Sirin Stencil","Skranji","Smythe","Sniglet","Sofadi One","Sonsie One","Spicy Rice","Spirax","Squada One","Stalinist One","Stalin One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Supermercado One","Titan One","Trade Winds","Trochut","Tulpen One","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unlock","Vast Shadow","Voces","VT323","Wallpoet","Warnes","Wellfleet","Yeseva One"],serif:["Roboto Slab","Noto Serif","Libre Baskerville","Gabriela","Fauna One","Droid Serif","jsMath cmbx10","jsMath cmex10","jsMath cmmi10","jsMath cmr10","jsMath cmsy10","jsMath cmti10","Ultra","Adamina","Alegreya","Alegreya SC","Alice","Alike","Alike Angular","Almendra","Almendra SC","Amethysta","Amiri","Andada","Andada SC","Antic Didone","Antic Slab","Arapey","Arbutus Slab","Artifika","Arvo","Average","Balthazar","Belgrano","Bentham","Bitter","Brawler","Bree Serif","Buenard","Cambo","Cantata One","Cardo","Caudex","Cinzel","Copse","Coustard","Crete Round","Crimson Text","Cutive","Cutive Mono","Della Respira","EB Garamond","Enriqueta","Esteban","Fanwood Text","Fenix","Fjord One","Gentium Basic","Gentium Book Basic","Gilda Display","Glegoo","Goudy Bookletter 1911","Habibi","Headland One","Holtwood One SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Inika","Italiana","Jacques Francois","Josefin Slab","Judson","Junge","Kameron","Kotta One","Kreon","Ledger","Linden Hill","Lora","Lusitana","Lustria","Marcellus","Marcellus SC","Marko One","Mate","Mate SC","Merriweather","Montaga","Neuton","Noticia Text","OFL Sorts Mill Goudy TT","Old Standard TT","Oranienbaum","Ovo","Petrona","Playfair Display","Playfair Display SC","Podkova","Poly","Port Lligat Slab","Prata","Prociono","PT Serif","PT Serif Caption","Quando","Quattrocento","Radley","Rokkitt","Rosarivo","Rufina","Sanchez","Sedan","Sedan SC","Sorts Mill Goudy","Stoke","Tienne","Tinos","Trocchi","Trykker","Unna","Vidaloka","Volkhov","Vollkorn"],other:["Angkor","Battambang","Bayon","Bokor","Chenla","Content","Dangrek","Fasthand","Freehand","GFS Didot","GFS Neohellenic","Hanuman","Kantumruy","Kdam Thmor","Khmer","Koulen","Metal","Moul","Moulpali","Nokora","Odor Mean Chey","Preahvihear","Siemreap","Suwannaphum","Taprom"]};g.filter("startFrom",function(){return function(b,c){return a.isArray(b)?b.slice(c):b}}),g.filter("fuzzySearch",function(){var b={teAmount:0,tePercent:.3};return function(c,d,e){function f(a){return new RegExp(a.replace(/./g,function(a){return"([^"+a+"]*?(?:"+a+"))?"}),"i")}if(!a.isArray(c)||a.isUndefined(d))return c;var g=!0,h=[];e=a.extend(b,e);var i=function(a,b,c){var d=(a.match(b)||[]).filter(function(a,b){return 0!==b&&a}),f=d.length+e.teAmount>=c,g=d.length/c>=1-e.tePercent;return f||g};if(a.isString(d)){var j=f(d);g=!1,a.forEach(c[0],function(a,b){"$"!==b.substring(0,1)&&h.push({key:b,search:j,length:d.length})})}else if(a.isObject(d)){var k=!1;if(a.forEach(d,function(b,c){a.isUndefined(b)||(k=!0,h.push({key:c,search:f(b),length:b.length}))}),!k)return c}return c=c.filter(function(a){for(var b=0,c=h.length;c>b;b++){var d=h[b],e=a[d.key]||"",f=i(e,d.search,d.length);if(g&&!f)return!1;if(f)return!0}return!1})}}),g.filter("hasAllSubsets",function(){return function(b,c){function d(b){var d=!0;return a.forEach(c,function(a,c){a&&d&&b.subsets.indexOf(c)<0&&(d=!1)}),d}return a.isArray(b)?b.filter(function(b){return a.isUndefined(b.subsets)?!0:a.isObject(b)&&d(b)}):b}});var W=["$http","$q","jdFontselectConfig","$filter"],X=!1;f.$inject=W,f.prototype={_init:function(){var a=this;a._fonts=a._fonts||[],a._map={},a._allSubsets=[],a._subsets={},a._providers={},a._imports={},a._subsetNames={},a._addDefaultFonts()},getAllFonts:function(){return this._fonts},add:function(b,c){var d=this;if(a.isString(c)||(c=a.isString(b.provider)?b.provider:h),b.provider=c,b.stack+=', "'+c+'"',!d.isValidFontObject(b))throw"Invalid font object.";a.isObject(d._map[c])||(d._map[c]={}),a.isArray(b.subsets)&&d._addSubsets(b.subsets),d._fonts.push(b)},searchFonts:function(a){var b=this;return b.$filter("filter")(b._fonts,a)},searchFont:function(a){var b=this,c=b.searchFonts(a);return c.length>0?c=c[0]:!1},getFontByKey:function(a,b){var c=this;if(!b)throw"Provider is not set.";var d=c.searchFont({key:a,provider:b});if(!d)throw'Font "'+a+'" not found in "'+b+'".';return d},getFontByStack:function(a){var b=this,c=b.searchFont({stack:a});if(!c)throw'Font with stack "'+a+'" not found.';return c},removeFont:function(b,c){var d=this;if(a.isString(b)&&!c)throw"Provider is not set.";try{a.isString(b)&&(b=d.getFontByKey(b,c));var e=d._fonts.indexOf(b),f=0;return e>=0&&(f=d._fonts.splice(e,1).length),f}catch(g){return 0}},isValidFontObject:function(b){if(!a.isObject(b))return!1;var c=!0;return a.forEach(s,function(d){a.isUndefined(b[d])&&(c=!1)}),c},getCategories:function(){return p},getAllSubsets:function(){return this._allSubsets},getSubsetNames:function(){return this._subsetNames},getImports:function(){return this._imports},getSubsets:function(){return this._subsets},getProviders:function(){return this._providers},setSubsets:function(a,b){return this._setSelects(this._subsets,a,b)},setProviders:function(a,b){return this._setSelects(this._providers,a,b)},setImports:function(a,b){return this._setSelects(this._imports,a,b)},_setSelects:function(b,c,d){return d||a.isUndefined(d)||a.forEach(b,function(a,d){c[d]||delete b[d]}),a.forEach(c,function(a,c){a&&(b[c]=a)}),b},updateImports:function(){this.setImports(this.getUrls())},load:function(a){a.loaded||(a.loaded=!0,a.provider!==h&&this["_load"+a.provider](a))},getUrls:function(){var a=this,b=a.getGoogleUrl(),c={};return b&&(c[i]=b),c},getUsedFonts:function(){var a=this;return a.$filter("filter")(a._fonts,{used:!0},function(a){return!!a})},getGoogleUrl:function(){var b=this,c=b.$filter("filter")(b.getUsedFonts(),{provider:i}),d=[],e=w;if(c.length){for(var f=[],g=0,h=c.length;h>g;g++)f.push(c[g].name);return e+="?family="+window.escape(f.join("|")),a.forEach(b._subsets,function(a,b){a&&d.push(b)}),d.length&&(e+="&subset="+d.join(",")),e}return!1},_remap:function(b,c){var d=this,e=d._fonts[b];a.isNumber(c)||(c=0);for(var f=c,g=e.length;g>f;f++)d._map[b][e[f].key]=f},_getBestOf:function(a,b){for(var c=0,d=b.length;d>c;c++){var e=b[c];if(a.indexOf(e)>=0)return e}return a[0]},_getBestVariantOf:function(a){return this._getBestOf(a,M)},_getBestSubsetOf:function(a){return this._getBestOf(a,E)},_initGoogleFonts:function(){var b=this;b.jdFontselectConfig.googleApiKey&&!X&&(X=!0,b.$http({method:u,url:v,params:{sort:"popularity",key:b.jdFontselectConfig.googleApiKey}}).success(function(d){var e=d.items.length;a.forEach(d.items,function(a,d){var f=b._getGoogleFontCat(a.family);t||1===a.subsets.length&&"khmer"===a.subsets[0]||b.add({subsets:a.subsets,variants:a.variants,name:a.family,popularity:e-d,key:c(a.family),lastModified:a.lastModified,stack:'"'+a.family+'", '+f.fallback,category:f.key},i)})}))},_addSubsets:function(a){for(var b=0,c=a.length;c>b;b++)this._addSubset(a[b])},_addSubset:function(a){var b=this;if(b._allSubsets.indexOf(a)<0){for(var c=a.split("-"),d=0,e=c.length;e>d;d++)c[d]=c[d].charAt(0).toUpperCase()+c[d].slice(1);b._subsetNames[a]=c.join(" "),b._allSubsets.push(a)}},_getGoogleFontCat:function(a){for(var b=this,c=b.getCategories(),d=0,e=c.length;e>d;d++){var f=c[d];if("undefined"!=typeof V[f.key]&&V[f.key].indexOf(a)>=0)return f}return c[5]},_addDefaultFonts:function(){var b=this;a.forEach(o,function(a){b.add(a)})}},f.prototype["_load"+i]=function(a){var b=this;try{WebFont.load({google:{families:[a.name+":"+b._getBestVariantOf(a.variants)],text:a.name,subsets:a.subsets,subset:b._getBestSubsetOf(a.subsets)}})}catch(c){b.removeFont(a,i)}},g.factory(n,["$injector",function(a){return a.instantiate(f)}]);var Y=1,Z="_PSFBS";g.directive("jdFontselect",[n,function(c){return{scope:{current:"=?state",stack:"=?",name:"=?",rawText:"@?text",text:"=?textObj",onInit:"&?"},restrict:"E",templateUrl:l+"fontselect.html",replace:!0,controller:["$scope","$element","$timeout",function(f,g,h){function i(b){var d,g;f.current=a.extend(a.copy(T),b||{}),f.current.sort.attr||(f.current.sort.attr=S[0]),a.isObject(f.current.font)&&(f.stack=f.current.font.stack,f.name=f.current.font.name),d=c.getSubsets(),f.current.subsets=e(d)?d:c.setSubsets(f.current.subsets),g=c.getProviders(),f.current.providers=e(g)?g:c.setProviders(f.current.providers)}function k(a,b){for(var c=b;null!==c;){if(c===a)return!0;c=c.parentNode}return!1}function l(){f.toggle(),f.$digest()}f.fonts=c.getAllFonts(),f.id=Y++,f.providers=a.copy(j),f.active=!1,f.categories=c.getCategories(),f.subsets=c.getSubsetNames(),f.sortAttrs=S,f.name="",a.isUndefined(f.stack)&&(f.stack=F),f.text=a.extend(a.copy(U),f.text||{}),f.rawText&&(f.text=a.extend(f.text,f.$eval(f.rawText)||{})),f.reverseSort=function(){var a=f.current.sort;a.direction=!a.direction},f.toggle=function(){f.active=!f.active,f.active&&f.setFocus()},f.toName=d,f.setFocus=function(){h(function(){g[0].querySelector(".jdfs-search").focus()})},document.addEventListener("click",function(a){f.active&&!k(g[0],a.target)&&l()}),document.addEventListener("keyup",function(a){f.active&&a.keyCode===N&&l()}),f.setCategoryFilter=function(a){var c=f.current;c.category=c.category===a?b:a},f.reset=function(){i()},f._setSelected=function(b){a.isObject(b)?(f.name=b.name,f.stack=b.stack):(f.name="",f.stack=F)},a.isObject(f.current)&&i(f.current),f.stack.length&&(f[Z]=f.stack),f.onInit({$scope:f,$element:g})}],link:function(b){if(b.$watch("current.font",function(d,e){a.isObject(b.current)||b.reset(),e!==d&&(a.isObject(b.current.font)&&(d=b.current.font),a.isObject(e)&&e.used&&e.used--,a.isObject(d)&&(d.used?d.used++:d.used=1),b._setSelected(d),c.updateImports())}),b.$watch("current.subsets",function(a,b){a!==b&&c.updateImports()},!0),b.$watch("stack",function(a,d){var e;a===d||b.current.font&&a===b.current.font.stack||(a&&a.length&&(e=c.getFontByStack(a)),e?b.current.font=e:b.reset())}),b[Z])var d=b.$watch("fonts",function(){var a=b.current;try{var e=c.getFontByStack(b[Z]);e&&(a.font=e,delete b[Z],d())}catch(f){}},!0)}}}]);var $="jdFontlist",_=$+m;g.directive($,function(){return{scope:{id:"=fsid",fonts:"=",current:"=",text:"=",active:"="},restrict:"E",templateUrl:l+"fontlist.html",replace:!0,controller:_}}),g.controller(_,["$scope","$rootScope","$filter","jdFontselect.fonts",function(b,c,d,e){function f(a){var c=b.page.current*b.page.size;return a>=c&&a<c+b.page.size}function g(){return o=b.page.count,a.isArray(b.fonts)?void(i.length&&(b.page.count=Math.ceil(i.length/b.page.size))):0}function h(){if(o!==b.page.count){var a=b.current.font,c=i.indexOf(a);a&&c>=0?b.page.current=Math.ceil((c+1)/b.page.size)-1:b.page.current>b.page.count&&(b.page.current=b.page.count-1)}}var i,j,l,m,n,o=0,p={};b.page={size:k,count:0,current:0},b.keyfocus=function(d,e){var g=i.indexOf(b.current.font),h=b.page.size*b.page.current,j=f(g);a.isUndefined(e)&&(e=1),g+=d===r?-e:e,!j&&i[g+h]&&(g+=h),i[g]&&(b.current.font=i[g],b.page.current=Math.floor(g/b.page.size),c.$digest())},document.addEventListener("keydown",function(a){function c(){return a.preventDefault(),!1}if(b.active){var d=a.keyCode;if(d===P)return b.keyfocus(q),c();if(d===O)return b.keyfocus(r),c();if("INPUT"!==document.activeElement.tagName||!document.activeElement.value){var e=b.page.size;return d===R?(b.current.font||e++,b.keyfocus(q,e),c()):d===Q?(b.keyfocus(r,b.page.size),c()):void 0}}}),b.setCurrentPage=function(a){b.page.current=a},b.paginate=function(a){b.paginationButtonActive(a)&&(b.page.current+=a===r?-1:1)},b.paginationButtonActive=function(a){g(),h();var c=b.page;return a===q&&c.current<c.count-1||a===r&&c.current>0},b.getPages=function(){g();var a=new Array(b.page.count);return h(),a.length<=1?[]:a},b.getFilteredFonts=function(){if(a.isArray(b.fonts)){var c=b.current.sort.attr.dir;b.fonts.length!==p.sourceCache&&(p.sourceCache=b.fonts.length,p.providers=null),p.providers!==JSON.stringify(b.current.providers)&&(p.providers=JSON.stringify(b.current.providers),p.subsets=null,n=b.fonts.filter(function(a){return b.current.providers[a.provider]})),p.subsets!==JSON.stringify(b.current.subsets)&&(p.subsets=JSON.stringify(b.current.subsets),p.sortdir=null,m=d("hasAllSubsets")(n,b.current.subsets)),(p.sortattr!==b.current.sort.attr.key||p.sortdir!==b.current.sort.direction)&&(p.sortattr=b.current.sort.attr.key,p.sortdir=b.current.sort.direction,p.category=null,j=d("orderBy")(m,b.current.sort.attr.key,b.current.sort.direction?c:!c)),p.category!==b.current.category&&(p.category=b.current.category,p.search=null,l=d("filter")(j,{category:b.current.category},!0)),p.search!==b.current.search&&(p.search=b.current.search,i=d("fuzzySearch")(l,{name:b.current.search}))}else i=[];return i},e._initGoogleFonts()}]),g.directive("jdFont",["jdFontselect.fonts",function(a){return{templateUrl:l+"font.html",restrict:"E",replace:!0,controller:["$scope",function(b){a.load(b.font)}]}}]),g.directive("jdFontselectCurrentHref",[n,function(a){return{templateUrl:l+"current-href.html",restrict:"A",replace:!0,controller:["$scope",function(b){b.urls=a.getImports()}]}}]),a.module("jdFontselect").run(["$templateCache",function(a){a.put("src/partials/current-href.html",'<link ng-href={{url}} ng-repeat="url in urls">'),a.put("src/partials/font.html",'<li><input type=radio ng-model=current.font ng-value=font name=jdfs-{{id}}-font id=jdfs-{{id}}-font-{{font.key}}><label ng-class="{\'jdfs-active jdfs-highlight\': current.font.name == font.name}" for=jdfs-{{id}}-font-{{font.key}} style="font-family: {{font.stack}}">{{font.name}}</label></li>'),a.put("src/partials/fontlist.html",'<div class=jdfs-fontlistcon ng-class="{\'jdfs-active\': isActive()}"><div><ul class=jdfs-fontlist><jd-font ng-repeat="font in getFilteredFonts() | startFrom: page.current * page.size | limitTo: page.size"></ul><div class=jdfs-paginationcon><button ng-repeat="dir in [\'prev\', \'next\']" class="jdfs-fontpagination jdfs-fontpagination-{{dir}}" ng-click=paginate(dir) ng-class="{\'jdfs-disabled\': !paginationButtonActive(dir)}" ng-disabled=!paginationButtonActive(dir)>{{text.page[dir]}}</button></div><div class=jdfs-pagecon>{{text.pageLabel}} <span class=jdfs-page-current>{{page.current + 1}}</span>/<span class=jdfs-page-count>{{page.count}}</span></div><div class=jdfs-fontcount>{{text.fontFabel}} <span ng-if="getFilteredFonts().length == fonts.length">{{fonts.length}}</span> <span ng-if="fonts.length && getFilteredFonts().length != fonts.length">{{getFilteredFonts().length}}/{{fonts.length}}</span> <span ng-if=!fonts.length>…</span></div></div></div>'),a.put("src/partials/fontselect.html",'<div class=jdfs-main id=jd-fontselect-{{id}}><button ng-click=toggle() class=jdfs-toggle style="font-family: {{current.font.stack}}" ng-show=!active><span>{{current.font.name || text.button}}</span></button><input class=jdfs-search placeholder={{text.search}} name=jdfs-{{id}}-search ng-show=active ng-model=current.search><div class=jdfs-window ng-show=active><jd-fontlist fsid=id text=text current=current fonts=fonts active=active></jd-fontlist><div class=jdfs-filter><div class=jdfs-styles><h4 class=jdfs-filter-headline>{{text.styleLabel}}</h4><button class="jdfs-filterbtn jdfs-fontstyle-{{category.key}}" ng-repeat="category in categories" ng-class="{\'jdfs-active jdfs-highlight\': category.key == current.category}" ng-click=setCategoryFilter(category.key) ng-model=current.category>{{text.category[category.key] || toName(category.key)}}</button></div><div class=jdfs-providers><h4 class=jdfs-filter-headline>{{text.providerLabel}}</h4><div ng-repeat="(provider, active) in providers" class=jdfs-provider ng-class="{\'jdfs-active jdfs-highlight\': current.providers[provider]}"><input ng-model=current.providers[provider] type=checkbox id=jdfs-{{id}}-provider-{{provider}}><label for=jdfs-{{id}}-provider-{{provider}}>{{text.provider[provider] || toName(provider)}}</label></div></div><div class=jdfs-subsets><h4 class=jdfs-filter-headline>{{text.subsetLabel}}</h4><div ng-repeat="(key, name) in subsets" class=jdfs-subset ng-class="{\'jdfs-active jdfs-highlight\': current.subsets[key]}"><input ng-model=current.subsets[key] type=checkbox id=jdfs-{{id}}-subset-{{key}}><label for=jdfs-{{id}}-subset-{{key}}>{{text.subset[key] || toName(key)}}</label></div></div><button ng-click=toggle() class=jdfs-close><span>{{text.closeButton}}</span></button></div></div></div>')}])}(angular);